cscope 15 $HOME/codes/cse_labs/lab6               0000495740
	@config.cc

1 
	~<s¡»am
>

2 
	~<io¡»am
>

3 
	~<¡dio.h
>

4 
	~"cÚfig.h
"

5 
	~"·xos.h
"

6 
	~"hªdË.h
"

7 
	~"rštf.h
"

8 
	~"Ïng/v”ify.h
"

43 
	$h—¹b—‰h»ad
(*
x
)

45 
cÚfig
 *
r
 = (cÚfig *è
x
;

46 
r
->
	`h—¹b—‹r
();

48 
	}
}

50 
	gcÚfig
::
	$cÚfig
(
¡d
::
¡ršg
 
_fœ¡
, std::¡ršg 
_me
, 
cÚfig_v›w_chªge
 *
_vc
)

51 : 
	`myvid
 (0), 
	`fœ¡
 (
_fœ¡
), 
	`me
 (
_me
), 
	$vc
 (
_vc
)

53 
	`VERIFY
 (
	`±h»ad_mu‹x_š™
(&
cfg_mu‹x
, 
NULL
) == 0);

54 
	`VERIFY
(
	`±h»ad_cÚd_š™
(&
cÚfig_cÚd
, 
NULL
) == 0);

56 
¡d
::
o¡ršg¡»am
 
o¡
;

57 
o¡
 << 
me
;

59 
acc
 = 
Ãw
 
	`acû±Ü
(
this
, 
me
 =ğ
_fœ¡
, me, 
o¡
.
	`¡r
());

60 
´o
 = 
Ãw
 
	`´İo£r
(
this
, 
acc
, 
me
);

63 
px¤pc
 = 
acc
->
	`g‘_½cs
();

64 
px¤pc
->
	`»g
(
·xos_´ÙocŞ
::
h—¹b—t
, 
this
, &
cÚfig
::heartbeat);

67 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

69 
	`»cÚ¡ruù
();

71 
±h»ad_t
 
th
;

72 
	`VERIFY
 (
	`±h»ad_ü—‹
(&
th
, 
NULL
, &
h—¹b—‰h»ad
, (*è
this
) == 0);

74 
	}
}

77 
	gcÚfig
::
	$»¡Üe
(
¡d
::
¡ršg
 
s
)

79 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

80 
acc
->
	`»¡Üe
(
s
);

81 
	`»cÚ¡ruù
();

82 
	}
}

84 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>

85 
cÚfig
::
	$g‘_v›w
(
š¡ªû
)

87 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

88  
	`g‘_v›w_wo
(
š¡ªû
);

89 
	}
}

92 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>

93 
cÚfig
::
	$g‘_v›w_wo
(
š¡ªû
)

95 
¡d
::
¡ršg
 
v®ue
 = 
acc
->
	`v®ue
(
š¡ªû
);

96 
	`rštf
("g‘_v›w(%d):„‘uº %s\n", 
š¡ªû
, 
v®ue
.
	`c_¡r
());

97  
	`memb”s
(
v®ue
);

98 
	}
}

100 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>

101 
cÚfig
::
	$memb”s
(
¡d
::
¡ršg
 
v®ue
)

103 
¡d
::
i¡ršg¡»am
 
	`i¡
(
v®ue
);

104 
¡d
::
¡ršg
 
m
;

105 
¡d
::
veùÜ
<¡d::
¡ršg
> 
v›w
;

106 
i¡
 >> 
m
) {

107 
v›w
.
	`push_back
(
m
);

109  
v›w
;

110 
	}
}

112 
	g¡d
::
¡ršg


113 
cÚfig
::
v®ue
(
¡d
::
veùÜ
<¡d::
¡ršg
> 
m
)

115 
¡d
::
o¡ršg¡»am
 
o¡
;

116 
	gi
 = 0; i < 
	gm
.
size
(); i++) {

117 
	go¡
 << 
	gm
[
i
];

118 
	go¡
 << " ";

120  
	go¡
.
¡r
();

125 
	gcÚfig
::
	$»cÚ¡ruù
()

127 ià(
acc
->
	`š¡ªû
() > 0) {

128 
¡d
::
¡ršg
 
m
;

129 
myvid
 = 
acc
->
	`š¡ªû
();

130 
mems
 = 
	`g‘_v›w_wo
(
myvid
);

131 
	`rštf
("cÚfig::»cÚ¡ruù: %d %s\n", 
myvid
, 
	`´št_memb”s
(
mems
).
	`c_¡r
());

133 
	}
}

137 
	gcÚfig
::
	$·xos_comm™
(
š¡ªû
, 
¡d
::
¡ršg
 
v®ue
)

139 
¡d
::
¡ršg
 
m
;

140 
¡d
::
veùÜ
<¡d::
¡ršg
> 
Ãwmem
;

141 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

143 
Ãwmem
 = 
	`memb”s
(
v®ue
);

144 
	`rštf
("cÚfig::·xos_comm™: %d: %s\n", 
š¡ªû
,

145 
	`´št_memb”s
(
Ãwmem
).
	`c_¡r
());

147 
i
 = 0; i < 
mems
.
	`size
(); i++) {

148 
	`rštf
("cÚfig::·xos_comm™: i % ¡È¨memb”?\n", 
mems
[
i
].
	`c_¡r
());

149 ià(!
	`i§memb”
(
mems
[
i
], 
Ãwmem
è&& 
me
 != mems[i]) {

150 
	`rštf
("cÚfig::·xos_comm™: d–‘%s\n", 
mems
[
i
].
	`c_¡r
());

151 
mgr
.
	`d–‘e_hªdË
(
mems
[
i
]);

155 
mems
 = 
Ãwmem
;

156 
myvid
 = 
š¡ªû
;

157 ià(
vc
) {

158 
vid
 = 
myvid
;

159 
	`VERIFY
(
	`±h»ad_mu‹x_uÆock
(&
cfg_mu‹x
)==0);

160 
vc
->
	`comm™_chªge
(
vid
);

161 
	`VERIFY
(
	`±h»ad_mu‹x_lock
(&
cfg_mu‹x
)==0);

163 
	}
}

165 
boŞ


166 
	gcÚfig
::
	$ismemb”
(
¡d
::
¡ršg
 
m
, 
vid
)

168 
boŞ
 
r
;

169 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

170 
¡d
::
veùÜ
<¡d::
¡ršg
> 
v
 = 
	`g‘_v›w_wo
(
vid
);

171 
r
 = 
	`i§memb”
(
m
, 
v
);

172  
r
;

173 
	}
}

175 
boŞ


176 
	gcÚfig
::
	$add
(
¡d
::
¡ršg
 
Ãw_m
, 
vid
)

178 
¡d
::
veùÜ
<¡d::
¡ršg
> 
m
;

179 
¡d
::
veùÜ
<¡d::
¡ršg
> 
curm
;

180 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

181 ià(
vid
 !ğ
myvid
)

182  
çl£
;

183 
	`rštf
("cÚfig::add %s\n", 
Ãw_m
.
	`c_¡r
());

184 
m
 = 
mems
;

185 
m
.
	`push_back
(
Ãw_m
);

186 
curm
 = 
mems
;

187 
¡d
::
¡ršg
 
v
 = 
	`v®ue
(
m
);

188 
Ãxtvid
 = 
myvid
 + 1;

189 
	`VERIFY
(
	`±h»ad_mu‹x_uÆock
(&
cfg_mu‹x
)==0);

190 
boŞ
 
r
 = 
´o
->
	`run
(
Ãxtvid
, 
curm
, 
v
);

191 
	`VERIFY
(
	`±h»ad_mu‹x_lock
(&
cfg_mu‹x
)==0);

192 ià(
r
) {

193 
	`rštf
("config::add:…roposer„eturned success\n");

195 
	`rštf
("config::add:…roposer„eturned failure\n");

197  
r
;

198 
	}
}

201 
boŞ


202 
	gcÚfig
::
	$»move_wo
(
¡d
::
¡ršg
 
m
)

204 
	`rštf
("cÚfig::»move: myvid %d„emove? %s\n", 
myvid
, 
m
.
	`c_¡r
());

205 
¡d
::
veùÜ
<¡d::
¡ršg
> 
n
;

206 
i
 = 0; i < 
mems
.
	`size
(); i++) {

207 ià(
mems
[
i
] !ğ
m
è
n
.
	`push_back
(mems[i]);

209 
¡d
::
¡ršg
 
v
 = 
	`v®ue
(
n
);

210 
¡d
::
veùÜ
<¡d::
¡ršg
> 
cmems
 = 
mems
;

211 
Ãxtvid
 = 
myvid
 + 1;

212 
	`VERIFY
(
	`±h»ad_mu‹x_uÆock
(&
cfg_mu‹x
)==0);

213 
boŞ
 
r
 = 
´o
->
	`run
(
Ãxtvid
, 
cmems
, 
v
);

214 
	`VERIFY
(
	`±h»ad_mu‹x_lock
(&
cfg_mu‹x
)==0);

215 ià(
r
) {

216 
	`rštf
("config::remove:…roposer„eturned success\n");

218 
	`rštf
("config::remove:…roposer„eturned failure\n");

220  
r
;

221 
	}
}

224 
	gcÚfig
::
	$h—¹b—‹r
()

226 
timev®
 
now
;

227 
time¥ec
 
Ãxt_timeout
;

228 
¡d
::
¡ršg
 
m
;

229 
h—¹b—t_t
 
h
;

230 
boŞ
 
¡abË
;

231 
vid
;

232 
¡d
::
veùÜ
<¡d::
¡ršg
> 
cmems
;

233 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

237 
	`g‘timeofday
(&
now
, 
NULL
);

238 
Ãxt_timeout
.
tv_£c
 = 
now
.tv_sec + 3;

239 
Ãxt_timeout
.
tv_n£c
 = 0;

240 
	`rštf
("heartbeater: goo sleep\n");

241 
	`±h»ad_cÚd_timedwa™
(&
cÚfig_cÚd
, &
cfg_mu‹x
, &
Ãxt_timeout
);

243 
¡abË
 = 
Œue
;

244 
vid
 = 
myvid
;

245 
cmems
 = 
	`g‘_v›w_wo
(
vid
);

246 
	`rštf
("h—¹b—‹r: cu¼’ˆmemb”sh %s\n", 
	`´št_memb”s
(
cmems
).
	`c_¡r
());

248 ià(!
	`i§memb”
(
me
, 
cmems
)) {

249 
	`rštf
("heartbeater:‚ot member yet; skip hearbeat\n");

254 
m
 = 
me
;

255 
i
 = 0; i < 
cmems
.
	`size
(); i++) {

256 ià(
m
 > 
cmems
[
i
])

257 
m
 = 
cmems
[
i
];

260 ià(
m
 =ğ
me
) {

262 
i
 = 0; i < 
cmems
.
	`size
(); i++) {

263 ià(
cmems
[
i
] !ğ
me
) {

264 ià((
h
 = 
	`doh—¹b—t
(
cmems
[
i
])è!ğ
OK
) {

265 
¡abË
 = 
çl£
;

266 
m
 = 
cmems
[
i
];

273 ià((
h
 = 
	`doh—¹b—t
(
m
)è!ğ
OK
)

274 
¡abË
 = 
çl£
;

277 ià(!
¡abË
 && 
vid
 =ğ
myvid
) {

278 
	`»move_wo
(
m
);

281 
	}
}

283 
	g·xos_´ÙocŞ
::
¡©us


284 
cÚfig
::
	$h—¹b—t
(
¡d
::
¡ršg
 
m
, 
vid
, &
r
)

286 
ScİedLock
 
	`ml
(&
cfg_mu‹x
);

287 
»t
 = 
·xos_´ÙocŞ
::
ERR
;

288 
r
 = (è
myvid
;

289 
	`rštf
("h—¹b—ˆäom %s(%dèmyvid %d\n", 
m
.
	`c_¡r
(), 
vid
, 
myvid
);

290 ià(
vid
 =ğ
myvid
) {

291 
»t
 = 
·xos_´ÙocŞ
::
OK
;

292 } ià(
´o
->
	`i¤uÂšg
()) {

293 
	`VERIFY
 (
vid
 =ğ
myvid
 + 1 || vid + 1 == myvid);

294 
»t
 = 
·xos_´ÙocŞ
::
OK
;

296 
»t
 = 
·xos_´ÙocŞ
::
ERR
;

298  
»t
;

299 
	}
}

301 
	gcÚfig
::
h—¹b—t_t


302 
cÚfig
::
	$doh—¹b—t
(
¡d
::
¡ršg
 
m
)

304 
»t
 = 
½c_cÚ¡
::
timeout_çu»
;

305 
r
;

306 
vid
 = 
myvid
;

307 
h—¹b—t_t
 
»s
 = 
OK
;

309 
	`rštf
("doh—¹b—‹¸tØ% (%d)\n", 
m
.
	`c_¡r
(), 
vid
);

310 
hªdË
 
	`h
(
m
);

311 
	`VERIFY
(
	`±h»ad_mu‹x_uÆock
(&
cfg_mu‹x
)==0);

312 
½cc
 *
ş
 = 
h
.
	`§ãbšd
();

313 ià(
ş
) {

314 
»t
 = 
ş
->
	`ÿÎ
(
·xos_´ÙocŞ
::
h—¹b—t
, 
me
, 
vid
, 
r
,

315 
½cc
::
	`to
(1000));

317 
	`VERIFY
(
	`±h»ad_mu‹x_lock
(&
cfg_mu‹x
)==0);

318 ià(
»t
 !ğ
·xos_´ÙocŞ
::
OK
) {

319 ià(
»t
 =ğ
½c_cÚ¡
::
©mo¡Úû_çu»
 ||

320 
»t
 =ğ
½c_cÚ¡
::
Şd¤v_çu»
) {

321 
mgr
.
	`d–‘e_hªdË
(
m
);

323 
	`rštf
("doheartbeat:…roblem with %s (%d) my vid %d his vid %d\n",

324 
m
.
	`c_¡r
(), 
»t
, 
vid
, 
r
);

325 ià(
»t
 < 0è
»s
 = 
FAILURE
;

326 
»s
 = 
VIEWERR
;

329 
	`rštf
("doh—¹b—ˆdÚ%d\n", 
»s
);

330  
»s
;

331 
	}
}

	@config.h

1 #iâdeà
cÚfig_h


2 
	#cÚfig_h


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~"·xos.h
"

8 şas 
	ccÚfig_v›w_chªge
 {

9 
	mpublic
:

10 
vœtu®
 
comm™_chªge
(
vid
) = 0;

11 
	mvœtu®
 ~
	$cÚfig_v›w_chªge
() {};

12 
	}
};

14 şas 
	ccÚfig
 : 
public
 
·xos_chªge
 {

15 
´iv©e
:

16 
acû±Ü
 *
acc
;

17 
´İo£r
 *
	m´o
;

18 
½cs
 *
	mpx¤pc
;

19 
	mmyvid
;

20 
	m¡d
::
¡ršg
 
fœ¡
;

21 
	m¡d
::
¡ršg
 
me
;

22 
cÚfig_v›w_chªge
 *
	mvc
;

23 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
> 
mems
;

24 
±h»ad_mu‹x_t
 
	mcfg_mu‹x
;

25 
±h»ad_cÚd_t
 
	mh—¹b—t_cÚd
;

26 
±h»ad_cÚd_t
 
	mcÚfig_cÚd
;

27 
	m·xos_´ÙocŞ
::
¡©us
 
h—¹b—t
(
¡d
::
¡ršg
 
m
, 
š¡ªû
, &
r
);

28 
	m¡d
::
¡ršg
 
v®ue
(
¡d
::
veùÜ
<¡d::¡ršg> 
mems
);

29 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
> 
memb”s
(¡d::¡ršg 
v
);

30 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
> 
g‘_v›w_wo
(
š¡ªû
);

31 
boŞ
 
»move_wo
(
¡d
::
¡ršg
);

32 
»cÚ¡ruù
();

34 
	mOK
,

35 
	mVIEWERR
,

36 
	mFAILURE
,

37 } 
	th—¹b—t_t
;

38 
h—¹b—t_t
 
doh—¹b—t
(
¡d
::
¡ršg
 
m
);

39 
	gpublic
:

40 
cÚfig
(
¡d
::
¡ršg
 
_fœ¡
, std::¡ršg 
_me
, 
cÚfig_v›w_chªge
 *
_vc
);

41 
	$vid
(è{  
myvid
; 
	}
}

42 
	g¡d
::
¡ršg
 
	$myaddr
(è{  
me
; 
	}
};

43 
	g¡d
::
¡ršg
 
	$dump
(è{  
acc
->
	`dump
(); 
	}
};

44 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
g‘_v›w
(
š¡ªû
);

45 
»¡Üe
(
¡d
::
¡ršg
 
s
);

46 
boŞ
 
add
(
¡d
::
¡ršg
, 
vid
);

47 
boŞ
 
ismemb”
(
¡d
::
¡ršg
 
m
, 
vid
);

48 
h—¹b—‹r
();

49 
·xos_comm™
(
š¡ªû
, 
¡d
::
¡ršg
 
v
);

50 
½cs
 *
	$g‘_½cs
(è{  
acc
->
	`g‘_½cs
(); 
	}
}

51 
	$b»akpošt
(
b
è{ 
´o
->
	`b»akpošt
(b); 
	}
}

	@demo_client.cc

3 
	~<¡ršg
>

4 
	~"demo_´ÙocŞ.h
"

5 
	~"½c.h
"

6 
	~<veùÜ
>

7 
	~<¬·/š‘.h
>

8 
	~<s¡»am
>

9 
	~<io¡»am
>

10 
	~<¡dio.h
>

13 şas 
	cdemo_ş›Á
 {

14 
	m´Ùeùed
:

15 
½cc
 *
ş
;

16 
	mpublic
:

17 
demo_ş›Á
(
¡d
::
¡ršg
 
d
);

18 
	mvœtu®
 ~
	$demo_ş›Á
() {};

19 
vœtu®
 
demo_´ÙocŞ
::
¡©us
 
	`¡©
(demo_´ÙocŞ::
demoV¬
);

20 
	}
};

22 
	gdemo_ş›Á
::
	$demo_ş›Á
(
¡d
::
¡ršg
 
d¡
)

24 
sockaddr_š
 
d¡sock
;

25 
	`make_sockaddr
(
d¡
.
	`c_¡r
(), &
d¡sock
);

26 
ş
 = 
Ãw
 
	`½cc
(
d¡sock
);

27 ià(
ş
->
	`bšd
() < 0) {

28 
	`´štf
("demo_client: call bind\n");

30 
	}
}

33 
	gdemo_ş›Á
::
	$¡©
(
demo_´ÙocŞ
::
demoV¬
 
v¬
)

35 
r
;

36 
demo_´ÙocŞ
::
¡©us
 
»t
 = 
ş
->
	`ÿÎ
(demo_´ÙocŞ::
¡©
, cl->
	`id
(), 
v¬
, 
r
);

37 
	`VERIFY
 (
»t
 =ğ
demo_´ÙocŞ
::
OK
);

38  
r
;

39 
	}
}

42 
	~"demo_´ÙocŞ.h
"

43 
	~"½c.h
"

44 
	~<¬·/š‘.h
>

45 
	~<veùÜ
>

46 
	~<¡dlib.h
>

47 
	~<¡dio.h
>

49 
	g¡d
::
¡ršg
 
d¡
;

50 
demo_ş›Á
 *
	gdc
;

53 
	$maš
(
¬gc
, *
¬gv
[])

55 
r
;

57 if(
¬gc
 != 2){

58 
	`årštf
(
¡d”r
, "U§ge: % [ho¡:]pÜt\n", 
¬gv
[0]);

59 
	`ex™
(1);

62 
d¡
 = 
¬gv
[1];

63 
dc
 = 
Ãw
 
	`demo_ş›Á
(
d¡
);

64 
r
 = 
dc
->
	`¡©
(1);

65 
	`´štf
 ("¡©„‘uºed %d\n", 
r
);

66 
	}
}

	@demo_protocol.h

3 #iâdeà
demo_´ÙocŞ_h


4 
	#demo_´ÙocŞ_h


	)

6 
	~"½c.h
"

8 şas 
	cdemo_´ÙocŞ
 {

9 
	mpublic
:

10 
	exx¡©us
 { 
OK
, 
	mRETRY
, 
	mRPCERR
, 
	mNOENT
, 
	mIOERR
 };

11 
	t¡©us
;

12 
	tdemoV¬
;

13 
	e½c_numb”s
 {

14 
	g¡©
 = 0x7001,

15 
	g½cA
,

16 
	g½cB


	@demo_server.cc

3 
	~<¡ršg
>

4 
	~<m­
>

5 
	~<±h»ad.h
>

6 
	~"demo_´ÙocŞ.h
"

7 
	~"½c.h
"

8 
	~<s¡»am
>

9 
	~<¡dio.h
>

10 
	~<uni¡d.h
>

11 
	~<¬·/š‘.h
>

13 şas 
	cdemo_£rv”
 {

14 
	mpublic
:

15 
	$demo_£rv”
() {};

16 ~
	$demo_£rv”
(è{
	}
};

17 
	gdemo_´ÙocŞ
::
¡©us
 
¡©
(
şt
, 
demo_´ÙocŞ
::
demoV¬
 
a
, &);

23 
	gdemo_´ÙocŞ
::
¡©us


24 
demo_£rv”
::
	$¡©
(
şt
, 
demo_´ÙocŞ
::
demoV¬
 
v¬
, &
r
)

26 
demo_´ÙocŞ
::
¡©us
 
»t
 = demo_´ÙocŞ::
OK
;

27 
	`´štf
("¡©„eque¡ from cÉ %d\n", 
şt
);

28 
r
 = 0;

29  
»t
;

30 
	}
}

35 
	$maš
(
¬gc
, cÚ¡ *
¬gv
[])

37 
couÁ
 = 0;

39 
	`£tvbuf
(
¡dout
, 
NULL
, 
_IONBF
, 0);

40 
	`£tvbuf
(
¡d”r
, 
NULL
, 
_IONBF
, 0);

42 
	`¤ªdom
(
	`g‘pid
());

44 if(
¬gc
 != 2){

45 
	`årštf
(
¡d”r
, "U§ge: % pÜt\n", 
¬gv
[0]);

46 
	`ex™
(1);

49 *
couÁ_’v
 = 
	`g‘’v
("RPC_COUNT");

50 if(
couÁ_’v
 !ğ
NULL
){

51 
couÁ
 = 
	`©oi
(
couÁ_’v
);

54 
demo_£rv”
 
ds
;

55 
½cs
 
	`£rv”
(
	`©oi
(
¬gv
[1]), 
couÁ
);

56 
£rv”
.
	`»g
(
demo_´ÙocŞ
::
¡©
, &
ds
, &
demo_£rv”
::stat);

59 
	`¦“p
(1000);

60 
	}
}

	@extent_client.cc

3 
	~"ex‹Á_ş›Á.h
"

4 
	~<s¡»am
>

5 
	~<io¡»am
>

6 
	~<¡dio.h
>

7 
	~<uni¡d.h
>

8 
	~<time.h
>

12 
	gex‹Á_ş›Á
::
	$ex‹Á_ş›Á
(
¡d
::
¡ršg
 
d¡
)

14 
sockaddr_š
 
d¡sock
;

15 
	`make_sockaddr
(
d¡
.
	`c_¡r
(), &
d¡sock
);

16 
ş
 = 
Ãw
 
	`½cc
(
d¡sock
);

17 ià(
ş
->
	`bšd
() != 0) {

18 
	`´štf
("extent_client: bind failed\n");

20 
	}
}

23 
	gex‹Á_´ÙocŞ
::
¡©us


24 
ex‹Á_ş›Á
::
	$g‘©Œ
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
,

25 
ex‹Á_´ÙocŞ
::
©Œ
 &attr)

27 
ex‹Á_´ÙocŞ
::
¡©us
 
»t
 =ƒx‹Á_´ÙocŞ::
OK
;

28 
»t
 = 
ş
->
	`ÿÎ
(
ex‹Á_´ÙocŞ
::
g‘©Œ
, 
eid
, 
©Œ
);

29  
»t
;

30 
	}
}

32 
	gex‹Á_´ÙocŞ
::
¡©us


33 
ex‹Á_ş›Á
::
	$ü—‹
(
ušt32_t
 
ty³
, 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 &
id
)

35 
ex‹Á_´ÙocŞ
::
¡©us
 
»t
 =ƒx‹Á_´ÙocŞ::
OK
;

37 
»t
 = 
ş
->
	`ÿÎ
(
ex‹Á_´ÙocŞ
::
ü—‹
, 
ty³
, 
id
);

38  
»t
;

39 
	}
}

41 
	gex‹Á_´ÙocŞ
::
¡©us


42 
ex‹Á_ş›Á
::
	$g‘
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
, 
¡d
::
¡ršg
 &
buf
)

44 
ex‹Á_´ÙocŞ
::
¡©us
 
»t
 =ƒx‹Á_´ÙocŞ::
OK
;

46 
»t
 = 
ş
->
	`ÿÎ
(
ex‹Á_´ÙocŞ
::
g‘
, 
eid
, 
buf
);

47  
»t
;

48 
	}
}

50 
	gex‹Á_´ÙocŞ
::
¡©us


51 
ex‹Á_ş›Á
::
	$put
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
, 
¡d
::
¡ršg
 
buf
)

53 
ex‹Á_´ÙocŞ
::
¡©us
 
»t
 =ƒx‹Á_´ÙocŞ::
OK
;

55 
r
;

56 
»t
 = 
ş
->
	`ÿÎ
(
ex‹Á_´ÙocŞ
::
put
, 
eid
, 
buf
, 
r
);

57  
»t
;

58 
	}
}

60 
	gex‹Á_´ÙocŞ
::
¡©us


61 
ex‹Á_ş›Á
::
	$»move
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
)

63 
ex‹Á_´ÙocŞ
::
¡©us
 
»t
 =ƒx‹Á_´ÙocŞ::
OK
;

65 
r
;

66 
»t
 = 
ş
->
	`ÿÎ
(
ex‹Á_´ÙocŞ
::
»move
, 
eid
, 
r
);

67  
»t
;

68 
	}
}

70 
	gex‹Á_´ÙocŞ
::
¡©us


71 
ex‹Á_ş›Á
::
	$ş—rfs
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
)

73 
ex‹Á_´ÙocŞ
::
¡©us
 
»t
 =ƒx‹Á_´ÙocŞ::
OK
;

74 
r
;

75 
»t
 = 
ş
->
	`ÿÎ
(
ex‹Á_´ÙocŞ
::
ş—rfs
, 
eid
, 
r
);

76  
»t
;

77 
	}
}

	@extent_client.h

3 #iâdeà
ex‹Á_ş›Á_h


4 
	#ex‹Á_ş›Á_h


	)

6 
	~<¡ršg
>

7 
	~"ex‹Á_´ÙocŞ.h
"

8 
	~"ex‹Á_£rv”.h
"

10 şas 
	cex‹Á_ş›Á
 {

11 
	m´iv©e
:

12 
½cc
 *
ş
;

14 
	mpublic
:

15 
ex‹Á_ş›Á
(
¡d
::
¡ršg
 
d¡
);

17 
	mex‹Á_´ÙocŞ
::
¡©us
 
ü—‹
(
ušt32_t
 
ty³
, 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 &
eid
);

18 
	mex‹Á_´ÙocŞ
::
¡©us
 
g‘
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
,

19 
¡d
::
¡ršg
 &
buf
);

20 
	mex‹Á_´ÙocŞ
::
¡©us
 
g‘©Œ
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
,

21 
ex‹Á_´ÙocŞ
::
©Œ
 &
a
);

22 
	mex‹Á_´ÙocŞ
::
¡©us
 
put
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
, 
¡d
::
¡ršg
 
buf
);

23 
	mex‹Á_´ÙocŞ
::
¡©us
 
»move
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
);

26 
	mex‹Á_´ÙocŞ
::
¡©us
 
ş—rfs
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
eid
);

	@extent_protocol.h

3 #iâdeà
ex‹Á_´ÙocŞ_h


4 
	#ex‹Á_´ÙocŞ_h


	)

6 
	~"½c.h
"

8 şas 
	cex‹Á_´ÙocŞ
 {

9 
	mpublic
:

10 
	t¡©us
;

11 
	tex‹Áid_t
;

12 
	exx¡©us
 { 
	mOK
, 
	mRPCERR
, 
	mNOENT
, 
	mIOERR
 };

13 
	e½c_numb”s
 {

14 
	gput
 = 0x6001,

15 
	gg‘
,

16 
	gg‘©Œ
,

17 
	g»move
,

18 
	gü—‹
,

19 
	gş—rfs


22 
	ety³s
 {

23 
	gT_DIR
 = 1,

24 
	gT_FILE
 = 2,

25 
	gT_SYMLINK
 = 3

28 
	s©Œ
 {

29 
ušt32_t
 
	gty³
;

30 
	g©ime
;

31 
	gmtime
;

32 
	gùime
;

33 
	gsize
;

37 
šlše
 
	gunm¬sh®l
 &

38 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	gex‹Á_´ÙocŞ
::
©Œ
 &
a
)

40 
u
 >> 
a
.
ty³
;

41 
	gu
 >> 
	ga
.
	g©ime
;

42 
	gu
 >> 
	ga
.
	gmtime
;

43 
	gu
 >> 
	ga
.
	gùime
;

44 
	gu
 >> 
	ga
.
	gsize
;

45  
	gu
;

48 
šlše
 
	gm¬sh®l
 &

49 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gex‹Á_´ÙocŞ
::
©Œ
 
a
)

51 
m
 << 
a
.
ty³
;

52 
	gm
 << 
	ga
.
	g©ime
;

53 
	gm
 << 
	ga
.
	gmtime
;

54 
	gm
 << 
	ga
.
	gùime
;

55 
	gm
 << 
	ga
.
	gsize
;

56  
	gm
;

	@extent_server.cc

3 
	~"ex‹Á_£rv”.h
"

4 
	~<s¡»am
>

5 
	~<¡dio.h
>

6 
	~<¡dlib.h
>

7 
	~<uni¡d.h
>

8 
	~<sys/ty³s.h
>

9 
	~<sys/¡©.h
>

10 
	~<fú.h
>

12 
	gex‹Á_£rv”
::
	$ex‹Á_£rv”
()

14 
im
 = 
Ãw
 
	`šode_mªag”
();

15 
	}
}

17 
	gex‹Á_£rv”
::
	$ü—‹
(
ušt32_t
 
ty³
, 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 &
id
)

20 
	`´štf
("extent_server: create inode\n");

21 
id
 = 
im
->
	`®loc_šode
(
ty³
);

23  
ex‹Á_´ÙocŞ
::
OK
;

24 
	}
}

26 
	gex‹Á_£rv”
::
	$put
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, 
¡d
::
¡ršg
 
buf
, &)

28 
id
 &= 0x7fffffff;

30 cÚ¡ * 
cbuf
 = 
buf
.
	`c_¡r
();

31 
size
 = 
buf
.
	`size
();

32 
im
->
	`wr™e_fe
(
id
, 
cbuf
, 
size
);

34  
ex‹Á_´ÙocŞ
::
OK
;

35 
	}
}

37 
	gex‹Á_£rv”
::
	$g‘
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, 
¡d
::
¡ršg
 &
buf
)

39 
	`´štf
("ex‹Á_£rv”: g‘ %Îd\n", 
id
);

41 
id
 &= 0x7fffffff;

43 
size
 = 0;

44 *
cbuf
 = 
NULL
;

46 
im
->
	`»ad_fe
(
id
, &
cbuf
, &
size
);

47 ià(
size
 == 0)

48 
buf
 = "";

50 
buf
.
	`assign
(
cbuf
, 
size
);

51 
	`ä“
(
cbuf
);

54  
ex‹Á_´ÙocŞ
::
OK
;

55 
	}
}

57 
	gex‹Á_£rv”
::
	$g‘©Œ
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
,ƒx‹Á_´ÙocŞ::
©Œ
 &
a
)

59 
	`´štf
("ex‹Á_£rv”: g‘©Œ %Îd\n", 
id
);

61 
id
 &= 0x7fffffff;

63 
ex‹Á_´ÙocŞ
::
©Œ
‡ttr;

64 
	`mem£t
(&
©Œ
, 0, (attr));

65 
im
->
	`g‘©Œ
(
id
, 
©Œ
);

66 
a
 = 
©Œ
;

68  
ex‹Á_´ÙocŞ
::
OK
;

69 
	}
}

71 
	gex‹Á_£rv”
::
	$»move
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, &)

73 
	`´štf
("ex‹Á_£rv”: wr™%Îd\n", 
id
);

75 
id
 &= 0x7fffffff;

76 
im
->
	`»move_fe
(
id
);

78  
ex‹Á_´ÙocŞ
::
OK
;

79 
	}
}

81 
	gex‹Á_£rv”
::
	$ş—rfs
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, &)

83 
	`´štf
("extent_server: clear file system\n");

84 
im
->
	`ş—rfs
();

85  
ex‹Á_´ÙocŞ
::
OK
;

86 
	}
}

	@extent_server.h

3 #iâdeà
ex‹Á_£rv”_h


4 
	#ex‹Á_£rv”_h


	)

6 
	~<¡ršg
>

7 
	~<m­
>

8 
	~"ex‹Á_´ÙocŞ.h
"

9 
	~"šode_mªag”.h
"

11 şas 
	cex‹Á_£rv”
 {

12 
	m´Ùeùed
:

14 
	sex‹Á
 {

15 
¡d
::
¡ršg
 
d©a
;

16 
	mex‹Á_´ÙocŞ
::
©Œ
‡ttr;

17 } 
	tex‹Á_t
;

18 
	g¡d
::
m­
 <
ex‹Á_´ÙocŞ
::
ex‹Áid_t
, 
	gex‹Á_t
> 
	gex‹Ás
;

20 
šode_mªag”
 *
	gim
;

22 
	gpublic
:

23 
ex‹Á_£rv”
();

25 
ü—‹
(
ušt32_t
 
ty³
, 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 &
id
);

26 
put
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, 
¡d
::
¡ršg
, &);

27 
g‘
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, 
¡d
::
¡ršg
 &);

28 
g‘©Œ
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
,ƒx‹Á_´ÙocŞ::
©Œ
 &);

29 
»move
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, &);

32 
ş—rfs
(
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
, &);

	@extent_smain.cc

1 
	~"½c.h
"

2 
	~<¬·/š‘.h
>

3 
	~<¡dlib.h
>

4 
	~<¡dio.h
>

5 
	~"ex‹Á_£rv”.h
"

6 
	~<uni¡d.h
>

11 
	$maš
(
¬gc
, *
¬gv
[])

13 
couÁ
 = 0;

15 if(
¬gc
 != 2){

16 
	`årštf
(
¡d”r
, "U§ge: % pÜt\n", 
¬gv
[0]);

17 
	`ex™
(1);

20 
	`£tvbuf
(
¡dout
, 
NULL
, 
_IONBF
, 0);

22 *
couÁ_’v
 = 
	`g‘’v
("RPC_COUNT");

23 if(
couÁ_’v
 !ğ
NULL
){

24 
couÁ
 = 
	`©oi
(
couÁ_’v
);

27 
½cs
 
	`£rv”
(
	`©oi
(
¬gv
[1]), 
couÁ
);

28 
ex‹Á_£rv”
 
ls
;

30 
£rv”
.
	`»g
(
ex‹Á_´ÙocŞ
::
g‘
, &
ls
, &
ex‹Á_£rv”
::get);

31 
£rv”
.
	`»g
(
ex‹Á_´ÙocŞ
::
g‘©Œ
, &
ls
, &
ex‹Á_£rv”
::getattr);

32 
£rv”
.
	`»g
(
ex‹Á_´ÙocŞ
::
put
, &
ls
, &
ex‹Á_£rv”
::put);

33 
£rv”
.
	`»g
(
ex‹Á_´ÙocŞ
::
»move
, &
ls
, &
ex‹Á_£rv”
::remove);

34 
£rv”
.
	`»g
(
ex‹Á_´ÙocŞ
::
ü—‹
, &
ls
, &
ex‹Á_£rv”
::create);

37 
£rv”
.
	`»g
(
ex‹Á_´ÙocŞ
::
ş—rfs
, &
ls
, &
ex‹Á_£rv”
::clearfs);

39 
	`¦“p
(1000);

40 
	}
}

	@fuse.cc

9 
	~<fu£_lowËv–.h
>

10 
	~<¡dio.h
>

11 
	~<¡dlib.h
>

12 
	~<¡ršgs.h
>

13 
	~<¡ršg.h
>

14 
	~<”ºo.h
>

15 
	~<fú.h
>

16 
	~<uni¡d.h
>

17 
	~<¬·/š‘.h
>

18 
	~"Ïng/v”ify.h
"

19 
	~"yfs_ş›Á.h
"

20 
	~"sigÇl.h
"

21 
	~<f¡»am
>

23 
	gmyid
;

24 
yfs_ş›Á
 *
	gyfs
;

26 
	$id
() {

27  
myid
;

28 
	}
}

42 
	gyfs_ş›Á
::
¡©us


43 
	$g‘©Œ
(
yfs_ş›Á
::
šum
 inum, 
¡©
 &
¡
)

45 
yfs_ş›Á
::
¡©us
 
»t
;

47 
	`bz”o
(&
¡
, (st));

49 
¡
.
¡_šo
 = 
šum
;

50 if(
yfs
->
	`isfe
(
šum
)){

51 
yfs_ş›Á
::
fešfo
 
šfo
;

52 
»t
 = 
yfs
->
	`g‘fe
(
šum
, 
šfo
);

53 if(
»t
 !ğ
yfs_ş›Á
::
OK
)

54  
»t
;

55 
¡
.
¡_mode
 = 
S_IFREG
 | (
šfo
.
mode
 & 0777);

56 
¡
.
¡_Æšk
 = 1;

57 
¡
.
¡_©ime
 = 
šfo
.
©ime
;

58 
¡
.
¡_mtime
 = 
šfo
.
mtime
;

59 
¡
.
¡_ùime
 = 
šfo
.
ùime
;

60 
¡
.
¡_size
 = 
šfo
.
size
;

61 
¡
.
¡_uid
 = 
šfo
.
uid
;

62 
¡
.
¡_gid
 = 
šfo
.
gid
;

64 
yfs_ş›Á
::
dœšfo
 
šfo
;

65 
»t
 = 
yfs
->
	`g‘dœ
(
šum
, 
šfo
);

66 if(
»t
 !ğ
yfs_ş›Á
::
OK
)

67  
»t
;

68 
¡
.
¡_mode
 = 
S_IFDIR
 | (
šfo
.
mode
 & 0777);

69 
¡
.
¡_Æšk
 = 2;

70 
¡
.
¡_©ime
 = 
šfo
.
©ime
;

71 
¡
.
¡_mtime
 = 
šfo
.
mtime
;

72 
¡
.
¡_ùime
 = 
šfo
.
ùime
;

73 
¡
.
¡_uid
 = 
šfo
.
uid
;

74 
¡
.
¡_gid
 = 
šfo
.
gid
;

76  
yfs_ş›Á
::
OK
;

77 
	}
}

95 
	$fu££rv”_g‘©Œ
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
,

96 
fu£_fe_šfo
 *
fi
)

98 
¡©
 
¡
;

99 
yfs_ş›Á
::
šum
 inum = 
šo
;

100 
yfs_ş›Á
::
¡©us
 
»t
;

102 
»t
 = 
	`g‘©Œ
(
šum
, 
¡
);

103 if(
»t
 !ğ
yfs_ş›Á
::
OK
){

104 ià(
»t
 =ğ
yfs_ş›Á
::
NOPEM
) {

105 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

107 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

111 
	`fu£_»¶y_©Œ
(
»q
, &
¡
, 0);

112 
	}
}

128 
	#LAB6_ATTR_MASK
 
FUSE_SET_ATTR_SIZE
|
FUSE_SET_ATTR_GID
|
FUSE_SET_ATTR_UID
|
FUSE_SET_ATTR_MODE


	)

131 
	$fu££rv”_£‰r
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
, 
¡©
 *
©Œ
,

132 
to_£t
, 
fu£_fe_šfo
 *
fi
)

134 
	`´štf
("fu££rv”_£‰¸0x%x\n", 
to_£t
);

135 
	`´štf
("©Œ->mod%o\n", 
©Œ
->
¡_mode
);

136 
	`´štf
("©Œ->u_id %d\n", 
©Œ
->
¡_uid
);

137 
	`´štf
("©Œ->g_id %d\n", 
©Œ
->
¡_gid
);

139 
yfs_ş›Á
::
¡©us
 
»t
;

141 ià(
LAB6_ATTR_MASK
 & 
to_£t
) {

142 
¡©
 
¡
;

143 
yfs_ş›Á
::
fe¡©
 
f¡
;

144 
f¡
.
mode
 = 
©Œ
->
¡_mode
;

145 
f¡
.
uid
 = 
©Œ
->
¡_uid
;

146 
f¡
.
gid
 = 
©Œ
->
¡_gid
;

147 
f¡
.
size
 = 
©Œ
->
¡_size
;

152 
»t
 = 
yfs
->
	`£‰r
(
šo
, 
f¡
, 
to_£t
);

153 ià(
»t
 !ğ
yfs_ş›Á
::
OK
) {

154 ià(
»t
 =ğ
yfs_ş›Á
::
NOPEM
) {

155 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

157 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

161 
	`g‘©Œ
(
šo
, 
¡
);

162 
	`fu£_»¶y_©Œ
(
»q
, &
¡
, 0);

164 
	`fu£_»¶y_”r
(
»q
, 
ENOSYS
);

168 
	`fu£_»¶y_”r
(
»q
, 
ENOSYS
);

170 
	}
}

185 
	$fu££rv”_»ad
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
, 
size_t
 
size
,

186 
off_t
 
off
, 
fu£_fe_šfo
 *
fi
)

189 
¡d
::
¡ršg
 
buf
;

191 
r
;

192 ià((
r
 = 
yfs
->
	`»ad
(
šo
, 
size
, 
off
, 
buf
)è=ğ
yfs_ş›Á
::
OK
) {

193 
	`fu£_»¶y_buf
(
»q
, 
buf
.
	`d©a
(), buf.
	`size
());

195 ià(
r
 =ğ
yfs_ş›Á
::
NOPEM
) {

196 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

198 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

202 
	`fu£_»¶y_”r
(
»q
, 
ENOSYS
);

206 
	}
}

224 
	$fu££rv”_wr™e
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
,

225 cÚ¡ *
buf
, 
size_t
 
size
, 
off_t
 
off
,

226 
fu£_fe_šfo
 *
fi
)

230 
r
;

231 ià((
r
 = 
yfs
->
	`wr™e
(
šo
, 
size
, 
off
, 
buf
, size)è=ğ
yfs_ş›Á
::
OK
) {

232 
	`fu£_»¶y_wr™e
(
»q
, 
size
);

234 ià(
r
 =ğ
yfs_ş›Á
::
NOPEM
) {

235 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

237 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

241 
	`fu£_»¶y_”r
(
»q
, 
ENOSYS
);

243 
	}
}

263 
	gyfs_ş›Á
::
¡©us


264 
	$fu££rv”_ü—‹h–³r
(
fu£_šo_t
 
·»Á
, cÚ¡ *
Çme
,

265 
mode_t
 
mode
, 
fu£_’Œy_·¿m
 *
e
, 
ty³
)

267 
»t
;

269 
e
->
©Œ_timeout
 = 0.0;

270 
e
->
’Œy_timeout
 = 0.0;

271 
e
->
g’”©iÚ
 = 0;

273 
yfs_ş›Á
::
šum
 inum;

274 iàĞ
ty³
 =ğ
ex‹Á_´ÙocŞ
::
T_FILE
 )

275 
»t
 = 
yfs
->
	`ü—‹
(
·»Á
, 
Çme
, 
mode
, 
šum
);

277 
»t
 = 
yfs
->
	`mkdœ
(
·»Á
,
Çme
,
mode
,
šum
);

278 ià(
»t
 !ğ
yfs_ş›Á
::
OK
)

279  
»t
;

280 
e
->
šo
 = 
šum
;

281 
»t
 = 
	`g‘©Œ
(
šum
, 
e
->
©Œ
);

282  
»t
;

283 
	}
}

286 
	$fu££rv”_ü—‹
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
·»Á
, cÚ¡ *
Çme
,

287 
mode_t
 
mode
, 
fu£_fe_šfo
 *
fi
)

289 
fu£_’Œy_·¿m
 
e
;

290 
yfs_ş›Á
::
¡©us
 
»t
;

291 ifĞ(
»t
 = 
	`fu££rv”_ü—‹h–³r
Ğ
·»Á
, 
Çme
, 
mode
, &
e
, 
ex‹Á_´ÙocŞ
::
T_FILE
)è=ğ
yfs_ş›Á
::
OK
 ) {

292 
	`fu£_»¶y_ü—‹
(
»q
, &
e
, 
fi
);

293 
	`´štf
("OK: create„eturns.\n");

295 ià(
»t
 =ğ
yfs_ş›Á
::
EXIST
) {

296 
	`fu£_»¶y_”r
(
»q
, 
EEXIST
);

297 } ià(
»t
 =ğ
yfs_ş›Á
::
NOPEM
) {

298 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

300 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

303 
	}
}

305 
	$fu££rv”_mknod
Ğ
fu£_»q_t
 
»q
, 
fu£_šo_t
 
·»Á
,

306 cÚ¡ *
Çme
, 
mode_t
 
mode
, 
dev_t
 
rdev
 ) {

307 
fu£_’Œy_·¿m
 
e
;

308 
yfs_ş›Á
::
¡©us
 
»t
;

309 ifĞ(
»t
 = 
	`fu££rv”_ü—‹h–³r
Ğ
·»Á
, 
Çme
, 
mode
, &
e
, 
ex‹Á_´ÙocŞ
::
T_FILE
)è=ğ
yfs_ş›Á
::
OK
 ) {

310 
	`fu£_»¶y_’Œy
(
»q
, &
e
);

312 ià(
»t
 =ğ
yfs_ş›Á
::
EXIST
) {

313 
	`fu£_»¶y_”r
(
»q
, 
EEXIST
);

314 }ià(
»t
 =ğ
yfs_ş›Á
::
NOPEM
) {

315 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

317 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

320 
	}
}

328 
	$fu££rv”_lookup
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
·»Á
, cÚ¡ *
Çme
)

330 
fu£_’Œy_·¿m
 
e
;

332 
e
.
©Œ_timeout
 = 0.0;

333 
e
.
’Œy_timeout
 = 0.0;

334 
e
.
g’”©iÚ
 = 0;

335 
boŞ
 
found
 = 
çl£
;

336 
yfs_ş›Á
::
¡©us
 
»t
;

338 
yfs_ş›Á
::
šum
 
šo
;

339 
»t
 = 
yfs
->
	`lookup
(
·»Á
, 
Çme
, 
found
, 
šo
);

341 ià(
»t
 =ğ
yfs_ş›Á
::
NOPEM
){

342 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

345 ià(
found
) {

346 
e
.
šo
 = ino;

347 
	`g‘©Œ
(
šo
, 
e
.
©Œ
);

348 
	`fu£_»¶y_’Œy
(
»q
, &
e
);

350 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

353 
	}
}

356 
	sdœbuf
 {

357 *
	mp
;

358 
size_t
 
	msize
;

361 
	$dœbuf_add
(
dœbuf
 *
b
, cÚ¡ *
Çme
, 
fu£_šo_t
 
šo
)

363 
¡©
 
¡buf
;

364 
size_t
 
Şdsize
 = 
b
->
size
;

365 
b
->
size
 +ğ
	`fu£_dœ’t_size
(
	`¡¾’
(
Çme
));

366 
b
->
p
 = (*è
	`»®loc
(b->p, b->
size
);

367 
	`mem£t
(&
¡buf
, 0, (stbuf));

368 
¡buf
.
¡_šo
 = 
šo
;

369 
	`fu£_add_dœ’t
(
b
->
p
 + 
Şdsize
, 
Çme
, &
¡buf
, b->
size
);

370 
	}
}

372 
	#mš
(
x
, 
y
è((xè< (yè? (xè: (y))

	)

374 
	$»¶y_buf_lim™ed
(
fu£_»q_t
 
»q
, cÚ¡ *
buf
, 
size_t
 
bufsize
,

375 
off_t
 
off
, 
size_t
 
maxsize
)

377 ià((
size_t
)
off
 < 
bufsize
)

378  
	`fu£_»¶y_buf
(
»q
, 
buf
 + 
off
, 
	`mš
(
bufsize
 - off, 
maxsize
));

380  
	`fu£_»¶y_buf
(
»q
, 
NULL
, 0);

381 
	}
}

393 
	$fu££rv”_»addœ
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
, 
size_t
 
size
,

394 
off_t
 
off
, 
fu£_fe_šfo
 *
fi
)

396 
yfs_ş›Á
::
šum
 inum = 
šo
;

397 
dœbuf
 
b
;

399 
	`´štf
("fuseserver_readdir\n");

401 if(!
yfs
->
	`isdœ
(
šum
)){

402 
	`fu£_»¶y_”r
(
»q
, 
ENOTDIR
);

406 
	`mem£t
(&
b
, 0, (b));

408 
¡d
::
li¡
<
yfs_ş›Á
::
dœ’t
> 
’Œ›s
;

409 
yfs
->
	`»addœ
(
šum
, 
’Œ›s
);

410 
¡d
::
li¡
<
yfs_ş›Á
::
dœ’t
>::
™”©Ü
 
™
 = 
’Œ›s
.
	`begš
(); iˆ!ğ’Œ›s.
	`’d
(); ++it) {

411 
	`dœbuf_add
(&
b
, 
™
->
Çme
.
	`c_¡r
(), (
fu£_šo_t
è™->
šum
);

414 
	`»¶y_buf_lim™ed
(
»q
, 
b
.
p
, b.
size
, 
off
, size);

415 
	`ä“
(
b
.
p
);

416 
	}
}

420 
	$fu££rv”_İ’
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
,

421 
fu£_fe_šfo
 *
fi
)

423 
	`fu£_»¶y_İ’
(
»q
, 
fi
);

424 
	}
}

437 
	$fu££rv”_mkdœ
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
·»Á
, cÚ¡ *
Çme
,

438 
mode_t
 
mode
)

440 
fu£_’Œy_·¿m
 
e
;

442 
e
.
©Œ_timeout
 = 0.0;

443 
e
.
’Œy_timeout
 = 0.0;

444 
e
.
g’”©iÚ
 = 0;

446 (è
e
;

450 
yfs_ş›Á
::
¡©us
 
»t
;

451 ià(Ğ
»t
 = 
	`fu££rv”_ü—‹h–³r
Ğ
·»Á
, 
Çme
, 
mode
, &
e
, 
ex‹Á_´ÙocŞ
::
T_DIR
)è=ğ
yfs_ş›Á
::
OK
) {

452 
	`fu£_»¶y_’Œy
(
»q
, &
e
);

454 ià(
»t
 =ğ
yfs_ş›Á
::
EXIST
) {

455 
	`fu£_»¶y_”r
(
»q
, 
EEXIST
);

456 } ià(
»t
 =ğ
yfs_ş›Á
::
NOPEM
) {

457 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

459 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

463 
	`fu£_»¶y_”r
(
»q
, 
ENOSYS
);

466 
	}
}

476 
	$fu££rv”_uÆšk
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
·»Á
, cÚ¡ *
Çme
)

478 
r
;

479 ià((
r
 = 
yfs
->
	`uÆšk
(
·»Á
, 
Çme
)è=ğ
yfs_ş›Á
::
OK
) {

480 
	`fu£_»¶y_”r
(
»q
, 0);

482 ià(
r
 =ğ
yfs_ş›Á
::
NOENT
) {

483 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

484 } ià(
r
 =ğ
yfs_ş›Á
::
NOPEM
) {

485 
	`fu£_»¶y_”r
(
»q
, 
EACCES
);

487 
	`fu£_»¶y_”r
(
»q
, 
ENOTEMPTY
);

490 
	}
}

493 
	$fu££rv”_¡©fs
(
fu£_»q_t
 
»q
)

495 
¡©vfs
 
buf
;

497 
	`´štf
("statfs\n");

499 
	`mem£t
(&
buf
, 0, (buf));

501 
buf
.
f_Çmemax
 = 255;

502 
buf
.
f_bsize
 = 512;

504 
	`fu£_»¶y_¡©fs
(
»q
, &
buf
);

505 
	}
}

508 
	$fu££rv”_»adlšk
(
fu£_»q_t
 
»q
, 
fu£_šo_t
 
šo
)

510 
yfs_ş›Á
::
šum
 inum = 
šo
;

511 
yfs_ş›Á
::
¡©us
 
»t
;

513 
¡d
::
¡ršg
 
buf
;

514 
»t
 = 
yfs
->
	`»adlšk
(
šum
, 
buf
);

515 if(
»t
 !ğ
yfs_ş›Á
::
OK
){

516 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

519 
	`fu£_»¶y_»adlšk
(
»q
, 
buf
.
	`c_¡r
());

520 
	}
}

523 
	$fu££rv”_symlšk
(
fu£_»q_t
 
»q
, cÚ¡ * 
lšk
,

524 
fu£_šo_t
 
·»Á
, cÚ¡ * 
Çme
)

526 
yfs_ş›Á
::
šum
 inum = 
·»Á
;

527 
yfs_ş›Á
::
šum
 
id
;

528 
yfs_ş›Á
::
¡©us
 
»t
;

529 
fu£_’Œy_·¿m
 
e
;

531 
»t
 = 
yfs
->
	`symlšk
(
šum
, 
Çme
, 
lšk
, 
id
);

532 ià(
»t
 !ğ
yfs_ş›Á
::
OK
) {

533 ià(
»t
 =ğ
yfs_ş›Á
::
EXIST
) {

534 
	`fu£_»¶y_”r
(
»q
, 
EEXIST
);

536 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

541 
e
.
šo
 = 
id
;

542 
e
.
©Œ_timeout
 = 0.0;

543 
e
.
’Œy_timeout
 = 0.0;

544 
e
.
g’”©iÚ
 = 0;

545 
»t
 = 
	`g‘©Œ
(
id
, 
e
.
©Œ
);

547 ià(
»t
 !ğ
yfs_ş›Á
::
OK
) {

548 
	`fu£_»¶y_”r
(
»q
, 
ENOENT
);

552 
	`fu£_»¶y_’Œy
(
»q
, &
e
);

553 
	}
}

556 
fu£_lowËv–_İs
 
	gfu££rv”_İ”
;

558 
	$sig_hªdËr
(
sig
){

559 
sig
){

560 
SIGINT
:

561 
	`´štf
("commit‡‚ew version\n");

562 
yfs
->
	`v”siÚ_comm™
();

564 
SIGUSR1
:

565 
	`´štf
("to…revious version\n");

566 
yfs
->
	`´ev_v”siÚ
();

568 
SIGUSR2
:

569 
	`´štf
("to‚ext version\n");

570 
yfs
->
	`Ãxt_v”siÚ
();

575 
	}
}

578 
	$maš
(
¬gc
, *
¬gv
[])

580 *
mouÁpošt
 = 0;

581 
”r
 = -1;

582 
fd
;

584 
	`£tvbuf
(
¡dout
, 
NULL
, 
_IONBF
, 0);

587 if(
¬gc
 != 5){

588 
	`årštf
(
¡d”r
, "Usage: yfs_client <mountpoint> <port-extent-server> <port-lock-server> <user-cerficiate-file>\n");

589 
	`ex™
(1);

592 if(
¬gc
 != 2){

593 
	`årštf
(
¡d”r
, "Usage: yfs_client <mountpoint>\n");

594 
	`ex™
(1);

597 
mouÁpošt
 = 
¬gv
[1];

599 
	`¤ªdom
(
	`g‘pid
());

601 
myid
 = 
	`¿ndom
();

603 
yfs
 = 
Ãw
 
	`yfs_ş›Á
(
¬gv
[2],‡rgv[3],‡rgv[4]);

604 
	`årštf
(
¡d”r
, 
¬gv
[2],‡rgv[3],‡rgv[4]);

607 
fu££rv”_İ”
.
g‘©Œ
 = 
fu££rv”_g‘©Œ
;

608 
fu££rv”_İ”
.
¡©fs
 = 
fu££rv”_¡©fs
;

609 
fu££rv”_İ”
.
»addœ
 = 
fu££rv”_»addœ
;

610 
fu££rv”_İ”
.
lookup
 = 
fu££rv”_lookup
;

611 
fu££rv”_İ”
.
ü—‹
 = 
fu££rv”_ü—‹
;

612 
fu££rv”_İ”
.
mknod
 = 
fu££rv”_mknod
;

613 
fu££rv”_İ”
.
İ’
 = 
fu££rv”_İ’
;

614 
fu££rv”_İ”
.
»ad
 = 
fu££rv”_»ad
;

615 
fu££rv”_İ”
.
wr™e
 = 
fu££rv”_wr™e
;

616 
fu££rv”_İ”
.
£‰r
 = 
fu££rv”_£‰r
;

617 
fu££rv”_İ”
.
uÆšk
 = 
fu££rv”_uÆšk
;

618 
fu££rv”_İ”
.
mkdœ
 = 
fu££rv”_mkdœ
;

624 
fu££rv”_İ”
.
»adlšk
 = 
fu££rv”_»adlšk
;

625 
fu££rv”_İ”
.
symlšk
 = 
fu££rv”_symlšk
;

627 
	`sigÇl
(
SIGINT
, 
sig_hªdËr
);

628 
	`sigÇl
(
SIGUSR1
, 
sig_hªdËr
);

629 
	`sigÇl
(
SIGUSR2
, 
sig_hªdËr
);

632 cÚ¡ *
fu£_¬gv
[20];

633 
fu£_¬gc
 = 0;

634 
fu£_¬gv
[
fu£_¬gc
++] = 
¬gv
[0];

635 #ifdeà
__APPLE__


636 
fu£_¬gv
[
fu£_¬gc
++] = "-o";

637 
fu£_¬gv
[
fu£_¬gc
++] = "nolocalcaches";

638 
fu£_¬gv
[
fu£_¬gc
++] = "-o";

639 
fu£_¬gv
[
fu£_¬gc
++] = "daemon_timeout=86400";

646 
fu£_¬gv
[
fu£_¬gc
++] = 
mouÁpošt
;

647 
fu£_¬gv
[
fu£_¬gc
++] = "-d";

649 
fu£_¬gs
 
¬gs
 = 
	`FUSE_ARGS_INIT
Ğ
fu£_¬gc
, (**è
fu£_¬gv
 );

650 
fÜeground
;

651 
»s
 = 
	`fu£_·r£_cmdlše
Ğ&
¬gs
, &
mouÁpošt
, 0 ,

652 &
fÜeground
 );

653 ifĞ
»s
 == -1 ) {

654 
	`årštf
(
¡d”r
, "fuse_parse_cmdline failed\n");

658 
¬gs
.
®loÿ‹d
 = 0;

660 
fd
 = 
	`fu£_mouÁ
(
mouÁpošt
, &
¬gs
);

661 if(
fd
 == -1){

662 
	`årštf
(
¡d”r
, "fuse_mount failed\n");

663 
	`ex™
(1);

666 
fu£_£ssiÚ
 *
£
;

668 
£
 = 
	`fu£_lowËv–_Ãw
(&
¬gs
, &
fu££rv”_İ”
, (fuseserver_oper),

669 
NULL
);

670 if(
£
 == 0){

671 
	`årštf
(
¡d”r
, "fuse_lowlevel_new failed\n");

672 
	`ex™
(1);

675 
fu£_chª
 *
ch
 = 
	`fu£_k”n_chª_Ãw
(
fd
);

676 ià(
ch
 =ğ
NULL
) {

677 
	`årštf
(
¡d”r
, "fuse_kern_chan_new failed\n");

678 
	`ex™
(1);

681 
	`fu£_£ssiÚ_add_chª
(
£
, 
ch
);

683 
”r
 = 
	`fu£_£ssiÚ_loİ
(
£
);

685 
	`fu£_£ssiÚ_de¡roy
(
£
);

686 
	`şo£
(
fd
);

687 
	`fu£_unmouÁ
(
mouÁpošt
);

689  
”r
 ? 1 : 0;

690 
	}
}

	@gettime.cc

63 #ifdeà
__APPLE__


65 #´agm¨
w—k
 
şock_g‘time


67 
	~<sys/time.h
>

68 
	~<sys/»sourû.h
>

69 
	~<mach/mach.h
>

70 
	~<mach/şock.h
>

71 
	~<mach/mach_time.h
>

72 
	~<”ºo.h
>

73 
	~<uni¡d.h
>

74 
	~<sched.h
>

77 
	mCLOCK_REALTIME
,

78 
	mCLOCK_MONOTONIC
,

79 
	mCLOCK_PROCESS_CPUTIME_ID
,

80 
	mCLOCK_THREAD_CPUTIME_ID


81 } 
	tşockid_t
;

83 
mach_timeba£_šfo_d©a_t
 
	g__şock_g‘time_šf
;

85 
	$şock_g‘time
(
şockid_t
 
şk_id
, 
time¥ec
 *

) {

86 
k”n_»tuº_t
 
»t
;

87 
şock_£rv_t
 
şk
;

88 
şock_id_t
 
şk_£rv_id
;

89 
mach_time¥ec_t
 
tm
;

91 
ušt64_t
 
¡¬t
, 
’d
, 
d–
, 
Çno
;

93 
sk_basic_šfo_d©a_t
 
tšfo
;

94 
sk_th»ad_times_šfo_d©a_t
 
‰šfo
;

95 
mach_msg_ty³_numb”_t
 
tæag
;

97 
»tv®
 = -1;

98 
şk_id
) {

99 
CLOCK_REALTIME
:

100 
CLOCK_MONOTONIC
:

101 
şk_£rv_id
 = 
şk_id
 =ğ
CLOCK_REALTIME
 ? 
CALENDAR_CLOCK
 : 
SYSTEM_CLOCK
;

102 ià(
KERN_SUCCESS
 =ğ(
»t
 = 
	`ho¡_g‘_şock_£rviû
(
	`mach_ho¡_£lf
(), 
şk_£rv_id
, &
şk
))) {

103 ià(
KERN_SUCCESS
 =ğ(
»t
 = 
	`şock_g‘_time
(
şk
, &
tm
))) {

104 

->
tv_£c
 = 
tm
.tv_sec;

105 

->
tv_n£c
 = 
tm
.tv_nsec;

106 
»tv®
 = 0;

109 ià(
KERN_SUCCESS
 !ğ
»t
) {

110 
”ºo
 = 
EINVAL
;

111 
»tv®
 = -1;

114 
CLOCK_PROCESS_CPUTIME_ID
:

115 
CLOCK_THREAD_CPUTIME_ID
:

116 
¡¬t
 = 
	`mach_absŞu‹_time
();

117 ià(
şk_id
 =ğ
CLOCK_PROCESS_CPUTIME_ID
) {

118 
	`g‘pid
();

120 
	`sched_y›ld
();

122 
’d
 = 
	`mach_absŞu‹_time
();

123 
d–
 = 
’d
 - 
¡¬t
;

124 ià(0 =ğ
__şock_g‘time_šf
.
d’om
) {

125 
	`mach_timeba£_šfo
(&
__şock_g‘time_šf
);

127 
Çno
 = 
d–
 * 
__şock_g‘time_šf
.
num”
 / __şock_g‘time_šf.
d’om
;

128 

->
tv_£c
 = 
Çno
 * 1e-9;

129 

->
tv_n£c
 = 
Çno
 - (->
tv_£c
 * 1e9);

130 
»tv®
 = 0;

133 
”ºo
 = 
EINVAL
;

134 
»tv®
 = -1;

136  
»tv®
;

137 
	}
}

	@gettime.h

1 #iâdeà
g‘time_h


2 
	#g‘time_h


	)

4 #ifdeà
__APPLE__


6 
	mCLOCK_REALTIME
,

7 
	mCLOCK_MONOTONIC
,

8 
	mCLOCK_PROCESS_CPUTIME_ID
,

9 
	mCLOCK_THREAD_CPUTIME_ID


10 } 
	tşockid_t
;

12 
şock_g‘time
(
şockid_t
 
şk_id
, 
time¥ec
 *

);

	@handle.cc

1 
	~"hªdË.h
"

2 
	~<¡dio.h
>

3 
	~"rštf.h
"

5 
hªdË_mgr
 
	gmgr
;

7 
	ghªdË
::
	$hªdË
(
¡d
::
¡ršg
 
m
)

9 
h
 = 
mgr
.
	`g‘_hªdË
(
m
);

10 
	}
}

12 
½cc
 *

13 
	ghªdË
::
	$§ãbšd
()

15 ià(!
h
)

16  
NULL
;

17 
ScİedLock
 
	`ml
(&
h
->
ş_mu‹x
);

18 ià(
h
->
d–
)

19  
NULL
;

20 ià(
h
->
ş
)

21  
h
->
ş
;

22 
sockaddr_š
 
d¡sock
;

23 
	`make_sockaddr
(
h
->
m
.
	`c_¡r
(), &
d¡sock
);

24 
½cc
 *
ş
 = 
Ãw
 
	`½cc
(
d¡sock
);

25 
	`rštf
("hªdËr_mgr::g‘_hªdËryšgØbšd...%s\n", 
h
->
m
.
	`c_¡r
());

26 
»t
;

34 
»t
 = 
ş
->
	`bšd
(
½cc
::
	`to
(1000));

35 ià(
»t
 < 0) {

36 
	`rštf
("hªdË_mgr::g‘_hªdË bšd fau»! % %d\n", 
h
->
m
.
	`c_¡r
(), 
»t
);

37 
d–‘e
 
ş
;

38 
h
->
d–
 = 
Œue
;

40 
	`rštf
("hªdË_mgr::g‘_hªdË bšd sucûeded %s\n", 
h
->
m
.
	`c_¡r
());

41 
h
->
ş
 = cl;

43  
h
->
ş
;

44 
	}
}

46 
	ghªdË
::~
	$hªdË
()

48 ià(
h
è
mgr
.
	`dÚe_hªdË
(h);

49 
	}
}

51 
	ghªdË_mgr
::
	$hªdË_mgr
()

53 
	`VERIFY
 (
	`±h»ad_mu‹x_š™
(&
hªdË_mu‹x
, 
NULL
) == 0);

54 
	}
}

56 
hšfo
 *

57 
	ghªdË_mgr
::
	$g‘_hªdË
(
¡d
::
¡ršg
 
m
)

59 
ScİedLock
 
	`ml
(&
hªdË_mu‹x
);

60 
hšfo
 *
h
 = 0;

61 ià(
hm­
.
	`fšd
(
m
è=ğhm­.
	`’d
()) {

62 
h
 = 
Ãw
 
hšfo
;

63 
h
->
ş
 = 
NULL
;

64 
h
->
d–
 = 
çl£
;

65 
h
->
»fút
 = 1;

66 
h
->
m
 = m;

67 
	`±h»ad_mu‹x_š™
(&
h
->
ş_mu‹x
, 
NULL
);

68 
hm­
[
m
] = 
h
;

69 } ià(!
hm­
[
m
]->
d–
) {

70 
h
 = 
hm­
[
m
];

71 
h
->
»fút
 ++;

73  
h
;

74 
	}
}

77 
	ghªdË_mgr
::
	$dÚe_hªdË
(
hšfo
 *
h
)

79 
ScİedLock
 
	`ml
(&
hªdË_mu‹x
);

80 
h
->
»fút
--;

81 ià(
h
->
»fút
 =ğ0 && h->
d–
)

82 
	`d–‘e_hªdË_wo
(
h
->
m
);

83 
	}
}

86 
	ghªdË_mgr
::
	$d–‘e_hªdË
(
¡d
::
¡ršg
 
m
)

88 
ScİedLock
 
	`ml
(&
hªdË_mu‹x
);

89 
	`d–‘e_hªdË_wo
(
m
);

90 
	}
}

94 
	ghªdË_mgr
::
	$d–‘e_hªdË_wo
(
¡d
::
¡ršg
 
m
)

96 ià(
hm­
.
	`fšd
(
m
è=ğhm­.
	`’d
()) {

97 
	`rštf
("hªdË_mgr::d–‘e_hªdË_wo: cÈ% i¢'ˆš cÈli¡\n", 
m
.
	`c_¡r
());

99 
	`rštf
("hªdË_mgr::d–‘e_hªdË_wo: cÈ% »fúˆ%d\n", 
m
.
	`c_¡r
(),

100 
hm­
[
m
]->
»fút
);

101 
hšfo
 *
h
 = 
hm­
[
m
];

102 ià(
h
->
»fút
 == 0) {

103 ià(
h
->
ş
) {

104 
h
->
ş
->
	`ÿnûl
();

105 
d–‘e
 
h
->
ş
;

107 
	`±h»ad_mu‹x_de¡roy
(&
h
->
ş_mu‹x
);

108 
hm­
.
	`”a£
(
m
);

109 
d–‘e
 
h
;

111 
h
->
d–
 = 
Œue
;

114 
	}
}

	@handle.h

23 #iâdeà
hªdË_h


24 
	#hªdË_h


	)

26 
	~<¡ršg
>

27 
	~<veùÜ
>

28 
	~"½c.h
"

30 
	shšfo
 {

31 
½cc
 *
	mş
;

32 
	m»fút
;

33 
boŞ
 
	md–
;

34 
	m¡d
::
¡ršg
 
m
;

35 
±h»ad_mu‹x_t
 
	mş_mu‹x
;

38 şas 
	chªdË
 {

39 
	m´iv©e
:

40 
hšfo
 *
h
;

41 
	mpublic
:

42 
hªdË
(
¡d
::
¡ršg
 
m
);

43 ~
hªdË
();

62 
½cc
 *
§ãbšd
();

65 şas 
	chªdË_mgr
 {

66 
	m´iv©e
:

67 
±h»ad_mu‹x_t
 
hªdË_mu‹x
;

68 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mhšfo
 *> 
	mhm­
;

69 
	mpublic
:

70 
hªdË_mgr
();

71 
hšfo
 *
g‘_hªdË
(
¡d
::
¡ršg
 
m
);

72 
dÚe_hªdË
(
hšfo
 *
h
);

73 
d–‘e_hªdË
(
¡d
::
¡ršg
 
m
);

74 
d–‘e_hªdË_wo
(
¡d
::
¡ršg
 
m
);

77 
şass
 
hªdË_mgr
 
mgr
;

	@inode_manager.cc

1 
	~"šode_mªag”.h
"

2 
	~<c¡ršg
>

3 
	~<ùime
>

7 
	gdisk
::
	$disk
()

9 
	`bz”o
(
blocks
, (blocks));

10 
	}
}

13 
	gdisk
::
	$»ad_block
(
blockid_t
 
id
, *
buf
)

22 if(
id
 < 0 || id > 
BLOCK_NUM
 || 
buf
 =ğ
NULL
){

23 
	`´štf
("\tdisk:ƒ¼Ü! inv®id blockid %d\n", 
id
);

27 
¡d
::
	`memıy
(
buf
, 
blocks
[
id
], 
BLOCK_SIZE
);

28 
	}
}

31 
	gdisk
::
	$wr™e_block
(
blockid_t
 
id
, cÚ¡ *
buf
)

37 if(
id
 < 0 || id > 
BLOCK_NUM
 || 
buf
 =ğ
NULL
){

38 
	`´štf
("\tdisk:ƒ¼Ü! inv®id blockid %d\n", 
id
);

42 
¡d
::
	`memıy
(
blocks
[
id
], 
buf
, 
BLOCK_SIZE
);

44 
	`memıy
(
blocks
[
id
], 
buf
, 
BLOCK_SIZE
);

45 
	}
}

50 
blockid_t


51 
	gblock_mªag”
::
	$®loc_block
()

62 
buf
[
BLOCK_SIZE
];

64 
blockid_t
 
fœ¡_d©a_block
 = 
	`IBLOCK
(
sb
.
nšodes
, sb.
nblocks
) + 1;

65 
blockid_t
 
now_block
 = 
fœ¡_d©a_block
;

66 
now_block
 < 
sb
.
nblocks
){

67 
	`»ad_block
(
	`BBLOCK
(
now_block
), 
buf
);

68 
i
 = 0; i < 
BLOCK_SIZE
 && 
now_block
 < 
sb
.
nblocks
; i++){

69 
mask
 = 0x80;

73 
mask
 !ğ0 && 
now_block
 < 
sb
.
nblocks
){

75 if((
mask
 & 
buf
[
i
]) == 0){

76 
buf
[
i
] = buf[i] | 
mask
;

77 
	`wr™e_block
(
	`BBLOCK
(
now_block
), 
buf
);

78 
	`´štf
("\tbm:‡Îoc_block: %d\n", 
now_block
);

79  
now_block
;

82 
mask
 = mask >> 1;

83 
now_block
 ++;

88 
	`´štf
("\tbm:ƒrror! out of blocks\n");

89 
	`ex™
(0);

90 
	}
}

93 
	gblock_mªag”
::
	$ä“_block
(
ušt32_t
 
id
)

99 
buf
[
BLOCK_SIZE
];

100 
	`»ad_block
(
	`BBLOCK
(
id
), 
buf
);

101 
šdex
 = (
id
 % 
BPB
) >> 3;

102 
šdex_š_group
 = (
id
 % 
BPB
) % 8;

103 
mask
 = 0x80;

104 
mask
 = !(mask >> 
šdex_š_group
);

105 
buf
[
šdex
] = buf[šdex] | 
mask
;

107 
	`wr™e_block
(
	`BBLOCK
(
id
), 
buf
);

108 
	}
}

112 
	gblock_mªag”
::
	$block_mªag”
()

114 
d
 = 
Ãw
 
	`disk
();

117 
sb
.
size
 = 
BLOCK_SIZE
 * 
BLOCK_NUM
;

118 
sb
.
nblocks
 = 
BLOCK_NUM
;

119 
sb
.
nšodes
 = 
INODE_NUM
;

121 
	}
}

124 
	gblock_mªag”
::
	$»ad_block
(
ušt32_t
 
id
, *
buf
)

126 
d
->
	`»ad_block
(
id
, 
buf
);

127 
	}
}

130 
	gblock_mªag”
::
	$wr™e_block
(
ušt32_t
 
id
, cÚ¡ *
buf
)

132 
d
->
	`wr™e_block
(
id
, 
buf
);

133 
	}
}

137 
	gšode_mªag”
::
	$šode_mªag”
()

139 
bm
 = 
Ãw
 
	`block_mªag”
();

140 
ušt32_t
 
roÙ_dœ
 = 
	`®loc_šode
(
ex‹Á_´ÙocŞ
::
T_DIR
);

141 ià(
roÙ_dœ
 != 1) {

142 
	`´štf
("\tim:ƒ¼Ü!‡Îoøfœ¡ inod%d, should b1\n", 
roÙ_dœ
);

143 
	`ex™
(0);

145 
	}
}

149 
ušt32_t


150 
	gšode_mªag”
::
	$®loc_šode
(
ušt32_t
 
ty³
)

160 
buf
[
BLOCK_SIZE
];

162 
ušt32_t
 
now_šode
 = 1;

163 
now_šode
 <ğ
bm
->
sb
.
nšodes
){

164 
bm
->
	`»ad_block
(
	`IBLOCK
(
now_šode
, bm->
sb
.
nblocks
), 
buf
);

165 
i
 = 0; 
now_šode
 < 
bm
->
sb
.
nšodes
 && i < 
IPB
; i++){

166 
šode_t
 *
šode
 = (šode_ˆ*)
buf
 + 
i
;

167 if(
šode
->
ty³
 == 0) {

169 
šode
->
ty³
 =ype;

170 
šode
->
size
 = 0;

171 
šode
->
ùime
 = 
¡d
::
	`time
(0);

172 
šode
->
©ime
 = 
¡d
::
	`time
(0);

173 
šode
->
mtime
 = 
¡d
::
	`time
(0);

174 
bm
->
	`wr™e_block
(
	`IBLOCK
(
now_šode
, bm->
sb
.
nblocks
), 
buf
);

175  
now_šode
;

177 
now_šode
++;

181 
	`´štf
("\tim:ƒrror! out of inodes\n");

182 
	`ex™
(0);

184 
	}
}

187 
	gšode_mªag”
::
	$ä“_šode
(
ušt32_t
 
šum
)

197 ià(
šum
 < 0 || inum >ğ
INODE_NUM
) {

198 
	`´štf
("\tim: inum out of„ange\n");

202 
a_block
[
BLOCK_SIZE
];

203 
bm
->
	`»ad_block
(
	`IBLOCK
(
šum
, bm->
sb
.
nblocks
), 
a_block
);

205 
šdex
 = 
šum
 % 
IPB
;

206 
šode_t
 *
šode
 = (šode_ˆ*)
a_block
 + 
šdex
;

207 ià(
šode
->
ty³
 == 0) {

208 
	`´štf
("\tim: inode‚otƒxist\n");

212 
šode
->
ty³
 = 0;

213 
bm
->
	`wr™e_block
(
	`IBLOCK
(
šum
, bm->
sb
.
nblocks
), 
a_block
);

215 
	}
}

220 
šode
*

221 
	gšode_mªag”
::
	$g‘_šode
(
ušt32_t
 
šum
)

223 
šode
 *
šo
, *
šo_disk
;

224 
buf
[
BLOCK_SIZE
];

226 
	`´štf
("\tim: g‘_šod%d\n", 
šum
);

228 ià(
šum
 < 0 || inum >ğ
INODE_NUM
) {

229 
	`´štf
("\tim: inum out of„ange\n");

230  
NULL
;

233 
bm
->
	`»ad_block
(
	`IBLOCK
(
šum
, bm->
sb
.
nblocks
), 
buf
);

236 
šo_disk
 = (
šode
*)
buf
 + 
šum
%
IPB
;

237 ià(
šo_disk
->
ty³
 == 0) {

238 
	`´štf
("\tim: inode‚otƒxist\n");

239  
NULL
;

242 
šo
 = (
šode
*)
	`m®loc
((inode));

243 *
šo
 = *
šo_disk
;

245  
šo
;

246 
	}
}

249 
	gšode_mªag”
::
	$put_šode
(
ušt32_t
 
šum
, 
šode
 *
šo
)

251 
buf
[
BLOCK_SIZE
];

252 
šode
 *
šo_disk
;

254 
	`´štf
("\tim:…ut_šod%d\n", 
šum
);

255 ià(
šo
 =ğ
NULL
)

258 
bm
->
	`»ad_block
(
	`IBLOCK
(
šum
, bm->
sb
.
nblocks
), 
buf
);

259 
šo_disk
 = (
šode
*)
buf
 + 
šum
%
IPB
;

260 *
šo_disk
 = *
šo
;

261 
bm
->
	`wr™e_block
(
	`IBLOCK
(
šum
, bm->
sb
.
nblocks
), 
buf
);

262 
	}
}

264 
	#MIN
(
a
,
b
è(×)<(bè? (aè: (b))

	)

269 
	gšode_mªag”
::
	$»ad_fe
(
ušt32_t
 
šum
, **
buf_out
, *
size
)

276 
šode_t
 *
šode
 = 
	`g‘_šode
(
šum
);

277 *
buf
 = (*è
	`m®loc
(
šode
->
size
);

278 
a_block
[
BLOCK_SIZE
];

279 
šdœeù_šode
[
BLOCK_SIZE
];

280 
now_pos™iÚ
 = 0;

282 
i
 = 0; i < 
NDIRECT
 && 
now_pos™iÚ
 < 
šode
->
size
 ; i++)

284 ià((
šode
->
size
 - 
now_pos™iÚ
è>ğ
BLOCK_SIZE
){

285 
bm
->
	`»ad_block
(
šode
->
blocks
[
i
], 
buf
 + 
now_pos™iÚ
);

286 
now_pos™iÚ
 +ğ
BLOCK_SIZE
;

289 
»maš
 = 
šode
->
size
 - 
now_pos™iÚ
;

290 
bm
->
	`»ad_block
(
šode
->
blocks
[
i
], 
a_block
);

291 
	`memıy
(
buf
 + 
now_pos™iÚ
, 
a_block
, 
»maš
);

292 
now_pos™iÚ
 +ğ
»maš
;

296 if(
now_pos™iÚ
 < 
šode
->
size
){

298 
bm
->
	`»ad_block
(
šode
->
blocks
[
NDIRECT
], 
šdœeù_šode
);

300 
i
 = 0; i < 
NINDIRECT
 && 
now_pos™iÚ
 < 
šode
->
size
 ; i++)

302 
blockid_t
 
šdœeù_id
 = *((blockid_ˆ*)
šdœeù_šode
 + 
i
);

303 ià((
šode
->
size
 - 
now_pos™iÚ
è>ğ
BLOCK_SIZE
){

304 
bm
->
	`»ad_block
(
šdœeù_id
, 
buf
 + 
now_pos™iÚ
);

305 
now_pos™iÚ
 +ğ
BLOCK_SIZE
;

308 
»maš
 = 
šode
->
size
 - 
now_pos™iÚ
;

309 
bm
->
	`»ad_block
(
šdœeù_id
, 
a_block
);

310 
	`memıy
(
buf
 + 
now_pos™iÚ
, 
a_block
, 
»maš
);

311 
now_pos™iÚ
 +ğ
»maš
;

319 *
buf_out
 = 
buf
;

320 *
size
 = 
šode
->size;

321 
šode
->
©ime
 = 
¡d
::
	`time
(0);

322 
	`put_šode
(
šum
, 
šode
);

324 
	`ä“
(
šode
);

325 
šode
 = 
NULL
;

327 
	}
}

331 
	gšode_mªag”
::
	$wr™e_fe
(
ušt32_t
 
šum
, cÚ¡ *
buf
, 
size
)

340 if(
buf
 =ğ
NULL
){

341 
	`´štf
("\tim:ƒrror: write content is‚ull\n");

349 
block
[
BLOCK_SIZE
];

350 
šdœeù
[
BLOCK_SIZE
];

351 
šode_t
 * 
šo
 = 
	`g‘_šode
(
šum
);

352 
Şd_block_num
 = (
šo
->
size
 + 
BLOCK_SIZE
 - 1) / BLOCK_SIZE;

353 
Ãw_block_num
 = (
size
 + 
BLOCK_SIZE
 - 1) / BLOCK_SIZE;

356 ià(
Şd_block_num
 > 
Ãw_block_num
) {

357 ià(
Ãw_block_num
 > 
NDIRECT
) {

358 
bm
->
	`»ad_block
(
šo
->
blocks
[
NDIRECT
], 
šdœeù
);

359 
i
 = 
Ãw_block_num
; i < 
Şd_block_num
; ++i) {

360 
bm
->
	`ä“_block
(*((
blockid_t
 *)
šdœeù
 + (
i
 - 
NDIRECT
)));

363 ià(
Şd_block_num
 > 
NDIRECT
) {

364 
bm
->
	`»ad_block
(
šo
->
blocks
[
NDIRECT
], 
šdœeù
);

365 
i
 = 
NDIRECT
; i < 
Şd_block_num
; ++i) {

366 
bm
->
	`ä“_block
(*((
blockid_t
 *)
šdœeù
 + (
i
 - 
NDIRECT
)));

368 
bm
->
	`ä“_block
(
šo
->
blocks
[
NDIRECT
]);

369 
i
 = 
Ãw_block_num
; i < 
NDIRECT
; ++i) {

370 
bm
->
	`ä“_block
(
šo
->
blocks
[
i
]);

373 
i
 = 
Ãw_block_num
; i < 
Şd_block_num
; ++i) {

374 
bm
->
	`ä“_block
(
šo
->
blocks
[
i
]);

381 ià(
Ãw_block_num
 > 
Şd_block_num
) {

382 ià(
Ãw_block_num
 <ğ
NDIRECT
) {

383 
i
 = 
Şd_block_num
; i < 
Ãw_block_num
; ++i) {

384 
šo
->
blocks
[
i
] = 
bm
->
	`®loc_block
();

387 ià(
Şd_block_num
 <ğ
NDIRECT
) {

388 
i
 = 
Şd_block_num
; i < 
NDIRECT
; ++i) {

389 
šo
->
blocks
[
i
] = 
bm
->
	`®loc_block
();

391 
šo
->
blocks
[
NDIRECT
] = 
bm
->
	`®loc_block
();

393 
	`bz”o
(
šdœeù
, 
BLOCK_SIZE
);

394 
i
 = 
NDIRECT
; i < 
Ãw_block_num
; ++i) {

395 *((
blockid_t
 *)
šdœeù
 + (
i
 - 
NDIRECT
)èğ
bm
->
	`®loc_block
();

397 
bm
->
	`wr™e_block
(
šo
->
blocks
[
NDIRECT
], 
šdœeù
);

399 
bm
->
	`»ad_block
(
šo
->
blocks
[
NDIRECT
], 
šdœeù
);

400 
i
 = 
Şd_block_num
; i < 
Ãw_block_num
; ++i) {

401 *((
blockid_t
 *)
šdœeù
 + (
i
 - 
NDIRECT
)èğ
bm
->
	`®loc_block
();

403 
bm
->
	`wr™e_block
(
šo
->
blocks
[
NDIRECT
], 
šdœeù
);

409 
cur
 = 0;

411 
i
 = 0; i < 
NDIRECT
 && 
cur
 < 
size
; ++i) {

412 ià(
size
 - 
cur
 > 
BLOCK_SIZE
) {

413 
bm
->
	`wr™e_block
(
šo
->
blocks
[
i
], 
buf
 + 
cur
);

414 
cur
 +ğ
BLOCK_SIZE
;

416 
Ën
 = 
size
 - 
cur
;

417 
	`memıy
(
block
, 
buf
 + 
cur
, 
Ën
);

418 
bm
->
	`wr™e_block
(
šo
->
blocks
[
i
], 
block
);

419 
cur
 +ğ
Ën
;

423 ià(
cur
 < 
size
) {

424 
bm
->
	`»ad_block
(
šo
->
blocks
[
NDIRECT
], 
šdœeù
);

425 
i
 = 0; i < 
NINDIRECT
 && 
cur
 < 
size
; ++i) {

426 
blockid_t
 
ix
 = *((blockid_ˆ*)
šdœeù
 + 
i
);

427 ià(
size
 - 
cur
 > 
BLOCK_SIZE
) {

428 
bm
->
	`wr™e_block
(
ix
, 
buf
 + 
cur
);

429 
cur
 +ğ
BLOCK_SIZE
;

431 
Ën
 = 
size
 - 
cur
;

432 
	`memıy
(
block
, 
buf
 + 
cur
, 
Ën
);

433 
bm
->
	`wr™e_block
(
ix
, 
block
);

434 
cur
 +ğ
Ën
;

443 
šo
->
size
 = size;

444 
šo
->
mtime
 = 
¡d
::
	`time
(0);

445 
šo
->
ùime
 = 
¡d
::
	`time
(0);

446 
	`put_šode
(
šum
, 
šo
);

448 
	`ä“
(
šo
);

449 
šo
 = 
NULL
;

450 
	}
}

453 
	gšode_mªag”
::
	$g‘©Œ
(
ušt32_t
 
šum
, 
ex‹Á_´ÙocŞ
::
©Œ
 &
a
)

460 
šode
 *šodğ
	`g‘_šode
(
šum
);

461 if(
šode
){

462 
a
.
ty³
 = 
šode
->type;

463 
a
.
©ime
 = 
šode
->atime;

464 
a
.
ùime
 = 
šode
->ctime;

465 
a
.
mtime
 = 
šode
->mtime;

466 
a
.
size
 = 
šode
->size;

469 
	`ä“
(
šode
);

470 
šode
 = 
NULL
;

472 
	}
}

475 
	gšode_mªag”
::
	$»move_fe
(
ušt32_t
 
šum
)

482 
šode
 *šodğ
	`g‘_šode
(
šum
);

483 
block_num
 = (
šode
->
size
 + 
BLOCK_SIZE
 - 1) / BLOCK_SIZE;

484 if(
block_num
 <ğ
NDIRECT
){

485 
i
 = 0; i < 
block_num
; i++){

486 
bm
->
	`ä“_block
(
šode
->
blocks
[
i
]);

491 
i
 = 0; i < 
NDIRECT
; i++){

492 
bm
->
	`ä“_block
(
šode
->
blocks
[
i
]);

494 
a_block
[
BLOCK_SIZE
];

495 
bm
->
	`»ad_block
(
šode
->
blocks
[
NDIRECT
], 
a_block
);

496 
i
 = 
NDIRECT
; i < 
block_num
; i++){

497 
blockid_t
 
block_id
 = *((blockid_ˆ*)
a_block
 + 
i
);

498 
bm
->
	`ä“_block
(
block_id
);

501 
bm
->
	`ä“_block
(
šode
->
blocks
[
NDIRECT
]);

504 
	`ä“
(
šode
);

505 
šode
 = 
NULL
;

506 
	`ä“_šode
(
šum
);

507 
	}
}

509 
	gšode_mªag”
::
	$ş—rfs
()

511 
d–‘e
 
bm
;

513 
bm
 = 
Ãw
 
	`block_mªag”
();

514 
ušt32_t
 
roÙ_dœ
 = 
	`®loc_šode
(
ex‹Á_´ÙocŞ
::
T_DIR
);

515 if(
roÙ_dœ
 != 1){

516 
	`´štf
("\tim:ƒ¼Ü!‡Îoøfœ¡ inod%d, should b1\n", 
roÙ_dœ
);

517 
	`ex™
(0);

520 
	}
}

	@inode_manager.h

3 #iâdeà
šode_h


4 
	#šode_h


	)

6 
	~<¡dšt.h
>

7 
	~"ex‹Á_´ÙocŞ.h
"

9 
	#DISK_SIZE
 1024*1024*16

	)

10 
	#BLOCK_SIZE
 512

	)

11 
	#BLOCK_NUM
 (
DISK_SIZE
/
BLOCK_SIZE
)

	)

13 
ušt32_t
 
	tblockid_t
;

17 şas 
	cdisk
 {

18 
	m´iv©e
:

19 
blocks
[
BLOCK_NUM
][
BLOCK_SIZE
];

21 
	mpublic
:

22 
disk
();

23 
»ad_block
(
ušt32_t
 
id
, *
buf
);

24 
wr™e_block
(
ušt32_t
 
id
, cÚ¡ *
buf
);

29 
	ssu³rblock
 {

30 
ušt32_t
 
	msize
;

31 
ušt32_t
 
	mnblocks
;

32 
ušt32_t
 
	mnšodes
;

33 } 
	tsu³rblock_t
;

35 şas 
	cblock_mªag”
 {

36 
	m´iv©e
:

37 
disk
 *
d
;

38 
	m¡d
::
m­
 <
ušt32_t
, > 
	musšg_blocks
;

39 
	mpublic
:

40 
block_mªag”
();

41 
su³rblock
 
	msb
;

43 
ušt32_t
 
®loc_block
();

44 
ä“_block
(
ušt32_t
 
id
);

45 
»ad_block
(
ušt32_t
 
id
, *
buf
);

46 
wr™e_block
(
ušt32_t
 
id
, cÚ¡ *
buf
);

51 
	#INODE_NUM
 1024

	)

54 
	#IPB
 1

	)

58 
	#IBLOCK
(
i
, 
nblocks
è(Òblocks)/
BPB
 + (i)/
IPB
 + 3)

	)

61 
	#BPB
 (
BLOCK_SIZE
*8)

	)

64 
	#BBLOCK
(
b
è((b)/
BPB
 + 2)

	)

66 
	#NDIRECT
 32

	)

67 
	#NINDIRECT
 (
BLOCK_SIZE
 / (
ušt
))

	)

68 
	#MAXFILE
 (
NDIRECT
 + 
NINDIRECT
)

	)

70 
	sšode
 {

72 
	mty³
;

73 
	msize
;

74 
	m©ime
;

75 
	mmtime
;

76 
	mùime
;

77 
blockid_t
 
	mblocks
[
NDIRECT
+1];

78 } 
	tšode_t
;

80 şas 
	cšode_mªag”
 {

81 
	m´iv©e
:

82 
block_mªag”
 *
bm
;

83 
šode
* 
g‘_šode
(
ušt32_t
 
šum
);

84 
put_šode
(
ušt32_t
 
šum
, 
šode
 *
šo
);

86 
	mpublic
:

87 
šode_mªag”
();

88 
ušt32_t
 
®loc_šode
(ušt32_ˆ
ty³
);

89 
ä“_šode
(
ušt32_t
 
šum
);

90 
»ad_fe
(
ušt32_t
 
šum
, **
buf
, *
size
);

91 
wr™e_fe
(
ušt32_t
 
šum
, cÚ¡ *
buf
, 
size
);

92 
»move_fe
(
ušt32_t
 
šum
);

93 
g‘©Œ
(
ušt32_t
 
šum
, 
ex‹Á_´ÙocŞ
::
©Œ
 &
a
);

96 
ş—rfs
();

	@lab1_tester.cc

26 
	~"ex‹Á_ş›Á.h
"

27 
	~<¡dio.h
>

29 
	#FILE_NUM
 50

	)

30 
	#LARGE_FILE_SIZE
 512*64

	)

32 
	#ršt
(
msg
) \

33 
	`´štf
("[TEST_ERROR]: %s\n", 
msg
);

	)

34 
ex‹Á_ş›Á
 *
	gec
;

35 
	gtÙ®_scÜe
 = 0;

37 
	$‹¡_ü—‹_ªd_g‘©Œ
()

39 
i
, 
ºum
;

40 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
;

41 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

43 
	`´štf
("========== beginest create‡nd getattr ==========\n");

45 
	`¤ªd
(()
	`time
(
NULL
));

47 
i
 = 0; i < 
FILE_NUM
; i++) {

48 
ºum
 = 
	`¿nd
() % 10;

49 
	`mem£t
(&
a
, 0, (a));

50 ià(
ºum
 < 3) {

51 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_DIR
, 
id
);

52 ià(()
id
 == 0) {

53 
	`ršt
("error creating dir\n");

56 ià(
ec
->
	`g‘©Œ
(
id
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

57 
	`ršt
("error getting‡ttr,„eturn‚ot OK\n");

60 ià(
a
.
ty³
 !ğ
ex‹Á_´ÙocŞ
::
T_DIR
) {

61 
	`ršt
("error getting‡ttr,ype is wrong");

65 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_FILE
, 
id
);

66 ià(()
id
 == 0) {

67 
	`ršt
("error creating dir\n");

70 ià(
ec
->
	`g‘©Œ
(
id
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

71 
	`ršt
("error getting‡ttr,„eturn‚ot OK\n");

74 ià(
a
.
ty³
 !ğ
ex‹Á_´ÙocŞ
::
T_FILE
) {

75 
	`ršt
("error getting‡ttr,ype is wrong");

80 
tÙ®_scÜe
 += 40;

81 
	`´štf
("==========…assest create‡nd getattr ==========\n");

83 
	}
}

85 
	$‹¡_šdœeù
()

87 
i
, 
ºum
;

88 *
‹mp1
 = (*)
	`m®loc
(
LARGE_FILE_SIZE
);

89 *
‹mp2
 = (*)
	`m®loc
(
LARGE_FILE_SIZE
);

90 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id1
, 
id2
;

91 
	`´štf
("beginest indirect\n");

92 
	`¤ªd
(()
	`time
(
NULL
));

94 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_FILE
, 
id1
);

95 
i
 = 0; i < 
LARGE_FILE_SIZE
; i++) {

96 
ºum
 = 
	`¿nd
() % 26;

97 
‹mp1
[
i
] = 97 + 
ºum
;

99 
¡d
::
¡ršg
 
	`buf
(
‹mp1
);

100 ià(
ec
->
	`put
(
id1
, 
buf
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

101 
	`´štf
("error…ut,„eturn‚ot OK\n");

104 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_FILE
, 
id2
);

105 
i
 = 0; i < 
LARGE_FILE_SIZE
; i++) {

106 
ºum
 = 
	`¿nd
() % 26;

107 
‹mp2
[
i
] = 97 + 
ºum
;

109 
¡d
::
¡ršg
 
	`buf2
(
‹mp2
);

110 ià(
ec
->
	`put
(
id2
, 
buf2
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

111 
	`´štf
("error…ut,„eturn‚ot OK\n");

114 
¡d
::
¡ršg
 
buf_2
;

115 ià(
ec
->
	`g‘
(
id1
, 
buf_2
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

116 
	`´štf
("error get,„eturn‚ot OK\n");

119 ià(
buf
.
	`com·»
(
buf_2
) != 0) {

120 
¡d
::
cout
 << "error get†arge file,‚ot consistent with…ut†arge file : " <<

121 
buf
 << " <-> " << 
buf_2
 << "\n";

124 
¡d
::
¡ršg
 
buf2_2
;

125 ià(
ec
->
	`g‘
(
id2
, 
buf2_2
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

126 
	`´štf
("error get,„eturn‚ot OK\n");

129 ià(
buf2
.
	`com·»
(
buf2_2
) != 0) {

130 
¡d
::
cout
 << "error get†arge file 2,‚ot consistent with…ut†arge file : " <<

131 
buf2
 << " <-> " << 
buf2_2
 << "\n";

135 
tÙ®_scÜe
 += 10;

136 
	`´štf
("endest indirect\n");

138 
	}
}

140 
	$‹¡_put_ªd_g‘
()

142 
i
, 
ºum
;

143 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
;

144 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

145 
cÚ‹Ás
[
FILE_NUM
];

146 *
‹mp
 = (*)
	`m®loc
(10);

148 
	`´štf
("========== beginest…ut‡nd get ==========\n");

149 
	`¤ªd
(()
	`time
(
NULL
));

150 
i
 = 0; i < 
FILE_NUM
; i++) {

151 
	`mem£t
(&
a
, 0, (a));

152 
id
 = (
ex‹Á_´ÙocŞ
::
ex‹Áid_t
)(
i
+2);

153 ià(
ec
->
	`g‘©Œ
(
id
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

154 
	`ršt
("error getting‡ttr,„eturn‚ot OK\n");

157 ià(
a
.
ty³
 =ğ
ex‹Á_´ÙocŞ
::
T_FILE
) {

158 
ºum
 = 
	`¿nd
() % 10000;

159 
	`mem£t
(
‹mp
, 0, 10);

160 
	`¥rštf
(
‹mp
, "%d", 
ºum
);

161 
¡d
::
¡ršg
 
	`buf
(
‹mp
);

162 ià(
ec
->
	`put
(
id
, 
buf
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

163 
	`ršt
("error…ut,„eturn‚ot OK\n");

166 
cÚ‹Ás
[
i
] = 
ºum
;

169 
i
 = 0; i < 
FILE_NUM
; i++) {

170 
	`mem£t
(&
a
, 0, (a));

171 
id
 = (
ex‹Á_´ÙocŞ
::
ex‹Áid_t
)(
i
+2);

172 ià(
ec
->
	`g‘©Œ
(
id
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

173 
	`ršt
("error getting‡ttr,„eturn‚ot OK\n");

176 ià(
a
.
ty³
 =ğ
ex‹Á_´ÙocŞ
::
T_FILE
) {

177 
¡d
::
¡ršg
 
buf
;

178 ià(
ec
->
	`g‘
(
id
, 
buf
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

179 
	`ršt
("error get,„eturn‚ot OK\n");

182 
	`mem£t
(
‹mp
, 0, 10);

183 
	`¥rštf
(
‹mp
, "%d", 
cÚ‹Ás
[
i
]);

184 
¡d
::
¡ršg
 
	`buf2
(
‹mp
);

185 ià(
buf
.
	`com·»
(
buf2
) != 0) {

186 
¡d
::
cout
 << "[TEST_ERROR] :ƒrror get,‚ot consistent with…ut " <<

187 
buf
 << " <-> " << 
buf2
 << "\n\n";

193 
tÙ®_scÜe
 += 30;

194 
	`‹¡_šdœeù
();

195 
	`´štf
("==========…assest…ut‡nd get ==========\n");

197 
	}
}

199 
	$‹¡_»move
()

201 
i
;

202 
ex‹Á_´ÙocŞ
::
ex‹Áid_t
 
id
;

203 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

205 
	`´štf
("========== beginest„emove ==========\n");

206 
i
 = 0; i < 
FILE_NUM
; i++) {

207 
	`mem£t
(&
a
, 0, (a));

208 
id
 = (
ex‹Á_´ÙocŞ
::
ex‹Áid_t
)(
i
+2);

209 ià(
ec
->
	`»move
(
id
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

210 
	`ršt
("error„emoving,„eturn‚ot OK\n");

213 
ec
->
	`g‘©Œ
(
id
, 
a
);

214 ià(
a
.
ty³
 != 0) {

215 
	`ršt
("error„emoving,ype is still…ositive\n");

219 
tÙ®_scÜe
 += 20;

220 
	`´štf
("==========…assest„emove ==========\n");

222 
	}
}

224 
	$maš
(
¬gc
, *
¬gv
[])

226 ià(
¬gc
 != 1) {

227 
	`´štf
("Usage: ./lab1_tester\n");

231 
ec
 = 
Ãw
 
	`ex‹Á_ş›Á
();

233 ià(
	`‹¡_ü—‹_ªd_g‘©Œ
() != 0)

234 
‹¡_fšish
;

235 ià(
	`‹¡_put_ªd_g‘
() != 0)

236 
‹¡_fšish
;

237 ià(
	`‹¡_»move
() != 0)

238 
‹¡_fšish
;

240 
‹¡_fšish
:

241 
	`´štf
("---------------------------------\n");

242 
	`´štf
("Fš® scÜi : %d\n", 
tÙ®_scÜe
);

244 
	}
}

	@lang/algorithm.h

3 #iâdeà
®gÜ™hm_h


4 
	#®gÜ™hm_h


	)

6 
	g‹m¶©e
 <
	gA
, 
	gB
>

7 
	s¡©ic_max


9 cÚ¡ 
	mv®ue
 = 
A
 > 
B
 ? A : B;

12 
	g‹m¶©e
 <
	gA
, 
	gB
>

13 
	s¡©ic_mš


15 cÚ¡ 
	mv®ue
 = 
A
 < 
B
 ? A : B;

	@lang/verify.h

3 #iâdeà
v”ify_ş›Á_h


4 
	#v”ify_ş›Á_h


	)

6 
	~<¡dlib.h
>

7 
	~<as£¹.h
>

9 #ifdeà
NDEBUG


10 
	#VERIFY
(
ex´
èdØ{ ià(!Óx´)è
	`abÜt
(); } 0)

	)

12 
	#VERIFY
(
ex´
è
	`as£¹
Óx´)

	)

	@lock_client.cc

3 
	~"lock_ş›Á.h
"

4 
	~"½c.h
"

5 
	~<¬·/š‘.h
>

7 
	~<s¡»am
>

8 
	~<io¡»am
>

9 
	~<¡dio.h
>

11 
	glock_ş›Á
::
	$lock_ş›Á
(
¡d
::
¡ršg
 
d¡
)

13 
sockaddr_š
 
d¡sock
;

14 
	`make_sockaddr
(
d¡
.
	`c_¡r
(), &
d¡sock
);

15 
ş
 = 
Ãw
 
	`½cc
(
d¡sock
);

16 ià(
ş
->
	`bšd
() < 0) {

17 
	`´štf
("lock_client: call bind\n");

19 
	}
}

22 
	glock_ş›Á
::
	$¡©
(
lock_´ÙocŞ
::
lockid_t
 
lid
)

24 
r
;

25 
lock_´ÙocŞ
::
¡©us
 
»t
 = 
ş
->
	`ÿÎ
Öock_´ÙocŞ::
¡©
, cl->
	`id
(), 
lid
, 
r
);

26 
	`VERIFY
 (
»t
 =ğ
lock_´ÙocŞ
::
OK
);

27  
r
;

28 
	}
}

30 
	glock_´ÙocŞ
::
¡©us


31 
lock_ş›Á
::
	$acquœe
(
lock_´ÙocŞ
::
lockid_t
 
lid
)

34 
r
;

35 
lock_´ÙocŞ
::
¡©us
 
»t
 = 
ş
->
	`ÿÎ
Öock_´ÙocŞ::
acquœe
, cl->
	`id
(), 
lid
, 
r
);

36 
	`VERIFY
(
»t
 =ğ
lock_´ÙocŞ
::
OK
);

37  
r
;

38 
	}
}

40 
	glock_´ÙocŞ
::
¡©us


41 
lock_ş›Á
::
	$»Ëa£
(
lock_´ÙocŞ
::
lockid_t
 
lid
)

44 
r
;

45 
lock_´ÙocŞ
::
¡©us
 
»t
 = 
ş
->
	`ÿÎ
Öock_´ÙocŞ::
»Ëa£
, cl->
	`id
(), 
lid
, 
r
);

46 
	`VERIFY
(
»t
 =ğ
lock_´ÙocŞ
::
OK
);

47  
r
;

48 
	}
}

	@lock_client.h

3 #iâdeà
lock_ş›Á_h


4 
	#lock_ş›Á_h


	)

6 
	~<¡ršg
>

7 
	~"lock_´ÙocŞ.h
"

8 
	~"½c.h
"

9 
	~<veùÜ
>

12 şas 
	clock_ş›Á
 {

13 
	m´Ùeùed
:

14 
½cc
 *
ş
;

15 
	mpublic
:

16 
lock_ş›Á
(
¡d
::
¡ršg
 
d
);

17 
	mvœtu®
 ~
	$lock_ş›Á
() {};

18 
vœtu®
 
lock_´ÙocŞ
::
¡©us
 
	`acquœe
Öock_´ÙocŞ::
lockid_t
);

19 
vœtu®
 
lock_´ÙocŞ
::
¡©us
 
	`»Ëa£
Öock_´ÙocŞ::
lockid_t
);

20 
vœtu®
 
lock_´ÙocŞ
::
¡©us
 
	`¡©
Öock_´ÙocŞ::
lockid_t
);

21 
	}
};

	@lock_demo.cc

5 
	~"lock_´ÙocŞ.h
"

6 
	~"lock_ş›Á.h
"

7 
	~"½c.h
"

8 
	~<¬·/š‘.h
>

9 
	~<veùÜ
>

10 
	~<¡dlib.h
>

11 
	~<¡dio.h
>

13 
	g¡d
::
¡ršg
 
d¡
;

14 
lock_ş›Á
 *
	glc
;

17 
	$maš
(
¬gc
, *
¬gv
[])

19 
r
;

21 if(
¬gc
 != 2){

22 
	`årštf
(
¡d”r
, "U§ge: % [ho¡:]pÜt\n", 
¬gv
[0]);

23 
	`ex™
(1);

26 
d¡
 = 
¬gv
[1];

27 
lc
 = 
Ãw
 
	`lock_ş›Á
(
d¡
);

28 
r
 = 
lc
->
	`¡©
(1);

29 
	`´štf
 ("¡©„‘uºed %d\n", 
r
);

30 
	}
}

	@lock_protocol.h

3 #iâdeà
lock_´ÙocŞ_h


4 
	#lock_´ÙocŞ_h


	)

6 
	~"½c.h
"

8 şas 
	clock_´ÙocŞ
 {

9 
	mpublic
:

10 
	exx¡©us
 { 
OK
, 
	mRETRY
, 
	mRPCERR
, 
	mNOENT
, 
	mIOERR
 };

11 
	t¡©us
;

12 
	tlockid_t
;

13 
	txid_t
;

14 
	e½c_numb”s
 {

15 
	gacquœe
 = 0x7001,

16 
	g»Ëa£
,

17 
	g¡©


21 şas 
	c¾ock_´ÙocŞ
 {

22 
	mpublic
:

23 
	exx¡©us
 { 
OK
, 
	mRPCERR
 };

24 
	t¡©us
;

25 
	e½c_numb”s
 {

26 
	g»voke
 = 0x8001,

27 
	g»Œy
 = 0x8002

	@lock_server.cc

3 
	~"lock_£rv”.h
"

4 
	~<s¡»am
>

5 
	~<¡dio.h
>

6 
	~<uni¡d.h
>

7 
	~<¬·/š‘.h
>

9 
	~<±h»ad.h
>

10 
	~<m­
>

12 
	glock_£rv”
::
	$lock_£rv”
():

13 
	$Çcquœe
 (0)

15 
	`±h»ad_mu‹x_š™
(&
mu‹x
, 
NULL
);

16 
	}
}

18 
	glock_´ÙocŞ
::
¡©us


19 
lock_£rv”
::
	$¡©
(
şt
, 
lock_´ÙocŞ
::
lockid_t
 
lid
, &
r
)

21 
lock_´ÙocŞ
::
¡©us
 
»t
 =†ock_´ÙocŞ::
OK
;

22 
	`´štf
("¡©„eque¡ from cÉ %d\n", 
şt
);

23 
r
 = 
Çcquœe
;

24  
»t
;

25 
	}
}

27 
	glock_´ÙocŞ
::
¡©us


28 
lock_£rv”
::
	$acquœe
(
şt
, 
lock_´ÙocŞ
::
lockid_t
 
lid
, &
r
)

30 
lock_´ÙocŞ
::
¡©us
 
»t
 =†ock_´ÙocŞ::
OK
;

32 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

33 if(
lock_m­
.
	`fšd
(
lid
è!ğlock_m­.
	`’d
()){

34 
lock_m­
[
lid
].
g¿Áed
 =ğ
Œue
){

35 
	`±h»ad_cÚd_wa™
(&
lock_m­
[
lid
].
cÚd
, &
mu‹x
);

43 
lock_m­
[
lid
].
g¿Áed
 = 
Œue
;

45 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

46  
»t
;

47 
	}
}

49 
	glock_´ÙocŞ
::
¡©us


50 
lock_£rv”
::
	$»Ëa£
(
şt
, 
lock_´ÙocŞ
::
lockid_t
 
lid
, &
r
)

52 
lock_´ÙocŞ
::
¡©us
 
»t
 =†ock_´ÙocŞ::
OK
;

56 
	`±h»ad_mu‹x_lock
(&
mu‹x
);

57 
lock_m­
[
lid
].
g¿Áed
 = 
çl£
;

58 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
);

59 
	`±h»ad_cÚd_sigÇl
(&
lock_m­
[
lid
].
cÚd
);

60  
»t
;

61 
	}
}

	@lock_server.h

4 #iâdeà
lock_£rv”_h


5 
	#lock_£rv”_h


	)

7 
	~<¡ršg
>

8 
	~"lock_´ÙocŞ.h
"

9 
	~"lock_ş›Á.h
"

10 
	~"½c.h
"

12 
	~<±h»ad.h
>

13 
	~<m­
>

15 şas 
	clock_£rv”
 {

16 
	m´iv©e
:

17 
	sLock
{

18 
boŞ
 
g¿Áed
;

19 
±h»ad_cÚd_t
 
	mcÚd
;

20 
Lock
(){

21 
	mg¿Áed
 = 
Œue
;

22 
±h»ad_cÚd_š™
(&
cÚd
, 
NULL
);

26 
±h»ad_mu‹x_t
 
	gmu‹x
;

27 
	g¡d
::
m­
<
lock_´ÙocŞ
::
lockid_t
, 
	gLock
> 
	glock_m­
;

29 
	g´Ùeùed
:

30 
Çcquœe
;

32 
	gpublic
:

33 
lock_£rv”
();

34 ~
	$lock_£rv”
(è{
	}
};

35 
	glock_´ÙocŞ
::
¡©us
 
¡©
(
şt
, 
lock_´ÙocŞ
::
lockid_t
 
lid
, &);

36 
	glock_´ÙocŞ
::
¡©us
 
acquœe
(
şt
, 
lock_´ÙocŞ
::
lockid_t
 
lid
, &);

37 
	glock_´ÙocŞ
::
¡©us
 
»Ëa£
(
şt
, 
lock_´ÙocŞ
::
lockid_t
 
lid
, &);

	@lock_smain.cc

1 
	~"½c.h
"

2 
	~<¬·/š‘.h
>

3 
	~<¡dlib.h
>

4 
	~<uni¡d.h
>

5 
	~<¡dio.h
>

6 
	~"·xos.h
"

7 
	~"rsm.h
"

9 
	~"j¦_log.h
"

14 
	$maš
(
¬gc
, *
¬gv
[])

16 
couÁ
 = 0;

18 
	`£tvbuf
(
¡dout
, 
NULL
, 
_IONBF
, 0);

19 
	`£tvbuf
(
¡d”r
, 
NULL
, 
_IONBF
, 0);

21 
	`¤ªdom
(
	`g‘pid
());

23 if(
¬gc
 != 3){

24 
	`årštf
(
¡d”r
, "U§ge: % [ma¡”:]pÜˆ[me:]pÜt\n", 
¬gv
[0]);

25 
	`ex™
(1);

28 *
couÁ_’v
 = 
	`g‘’v
("RPC_COUNT");

29 if(
couÁ_’v
 !ğ
NULL
){

30 
couÁ
 = 
	`©oi
(
couÁ_’v
);

38 
	#RSM


	)

39 #ifdeà
RSM


40 
rsm
 
	`rsm
(
¬gv
[1],‡rgv[2]);

43 
	`¦“p
(1000);

44 
	}
}

	@lock_tester.cc

5 
	~"lock_´ÙocŞ.h
"

6 
	~"lock_ş›Á.h
"

7 
	~"½c.h
"

8 
	~"j¦_log.h
"

9 
	~<¬·/š‘.h
>

10 
	~<veùÜ
>

11 
	~<¡dlib.h
>

12 
	~<¡dio.h
>

13 
	~"Ïng/v”ify.h
"

14 <<<<<<< 
	gHEAD


15 
	~"lock_ş›Á_ÿche.h
"

18 
	gÁ
 = 6;

19 
	g¡d
::
¡ršg
 
d¡
;

20 
lock_ş›Á_ÿche
 **
	glc
 = 
Ãw
†ock_ş›Á_ÿch* [
Á
];

22 
	~<uni¡d.h
>

24 
Á
 = 6;

25 
	g¡d
::
¡ršg
 
d¡
;

26 
lock_ş›Á
 **
	glc
 = 
Ãw
†ock_ş›Á * [
Á
];

27 >>>>>>> 
Ïb5


28 
	glock_´ÙocŞ
::
lockid_t
 
a
 = 1;

29 
	glock_´ÙocŞ
::
lockid_t
 
b
 = 2;

30 
	glock_´ÙocŞ
::
lockid_t
 
c
 = 3;

35 
	gù
[256];

36 
±h»ad_mu‹x_t
 
	gcouÁ_mu‹x
;

39 
	$check_g¿Á
(
lock_´ÙocŞ
::
lockid_t
 
lid
)

41 
ScİedLock
 
	`ml
(&
couÁ_mu‹x
);

42 
x
 = 
lid
 & 0xff;

43 if(
ù
[
x
] != 0){

44 
	`årštf
(
¡d”r
, "”rÜ: s”v” g¿Áed %016Îxwiû\n", 
lid
);

45 
	`årštf
(
¡dout
, "”rÜ: s”v” g¿Áed %016Îxwiû\n", 
lid
);

46 
	`ex™
(1);

48 
ù
[
x
] += 1;

49 
	}
}

52 
	$check_»Ëa£
(
lock_´ÙocŞ
::
lockid_t
 
lid
)

54 
ScİedLock
 
	`ml
(&
couÁ_mu‹x
);

55 
x
 = 
lid
 & 0xff;

56 if(
ù
[
x
] != 1){

57 
	`årštf
(
¡d”r
, "”rÜ: cl›Á„–—£d un-h–d†ock %016Îx\n", 
lid
);

58 
	`ex™
(1);

60 
ù
[
x
] -= 1;

61 
	}
}

64 
	$‹¡1
()

66 
	`´štf
 ("acquire‡„elease‡‡cquire‡„elease‡\n");

67 
lc
[0]->
	`acquœe
(
a
);

68 
	`check_g¿Á
(
a
);

69 
lc
[0]->
	`»Ëa£
(
a
);

70 
	`check_»Ëa£
(
a
);

71 
lc
[0]->
	`acquœe
(
a
);

72 
	`check_g¿Á
(
a
);

73 
lc
[0]->
	`»Ëa£
(
a
);

74 
	`check_»Ëa£
(
a
);

76 
	`´štf
 ("acquire‡‡cquire b„elease b„elease‡\n");

77 
lc
[0]->
	`acquœe
(
a
);

78 
	`check_g¿Á
(
a
);

79 
lc
[0]->
	`acquœe
(
b
);

80 
	`check_g¿Á
(
b
);

81 
lc
[0]->
	`»Ëa£
(
b
);

82 
	`check_»Ëa£
(
b
);

83 
lc
[0]->
	`»Ëa£
(
a
);

84 
	`check_»Ëa£
(
a
);

85 
	}
}

88 
	$‹¡2
(*
x
)

90 
i
 = * (*è
x
;

92 
	`´štf
 ("‹¡2: cl›Á %d‡cquœ¨»Ëa£‡\n", 
i
);

93 
lc
[
i
]->
	`acquœe
(
a
);

94 
	`´štf
 ("‹¡2: cl›Á %d‡cquœdÚe\n", 
i
);

95 
	`check_g¿Á
(
a
);

96 
	`¦“p
(1);

97 
	`´štf
 ("‹¡2: cl›Á %d„–—£\n", 
i
);

98 
	`check_»Ëa£
(
a
);

99 
lc
[
i
]->
	`»Ëa£
(
a
);

100 
	`´štf
 ("‹¡2: cl›Á %d„–—£ dÚe\n", 
i
);

102 
	}
}

105 
	$‹¡3
(*
x
)

107 
i
 = * (*è
x
;

109 
	`´štf
 ("‹¡3: cl›Á %d‡cquœ¨»Ëa£‡ cÚcu¼’t\n", 
i
);

110 
j
 = 0; j < 10; j++) {

111 
lc
[
i
]->
	`acquœe
(
a
);

112 
	`check_g¿Á
(
a
);

113 
	`´štf
 ("‹¡3: cl›Á %d gÙ†ock\n", 
i
);

114 
	`check_»Ëa£
(
a
);

115 
lc
[
i
]->
	`»Ëa£
(
a
);

118 
	}
}

121 
	$‹¡4
(*
x
)

123 
i
 = * (*è
x
;

125 
	`´štf
 ("‹¡4:h»ad %d‡cquœ¨»Ëa£‡ cÚcu¼’t; samşÁ\n", 
i
);

126 
j
 = 0; j < 10; j++) {

127 
lc
[0]->
	`acquœe
(
a
);

128 
	`check_g¿Á
(
a
);

129 
	`´štf
 ("‹¡4:h»ad %d oÀş›Á 0 gÙ†ock\n", 
i
);

130 
	`check_»Ëa£
(
a
);

131 
lc
[0]->
	`»Ëa£
(
a
);

134 
	}
}

137 
	$‹¡5
(*
x
)

139 
i
 = * (*è
x
;

141 
	`´štf
 ("‹¡5: cl›Á %d‡cquœ¨»Ëa£‡ cÚcu¼’t; samªd difàşÁ\n", 
i
);

142 
j
 = 0; j < 10; j++) {

143 ià(
i
 < 5è
lc
[0]->
	`acquœe
(
a
);

144 
lc
[1]->
	`acquœe
(
a
);

145 
	`check_g¿Á
(
a
);

146 
	`´štf
 ("‹¡5: cl›Á %d gÙ†ock\n", 
i
);

147 
	`check_»Ëa£
(
a
);

148 ià(
i
 < 5è
lc
[0]->
	`»Ëa£
(
a
);

149 
lc
[1]->
	`»Ëa£
(
a
);

152 
	}
}

155 
	$maš
(
¬gc
, *
¬gv
[])

157 
r
;

158 
±h»ad_t
 
th
[
Á
];

159 
‹¡
 = 0;

161 
	`£tvbuf
(
¡dout
, 
NULL
, 
_IONBF
, 0);

162 
	`£tvbuf
(
¡d”r
, 
NULL
, 
_IONBF
, 0);

163 
	`¤ªdom
(
	`g‘pid
());

167 if(
¬gc
 < 2) {

168 
	`årštf
(
¡d”r
, "U§ge: % [ho¡:]pÜˆ[‹¡]\n", 
¬gv
[0]);

169 
	`ex™
(1);

172 
d¡
 = 
¬gv
[1];

174 ià(
¬gc
 > 2) {

175 
‹¡
 = 
	`©oi
(
¬gv
[2]);

176 if(
‹¡
 < 1 ||est > 5){

177 
	`´štf
("Test‚umber must be between 1‡nd 5\n");

178 
	`ex™
(1);

182 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
couÁ_mu‹x
, 
NULL
) == 0);

183 <<<<<<< 
HEAD


184 
	`´štf
("cache†ock client\n");

185 
i
 = 0; i < 
Á
; i++è
lc
[i] = 
Ãw
 
	`lock_ş›Á_ÿche
(
d¡
);

187 
	`´štf
("simple†ock client\n");

188 
i
 = 0; i < 
Á
; i++è
lc
[i] = 
Ãw
 
	`lock_ş›Á
(
d¡
);

189 >>>>>>> 
Ïb5


191 if(!
‹¡
 ||est == 1){

192 
	`‹¡1
();

195 if(!
‹¡
 ||est == 2){

197 
i
 = 0; i < 
Á
; i++) {

198 *
a
 = 
Ãw
 (
i
);

199 
r
 = 
	`±h»ad_ü—‹
(&
th
[
i
], 
NULL
, 
‹¡2
, (*è
a
);

200 
	`VERIFY
 (
r
 == 0);

202 
i
 = 0; i < 
Á
; i++) {

203 
	`±h»ad_još
(
th
[
i
], 
NULL
);

207 if(!
‹¡
 ||est == 3){

208 
	`´štf
("test 3\n");

211 
i
 = 0; i < 
Á
; i++) {

212 *
a
 = 
Ãw
 (
i
);

213 
r
 = 
	`±h»ad_ü—‹
(&
th
[
i
], 
NULL
, 
‹¡3
, (*è
a
);

214 
	`VERIFY
 (
r
 == 0);

216 
i
 = 0; i < 
Á
; i++) {

217 
	`±h»ad_još
(
th
[
i
], 
NULL
);

221 if(!
‹¡
 ||est == 4){

222 
	`´štf
("test 4\n");

225 
i
 = 0; i < 2; i++) {

226 *
a
 = 
Ãw
 (
i
);

227 
r
 = 
	`±h»ad_ü—‹
(&
th
[
i
], 
NULL
, 
‹¡4
, (*è
a
);

228 
	`VERIFY
 (
r
 == 0);

230 
i
 = 0; i < 2; i++) {

231 
	`±h»ad_još
(
th
[
i
], 
NULL
);

235 if(!
‹¡
 ||est == 5){

236 
	`´štf
("test 5\n");

240 
i
 = 0; i < 
Á
; i++) {

241 *
a
 = 
Ãw
 (
i
);

242 
r
 = 
	`±h»ad_ü—‹
(&
th
[
i
], 
NULL
, 
‹¡5
, (*è
a
);

243 
	`VERIFY
 (
r
 == 0);

245 
i
 = 0; i < 
Á
; i++) {

246 
	`±h»ad_još
(
th
[
i
], 
NULL
);

250 
	`´štf
 ("%s:…as£d‡Îe¡ sucûssfuÎy\n", 
¬gv
[0]);

252 
	}
}

	@log.cc

1 
	~"·xos.h
"

2 
	~<f¡»am
>

3 
	~<io¡»am
>

10 
	glog
::
	$log
(
acû±Ü
 *
_acc
, 
¡d
::
¡ršg
 
_me
)

11 : 
	$pxs
 (
_acc
)

13 
Çme
 = "·xos-" + 
_me
 + ".log";

14 
	`log»ad
();

15 
	}
}

18 
	glog
::
	$log»ad
()

20 
¡d
::
if¡»am
 
äom
;

21 
¡d
::
¡ršg
 
ty³
;

22 
š¡ªû
;

24 
äom
.
	`İ’
(
Çme
.
	`c_¡r
());

25 
	`´štf
 ("logread\n");

26 
äom
 >> 
ty³
) {

27 ià(
ty³
 == "done") {

28 
¡d
::
¡ršg
 
v
;

29 
äom
 >> 
š¡ªû
;

30 
äom
.
	`g‘
();

31 
	`g‘lše
(
äom
, 
v
);

32 
pxs
->
v®ues
[
š¡ªû
] = 
v
;

33 
pxs
->
š¡ªû_h
 = 
š¡ªû
;

34 
	`´štf
 ("log»ad: in¡ªû: %d w. v = %s\n", 
š¡ªû
,

35 
pxs
->
v®ues
[
š¡ªû
].
	`c_¡r
());

36 
pxs
->
v_a
.
	`ş—r
();

37 
pxs
->
n_h
.
n
 = 0;

38 
pxs
->
n_a
.
n
 = 0;

39 } ià(
ty³
 == "propseen") {

40 
äom
 >> 
pxs
->
n_h
.
n
;

41 
äom
 >> 
pxs
->
n_h
.
m
;

42 
	`´štf
("log»ad: high upd©e: %d(%s)\n", 
pxs
->
n_h
.
n
,…xs->n_h.
m
.
	`c_¡r
());

43 } ià(
ty³
 == "accepted") {

44 
¡d
::
¡ršg
 
v
;

45 
äom
 >> 
pxs
->
n_a
.
n
;

46 
äom
 >> 
pxs
->
n_a
.
m
;

47 
äom
.
	`g‘
();

48 
	`g‘lše
(
äom
, 
v
);

49 
pxs
->
v_a
 = 
v
;

50 
	`´štf
("log»ad:…rİ upd©%d(%sèw™h v = %s\n", 
pxs
->
n_a
.
n
,

51 
pxs
->
n_a
.
m
.
	`c_¡r
(),…xs->
v_a
.c_str());

53 
	`´štf
("logread: unknown†og„ecord\n");

54 
	`VERIFY
(0);

57 
äom
.
	`şo£
();

58 
	}
}

60 
	g¡d
::
¡ršg


61 
log
::
	$dump
()

63 
¡d
::
if¡»am
 
äom
;

64 
¡d
::
¡ršg
 
»s
;

65 
¡d
::
¡ršg
 
v
;

66 
äom
.
	`İ’
(
Çme
.
	`c_¡r
());

67 
	`g‘lše
(
äom
, 
v
)) {

68 
»s
 =„e + 
v
 + "\n";

70 
äom
.
	`şo£
();

71  
»s
;

72 
	}
}

75 
	glog
::
	$»¡Üe
(
¡d
::
¡ršg
 
s
)

77 
¡d
::
of¡»am
 
f
;

78 
	`´štf
("»¡Üe: %s\n", 
s
.
	`c_¡r
());

79 
f
.
	`İ’
(
Çme
.
	`c_¡r
(), 
¡d
::
ios
::
Œunc
);

80 
f
 << 
s
;

81 
f
.
	`şo£
();

82 
	}
}

86 
	glog
::
	$logš¡ªû
(
š¡ªû
, 
¡d
::
¡ršg
 
v
)

88 
¡d
::
of¡»am
 
f
;

89 
f
.
	`İ’
(
Çme
.
	`c_¡r
(), 
¡d
::
ios
::
­p
);

90 
f
 << "done";

91 
f
 << " ";

92 
f
 << 
š¡ªû
;

93 
f
 << " ";

94 
f
 << 
v
;

95 
f
 << "\n";

96 
f
.
	`şo£
();

97 
	}
}

102 
	glog
::
	$log´İ
(
´İ_t
 
n_h
)

104 
¡d
::
of¡»am
 
f
;

105 
f
.
	`İ’
(
Çme
.
	`c_¡r
(), 
¡d
::
ios
::
­p
);

106 
f
 << "propseen";

107 
f
 << " ";

108 
f
 << 
n_h
.
n
;

109 
f
 << " ";

110 
f
 << 
n_h
.
m
;

111 
f
 << "\n";

112 
f
.
	`şo£
();

113 
	}
}

118 
	glog
::
	$logacû±
(
´İ_t
 
n
, 
¡d
::
¡ršg
 
v
)

120 
¡d
::
of¡»am
 
f
;

121 
f
.
	`İ’
(
Çme
.
	`c_¡r
(), 
¡d
::
ios
::
­p
);

122 
f
 << "accepted";

123 
f
 << " ";

124 
f
 << 
n
.n;

125 
f
 << " ";

126 
f
 << 
n
.
m
;

127 
f
 << " ";

128 
f
 << 
v
;

129 
f
 << "\n";

130 
f
.
	`şo£
();

131 
	}
}

	@log.h

1 #iâdeà
log_h


2 
	#log_h


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

8 
şass
 
	gacû±Ü
;

10 şas 
	clog
 {

11 
	m´iv©e
:

12 
¡d
::
¡ršg
 
Çme
;

13 
acû±Ü
 *
	mpxs
;

14 
	mpublic
:

15 
log
 (
acû±Ü
*, 
¡d
::
¡ršg
 
_me
);

16 
	m¡d
::
¡ršg
 
dump
();

17 
»¡Üe
(
¡d
::
¡ršg
 
s
);

18 
log»ad
();

20 
logš¡ªû
(
š¡ªû
, 
¡d
::
¡ršg
 
v
);

22 
log´İ
(
´İ_t
 
n_h
);

25 
logacû±
(
´İ_t
 
n_a
, 
¡d
::
¡ršg
 
v
);

	@paxos.cc

1 
	~"·xos.h
"

2 
	~"hªdË.h
"

4 
	~<¡dio.h
>

5 
	~"rštf.h
"

6 
	~"Ïng/v”ify.h
"

18 
boŞ


19 
	gİ”©Ü
> (cÚ¡ 
	g´İ_t
 &
	ga
, cÚ¡…rİ_ˆ&
	gb
)

21  (
	ga
.
	gn
 > 
	gb
.À|| (a.À=ğ
b
.
n
 && 
a
.
m
 > b.m));

24 
boŞ


25 
	gİ”©Ü
>ğ(cÚ¡ 
´İ_t
 &
a
, cÚ¡ 
	g´İ_t
 &
	gb
)

27  (
	ga
.
	gn
 > 
	gb
.À|| (a.À=ğ
b
.
n
 && 
a
.
m
 >= b.m));

30 
	g¡d
::
¡ršg


31 
´št_memb”s
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
nodes
)

33 
¡d
::
¡ršg
 
s
;

34 
	gs
.
ş—r
();

35 
	gi
 = 0; i < 
	gnodes
.
size
(); i++) {

36 
	gs
 +ğ
nodes
[
i
];

37 ià(
	gi
 < (
	gnodes
.
size
()-1))

38 
	gs
 += ",";

40  
	gs
;

43 
boŞ
 
i§memb”
(
¡d
::
¡ršg
 
m
, cÚ¡ std::
veùÜ
<¡d::¡ršg> &
nodes
)

45 
i
 = 0; 
	gi
 < 
	gnodes
.
size
(); i++) {

46 ià(
	gnodes
[
i
] =ğ
m
)  1;

51 
boŞ


52 
	g´İo£r
::
	$i¤uÂšg
()

54 
boŞ
 
r
;

55 
ScİedLock
 
	`ml
(&
pxs_mu‹x
);

56 
r
 = !
¡abË
;

57  
r
;

58 
	}
}

61 
boŞ


62 
	g´İo£r
::
majÜ™y
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
l1
,

63 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
l2
)

65 
n
 = 0;

67 
	gi
 = 0; i < 
	gl1
.
size
(); i++) {

68 ià(
i§memb”
(
l1
[
i
], 
l2
))

69 
	gn
++;

71  
	gn
 >ğ(
l1
.
size
() >> 1) + 1;

74 
	g´İo£r
::
	$´İo£r
(
şass
 
·xos_chªge
 *
_cfg
, cÏs 
acû±Ü
 *
_acû±Ü
,

75 
¡d
::
¡ršg
 
_me
)

76 : 
	`cfg
(
_cfg
), 
	`acc
 (
_acû±Ü
), 
	`me
 (
_me
), 
	`b»ak1
 (
çl£
), 
	`b»ak2
 (false),

77 
	$¡abË
 (
Œue
)

79 
	`VERIFY
 (
	`±h»ad_mu‹x_š™
(&
pxs_mu‹x
, 
NULL
) == 0);

80 
my_n
.
n
 = 0;

81 
my_n
.
m
 = 
me
;

82 
	}
}

85 
	g´İo£r
::
	$£Š
()

87 
my_n
.
n
 = 
acc
->
	`g‘_n_h
().n + 1 > my_n.n + 1 ?‡cc->get_n_h().n + 1 : my_n.n + 1;

88 
	}
}

90 
boŞ


91 
	g´İo£r
::
run
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> 
cur_nodes
, std::¡ršg 
Ãwv
)

93 
¡d
::
veùÜ
<¡d::
¡ršg
> 
acû±s
;

94 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
nodes
;

95 
	g¡d
::
¡ršg
 
v
;

96 
boŞ
 
	gr
 = 
çl£
;

98 
ScİedLock
 
ml
(&
pxs_mu‹x
);

99 
rštf
("start: initiate…axos for %s w. i=%d v=%s stable=%d\n",

100 
´št_memb”s
(
cur_nodes
).
c_¡r
(), 
š¡ªû
, 
Ãwv
.c_¡r(), 
¡abË
);

101 ià(!
	g¡abË
) {

102 
rštf
("proposer::run:‡lready„unning\n");

103  
	gçl£
;

105 
	g¡abË
 = 
çl£
;

106 
£Š
();

107 
	gacû±s
.
ş—r
();

108 
	gv
.
ş—r
();

109 ià(
´•¬e
(
š¡ªû
, 
acû±s
, 
cur_nodes
, 
v
)) {

111 ià(
majÜ™y
(
cur_nodes
, 
acû±s
)) {

112 
rštf
("paxos::manager:„eceived‡ majority of…repare„esponses\n");

114 ià(
	gv
.
size
() == 0)

115 
v
 = 
Ãwv
;

117 
b»akpošt1
();

119 
	gnodes
 = 
acû±s
;

120 
	gacû±s
.
ş—r
();

121 
acû±
(
š¡ªû
, 
acû±s
, 
nodes
, 
v
);

123 ià(
majÜ™y
(
cur_nodes
, 
acû±s
)) {

124 
rštf
("paxos::manager:„eceived‡ majority of‡ccept„esponses\n");

126 
b»akpošt2
();

128 
decide
(
š¡ªû
, 
acû±s
, 
v
);

129 
	gr
 = 
Œue
;

131 
rštf
("paxos::manager:‚o majority of‡ccept„esponses\n");

134 
rštf
("paxos::manager:‚o majority of…repare„esponses\n");

137 
rštf
("·xos::mªag”:…»·» i »jeùed %d\n", 
¡abË
);

139 
	g¡abË
 = 
Œue
;

140  
	gr
;

148 
boŞ


149 
	g´İo£r
::
´•¬e
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> &
acû±s
,

150 
¡d
::
veùÜ
<¡d::
¡ršg
> 
nodes
,

151 
¡d
::
¡ršg
 &
v
)

156  
çl£
;

162 
	g´İo£r
::
acû±
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> &
acû±s
,

163 
¡d
::
veùÜ
<¡d::
¡ršg
> 
nodes
, std::¡ršg 
v
)

169 
´İo£r
::
decide
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> 
acû±s
,

170 
¡d
::
¡ršg
 
v
)

175 
acû±Ü
::
	$acû±Ü
(
şass
 
·xos_chªge
 *
_cfg
, 
boŞ
 
_fœ¡
, 
¡d
::
¡ršg
 
_me
,

176 
¡d
::
¡ršg
 
_v®ue
)

177 : 
	`cfg
(
_cfg
), 
	`me
 (
_me
), 
	$š¡ªû_h
(0)

179 
	`VERIFY
 (
	`±h»ad_mu‹x_š™
(&
pxs_mu‹x
, 
NULL
) == 0);

181 
n_h
.
n
 = 0;

182 
n_h
.
m
 = 
me
;

183 
n_a
.
n
 = 0;

184 
n_a
.
m
 = 
me
;

185 
v_a
.
	`ş—r
();

187 
l
 = 
Ãw
 
	`log
 (
this
, 
me
);

189 ià(
š¡ªû_h
 =ğ0 && 
_fœ¡
) {

190 
v®ues
[1] = 
_v®ue
;

191 
l
->
	`logš¡ªû
(1, 
_v®ue
);

192 
š¡ªû_h
 = 1;

195 
pxs
 = 
Ãw
 
	`½cs
(
	`©oi
(
_me
.
	`c_¡r
()));

196 
pxs
->
	`»g
(
·xos_´ÙocŞ
::
´•¬”eq
, 
this
, &
acû±Ü
::preparereq);

197 
pxs
->
	`»g
(
·xos_´ÙocŞ
::
acû±»q
, 
this
, &
acû±Ü
::acceptreq);

198 
pxs
->
	`»g
(
·xos_´ÙocŞ
::
decid”eq
, 
this
, &
acû±Ü
::decidereq);

199 
	}
}

201 
	g·xos_´ÙocŞ
::
¡©us


202 
acû±Ü
::
	$´•¬”eq
(
¡d
::
¡ršg
 
¤c
, 
·xos_´ÙocŞ
::
´•¬—rg
 
a
,

203 
·xos_´ÙocŞ
::
´•¬”es
 &
r
)

208  
·xos_´ÙocŞ
::
OK
;

210 
	}
}

213 
	g·xos_´ÙocŞ
::
¡©us


214 
acû±Ü
::
	$acû±»q
(
¡d
::
¡ršg
 
¤c
, 
·xos_´ÙocŞ
::
acû±¬g
 
a
, 
boŞ
 &
r
)

219  
·xos_´ÙocŞ
::
OK
;

220 
	}
}

223 
	g·xos_´ÙocŞ
::
¡©us


224 
acû±Ü
::
	$decid”eq
(
¡d
::
¡ršg
 
¤c
, 
·xos_´ÙocŞ
::
decid—rg
 
a
, &
r
)

226 
ScİedLock
 
	`ml
(&
pxs_mu‹x
);

227 
	`rštf
("decidereq for‡ccepted instance %d (my instance %d) v=%s\n",

228 
a
.
š¡ªû
, 
š¡ªû_h
, 
v_a
.
	`c_¡r
());

229 ià(
a
.
š¡ªû
 =ğ
š¡ªû_h
 + 1) {

230 
	`VERIFY
(
v_a
 =ğ
a
.
v
);

231 
	`comm™_wo
(
a
.
š¡ªû
, 
v_a
);

232 } ià(
a
.
š¡ªû
 <ğ
š¡ªû_h
) {

236 
	`VERIFY
(0);

238  
·xos_´ÙocŞ
::
OK
;

239 
	}
}

242 
	gacû±Ü
::
	$comm™_wo
(
š¡ªû
, 
¡d
::
¡ršg
 
v®ue
)

245 
	`rštf
("acû±Ü::comm™: in¡ªû=%d ha vğ%s\n", 
š¡ªû
, 
v®ue
.
	`c_¡r
());

246 ià(
š¡ªû
 > 
š¡ªû_h
) {

247 
	`rštf
("comm™: highe¡acû±eš¡ªû = %d\n", 
š¡ªû
);

248 
v®ues
[
š¡ªû
] = 
v®ue
;

249 
l
->
	`logš¡ªû
(
š¡ªû
, 
v®ue
);

250 
š¡ªû_h
 = 
š¡ªû
;

251 
n_h
.
n
 = 0;

252 
n_h
.
m
 = 
me
;

253 
n_a
.
n
 = 0;

254 
n_a
.
m
 = 
me
;

255 
v_a
.
	`ş—r
();

256 ià(
cfg
) {

257 
	`±h»ad_mu‹x_uÆock
(&
pxs_mu‹x
);

258 
cfg
->
	`·xos_comm™
(
š¡ªû
, 
v®ue
);

259 
	`±h»ad_mu‹x_lock
(&
pxs_mu‹x
);

262 
	}
}

265 
	gacû±Ü
::
	$comm™
(
š¡ªû
, 
¡d
::
¡ršg
 
v®ue
)

267 
ScİedLock
 
	`ml
(&
pxs_mu‹x
);

268 
	`comm™_wo
(
š¡ªû
, 
v®ue
);

269 
	}
}

271 
	g¡d
::
¡ršg


272 
acû±Ü
::
	$dump
()

274  
l
->
	`dump
();

275 
	}
}

278 
	gacû±Ü
::
	$»¡Üe
(
¡d
::
¡ršg
 
s
)

280 
l
->
	`»¡Üe
(
s
);

281 
l
->
	`log»ad
();

282 
	}
}

290 
	g´İo£r
::
	$b»akpošt1
()

292 ià(
b»ak1
) {

293 
	`rštf
("Dying‡t breakpoint 1!\n");

294 
	`ex™
(1);

296 
	}
}

300 
	g´İo£r
::
	$b»akpošt2
()

302 ià(
b»ak2
) {

303 
	`rštf
("Dying‡t breakpoint 2!\n");

304 
	`ex™
(1);

306 
	}
}

309 
	g´İo£r
::
	$b»akpošt
(
b
)

311 ià(
b
 == 3) {

312 
	`rštf
("Proposer: breakpoint 1\n");

313 
b»ak1
 = 
Œue
;

314 } ià(
b
 == 4) {

315 
	`rštf
("Proposer: breakpoint 2\n");

316 
b»ak2
 = 
Œue
;

318 
	}
}

	@paxos.h

1 #iâdeà
·xos_h


2 
	#·xos_h


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~"½c.h
"

7 
	~"·xos_´ÙocŞ.h
"

8 
	~"log.h
"

11 şas 
	c·xos_chªge
 {

12 
	mpublic
:

13 
vœtu®
 
·xos_comm™
(
š¡ªû
, 
¡d
::
¡ršg
 
v
) = 0;

14 
	mvœtu®
 ~
	$·xos_chªge
() {};

15 
	}
};

17 şas 
	cacû±Ü
 {

18 
	m´iv©e
:

19 
log
 *
l
;

20 
½cs
 *
	mpxs
;

21 
·xos_chªge
 *
	mcfg
;

22 
	m¡d
::
¡ršg
 
me
;

23 
±h»ad_mu‹x_t
 
	mpxs_mu‹x
;

26 
´İ_t
 
	mn_h
;

27 
´İ_t
 
	mn_a
;

28 
	m¡d
::
¡ršg
 
v_a
;

29 
	mš¡ªû_h
;

30 
	m¡d
::
m­
<,¡d::
¡ršg
> 
v®ues
;

32 
comm™_wo
(
š¡ªû
, 
¡d
::
¡ršg
 
v
);

33 
	m·xos_´ÙocŞ
::
¡©us
 
´•¬”eq
(
¡d
::
¡ršg
 
¤c
,

34 
·xos_´ÙocŞ
::
´•¬—rg
 
a
,

35 
·xos_´ÙocŞ
::
´•¬”es
 &
r
);

36 
	m·xos_´ÙocŞ
::
¡©us
 
acû±»q
(
¡d
::
¡ršg
 
¤c
,

37 
·xos_´ÙocŞ
::
acû±¬g
 
a
, 
boŞ
 &
r
);

38 
	m·xos_´ÙocŞ
::
¡©us
 
decid”eq
(
¡d
::
¡ršg
 
¤c
,

39 
·xos_´ÙocŞ
::
decid—rg
 
a
, &
r
);

41 
ä›nd
 
şass
 
	mlog
;

43 
	mpublic
:

44 
acû±Ü
(
şass
 
·xos_chªge
 *
cfg
, 
boŞ
 
_fœ¡
, 
¡d
::
¡ršg
 
_me
,

45 
¡d
::
¡ršg
 
_v®ue
);

46 ~
	$acû±Ü
() {};

47 
	`comm™
(
š¡ªû
, 
¡d
::
¡ršg
 
v
);

48 
	$š¡ªû
(è{  
š¡ªû_h
; 
	}
}

49 
	g¡d
::
¡ršg
 
	$v®ue
(
š¡ªû
è{  
v®ues
[š¡ªû]; 
	}
}

50 
	g¡d
::
¡ršg
 
dump
();

51 
»¡Üe
(
¡d
::
¡ršg
);

52 
½cs
 *
	$g‘_½cs
(è{  
pxs
; 
	}
};

53 
´İ_t
 
	$g‘_n_h
(è{  
n_h
; 
	}
};

54 
	$g‘_š¡ªû_h
(è{  
š¡ªû_h
; 
	}
};

57 
boŞ
 
i§memb”
(
¡d
::
¡ršg
 
m
, cÚ¡ std::
veùÜ
<¡d::¡ršg> &
nodes
);

58 
¡d
::
¡ršg
 
´št_memb”s
(cÚ¡ std::
veùÜ
<¡d::¡ršg> &
nodes
);

60 şas 
	c´İo£r
 {

61 
	m´iv©e
:

62 
log
 *
l
;

63 
·xos_chªge
 *
	mcfg
;

64 
acû±Ü
 *
	macc
;

65 
	m¡d
::
¡ršg
 
me
;

66 
boŞ
 
	mb»ak1
;

67 
boŞ
 
	mb»ak2
;

69 
±h»ad_mu‹x_t
 
	mpxs_mu‹x
;

72 
boŞ
 
	m¡abË
;

73 
´İ_t
 
	mmy_n
;

75 
£Š
();

76 
boŞ
 
´•¬e
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> &
acû±s
,

77 
¡d
::
veùÜ
<¡d::
¡ršg
> 
nodes
,

78 
¡d
::
¡ršg
 &
v
);

79 
acû±
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> &
acû±s
,

80 
¡d
::
veùÜ
<¡d::
¡ršg
> 
nodes
, std::¡ršg 
v
);

81 
decide
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> 
acû±s
,

82 
¡d
::
¡ršg
 
v
);

84 
b»akpošt1
();

85 
b»akpošt2
();

86 
boŞ
 
majÜ™y
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
l1
, cÚ¡ std::veùÜ<¡d::¡ršg> &
l2
);

88 
ä›nd
 
şass
 
	mlog
;

89 
	mpublic
:

90 
´İo£r
(
şass
 
·xos_chªge
 *
cfg
, cÏs 
acû±Ü
 *
_acû±Ü
, 
¡d
::
¡ršg
 
_me
);

91 ~
	$´İo£r
() {};

92 
boŞ
 
	`run
(
š¡ªû
, 
¡d
::
veùÜ
<¡d::
¡ršg
> 
úodes
, std::¡ršg 
v
);

93 
boŞ
 
	`i¤uÂšg
();

94 
	`b»akpošt
(
b
);

95 
	}
};

	@paxos_protocol.h

1 #iâdeà
·xos_´ÙocŞ_h


2 
	#·xos_´ÙocŞ_h


	)

4 
	~"½c.h
"

6 
	s´İ_t
 {

7 
	mn
;

8 
	m¡d
::
¡ršg
 
m
;

11 şas 
	c·xos_´ÙocŞ
 {

12 
	mpublic
:

13 
	exx¡©us
 { 
OK
, 
	mERR
 };

14 
	t¡©us
;

15 
	e½c_numb”s
 {

16 
	g´•¬”eq
 = 0x11001,

17 
	gacû±»q
,

18 
	gdecid”eq
,

19 
	gh—¹b—t
,

22 
	s´•¬—rg
 {

23 
	gš¡ªû
;

24 
´İ_t
 
	gn
;

27 
	s´•¬”es
 {

28 
boŞ
 
	gŞdš¡ªû
;

29 
boŞ
 
	gacû±
;

30 
´İ_t
 
	gn_a
;

31 
	g¡d
::
¡ršg
 
v_a
;

34 
	sacû±¬g
 {

35 
	gš¡ªû
;

36 
´İ_t
 
	gn
;

37 
	g¡d
::
¡ršg
 
v
;

40 
	sdecid—rg
 {

41 
	gš¡ªû
;

42 
	g¡d
::
¡ršg
 
v
;

47 
šlše
 
	gunm¬sh®l
 &

48 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g´İ_t
 &
	ga
)

50 
	gu
 >> 
	ga
.
	gn
;

51 
	gu
 >> 
	ga
.
	gm
;

52  
	gu
;

55 
šlše
 
	gm¬sh®l
 &

56 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
´İ_t
 
	ga
)

58 
	gm
 << 
	ga
.
	gn
;

59 
	gm
 << 
	ga
.m;

60  
	gm
;

63 
šlše
 
	gunm¬sh®l
 &

64 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g·xos_´ÙocŞ
::
´•¬—rg
 &
a
)

66 
u
 >> 
a
.
š¡ªû
;

67 
	gu
 >> 
	ga
.
	gn
;

68  
	gu
;

71 
šlše
 
	gm¬sh®l
 &

72 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	g·xos_´ÙocŞ
::
´•¬—rg
 
a
)

74 
m
 << 
a
.
š¡ªû
;

75 
	gm
 << 
	ga
.
	gn
;

76  
	gm
;

79 
šlše
 
	gunm¬sh®l
 &

80 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g·xos_´ÙocŞ
::
´•¬”es
 &
r
)

82 
u
 >> 
r
.
Şdš¡ªû
;

83 
	gu
 >> 
	gr
.
	gacû±
;

84 
	gu
 >> 
	gr
.
	gn_a
;

85 
	gu
 >> 
	gr
.
	gv_a
;

86  
	gu
;

89 
šlše
 
	gm¬sh®l
 &

90 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	g·xos_´ÙocŞ
::
´•¬”es
 
r
)

92 
m
 << 
r
.
Şdš¡ªû
;

93 
	gm
 << 
	gr
.
	gacû±
;

94 
	gm
 << 
	gr
.
	gn_a
;

95 
	gm
 << 
	gr
.
	gv_a
;

96  
	gm
;

99 
šlše
 
	gunm¬sh®l
 &

100 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g·xos_´ÙocŞ
::
acû±¬g
 &
a
)

102 
u
 >> 
a
.
š¡ªû
;

103 
	gu
 >> 
	ga
.
	gn
;

104 
	gu
 >> 
	ga
.
	gv
;

105  
	gu
;

108 
šlše
 
	gm¬sh®l
 &

109 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	g·xos_´ÙocŞ
::
acû±¬g
 
a
)

111 
m
 << 
a
.
š¡ªû
;

112 
	gm
 << 
	ga
.
	gn
;

113 
	gm
 << 
	ga
.
	gv
;

114  
	gm
;

117 
šlše
 
	gunm¬sh®l
 &

118 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g·xos_´ÙocŞ
::
decid—rg
 &
a
)

120 
u
 >> 
a
.
š¡ªû
;

121 
	gu
 >> 
	ga
.
	gv
;

122  
	gu
;

125 
šlše
 
	gm¬sh®l
 &

126 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	g·xos_´ÙocŞ
::
decid—rg
 
a
)

128 
m
 << 
a
.
š¡ªû
;

129 
	gm
 << 
	ga
.
	gv
;

130  
	gm
;

	@rpc/connection.h

1 #iâdeà
cÚÃùiÚ_h


2 
	#cÚÃùiÚ_h
 1

	)

4 
	~<sys/ty³s.h
>

5 
	~<sys/sock‘.h
>

6 
	~<¬·/š‘.h
>

7 
	~<Ãtš‘/š.h
>

8 
	~<c¡ddef
>

10 
	~<m­
>

12 
	~"pŞlmgr.h
"

14 
şass
 
	gcÚÃùiÚ
;

16 şas 
	cchªmgr
 {

17 
	mpublic
:

18 
vœtu®
 
boŞ
 
gÙ_pdu
(
cÚÃùiÚ
 *
c
, *
b
, 
sz
) = 0;

19 
	mvœtu®
 ~
	$chªmgr
() {}

20 
	}
};

22 şas 
	ccÚÃùiÚ
 : 
public
 
aio_ÿÎback
 {

23 
public
:

24 
	sch¬buf
 {

25 
ch¬buf
(): 
buf
(
NULL
), 
sz
(0), 
sŞÚg
(0) {}

26 
ch¬buf
 (*
b
, 
s
è: 
buf
(b), 
sz
(s), 
sŞÚg
(0){}

27 *
	mbuf
;

28 
	msz
;

29 
	msŞÚg
;

32 
cÚÃùiÚ
(
chªmgr
 *
m1
, 
f1
, 
lossy‹¡
=0);

33 ~
cÚÃùiÚ
();

35 
	$chªno
(è{  
fd_
; 
	}
}

36 
boŞ
 
isd—d
();

37 
şo£cÚn
();

39 
boŞ
 
£nd
(*
b
, 
sz
);

40 
wr™e_cb
(
s
);

41 
»ad_cb
(
s
);

43 
šüef
();

44 
deüef
();

45 
»f
();

47 
com·»
(
cÚÃùiÚ
 *
ªÙh”
);

48 
	g´iv©e
:

50 
boŞ
 
»adpdu
();

51 
boŞ
 
wr™•du
();

53 
chªmgr
 *
	gmgr_
;

54 cÚ¡ 
	gfd_
;

55 
boŞ
 
	gd—d_
;

57 
ch¬buf
 
	gwpdu_
;

58 
ch¬buf
 
	g½du_
;

60 
timev®
 
	gü—‹_time_
;

62 
	gwa™”s_
;

63 
	g»âo_
;

64 cÚ¡ 
	glossy_
;

66 
±h»ad_mu‹x_t
 
	gm_
;

67 
±h»ad_mu‹x_t
 
	g»f_m_
;

68 
±h»ad_cÚd_t
 
	g£nd_com¶‘e_
;

69 
±h»ad_cÚd_t
 
	g£nd_wa™_
;

72 şas 
	ctıscÚn
 {

73 
	mpublic
:

74 
tıscÚn
(
chªmgr
 *
m1
, 
pÜt
, 
lossy‹¡
=0);

75 ~
tıscÚn
();

77 
acû±_cÚn
();

78 
	m´iv©e
:

80 
±h»ad_mu‹x_t
 
m_
;

81 
±h»ad_t
 
	mth_
;

82 
	mpe_
[2];

84 
	mtı_
;

85 
chªmgr
 *
	mmgr_
;

86 
	mlossy_
;

87 
	m¡d
::
m­
<, 
	mcÚÃùiÚ
 *> 
	mcÚns_
;

89 
´oûss_acû±
();

92 
	sbundË
 {

93 
bundË
(
chªmgr
 *
m
, 
s
, 
l
):
mgr
(m),
tı
(s),
lossy
(l) {}

94 
chªmgr
 *
	mmgr
;

95 
	mtı
;

96 
	mlossy
;

99 
¡¬t_acû±_th»ad
(
chªmgr
 *
mgr
, 
pÜt
, 
±h»ad_t
 *
th
, *
fd
 = 
NULL
, 
lossy
=0);

100 
cÚÃùiÚ
 *
cÚÃù_to_d¡
(cÚ¡ 
sockaddr_š
 &
d¡
, 
chªmgr
 *
mgr
, 
lossy
=0);

	@rpc/fifo.h

1 #iâdeà
fifo_h


2 
	#fifo_h


	)

7 
	~<”ºo.h
>

8 
	~<li¡
>

9 
	~<sys/time.h
>

10 
	~<time.h
>

11 
	~<”ºo.h
>

12 
	~"¦ock.h
"

13 
	~"Ïng/v”ify.h
"

15 
	g‹m¶©e
<
şass
 
	gT
>

16 şas 
	cfifo
 {

17 
	mpublic
:

18 
fifo
(
m
=0);

19 ~
fifo
();

20 
boŞ
 
’q
(
T
, boŞ 
blockšg
=
Œue
);

21 
deq
(
T
 *);

22 
boŞ
 
size
();

24 
	m´iv©e
:

25 
¡d
::
li¡
<
T
> 
q_
;

26 
±h»ad_mu‹x_t
 
	mm_
;

27 
±h»ad_cÚd_t
 
	mnÚ_em±y_c_
;

28 
±h»ad_cÚd_t
 
	mhas_¥aû_c_
;

29 
	mmax_
;

32 
	g‹m¶©e
<
şass
 
	gT
>

33 
	gfifo
<
	gT
>::
	$fifo
(
lim™
è: 
	$max_
(
lim™
)

35 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
m_
, 0) == 0);

36 
	`VERIFY
(
	`±h»ad_cÚd_š™
(&
nÚ_em±y_c_
, 0) == 0);

37 
	`VERIFY
(
	`±h»ad_cÚd_š™
(&
has_¥aû_c_
, 0) == 0);

38 
	}
}

40 
	g‹m¶©e
<
şass
 
	gT
>

41 
	gfifo
<
	gT
>::~
	$fifo
()

44 
	`VERIFY
(
	`±h»ad_mu‹x_de¡roy
(&
m_
)==0);

45 
	`VERIFY
(
	`±h»ad_cÚd_de¡roy
(&
nÚ_em±y_c_
) == 0);

46 
	`VERIFY
(
	`±h»ad_cÚd_de¡roy
(&
has_¥aû_c_
) == 0);

47 
	}
}

49 
	g‹m¶©e
<
şass
 
	gT
> 
boŞ


50 
	gfifo
<
	gT
>::
	$size
()

52 
ScİedLock
 
	`ml
(&
m_
);

53  
q_
.
	`size
();

54 
	}
}

56 
	g‹m¶©e
<
şass
 
	gT
> 
boŞ


57 
	gfifo
<
	gT
>::
	$’q
(
T
 
e
, 
boŞ
 
blockšg
)

59 
ScİedLock
 
	`ml
(&
m_
);

61 ià(!
max_
 || 
q_
.
	`size
() < max_) {

62 
q_
.
	`push_back
(
e
);

65 ià(
blockšg
)

66 
	`VERIFY
(
	`±h»ad_cÚd_wa™
(&
has_¥aû_c_
, &
m_
) == 0);

68  
çl£
;

70 
	`VERIFY
(
	`±h»ad_cÚd_sigÇl
(&
nÚ_em±y_c_
) == 0);

71  
Œue
;

72 
	}
}

74 
	g‹m¶©e
<
şass
 
	gT
> 

75 
	gfifo
<
	gT
>::
	$deq
(
T
 *
e
)

77 
ScİedLock
 
	`ml
(&
m_
);

80 if(
q_
.
	`em±y
()){

81 
	`VERIFY
 (
	`±h»ad_cÚd_wa™
(&
nÚ_em±y_c_
, &
m_
) == 0);

83 *
e
 = 
q_
.
	`äÚt
();

84 
q_
.
	`pİ_äÚt
();

85 ià(
max_
 && 
q_
.
	`size
() < max_) {

86 
	`VERIFY
(
	`±h»ad_cÚd_sigÇl
(&
has_¥aû_c_
)==0);

92 
	}
}

	@rpc/jsl_log.cc

1 
	~"j¦_log.h
"

3 
	gJSL_DEBUG_LEVEL
 = 0;

5 
	$j¦_£t_debug
(
Ëv–
) {

6 
JSL_DEBUG_LEVEL
 = 
Ëv–
;

7 
	}
}

	@rpc/jsl_log.h

1 #iâdeà
__JSL_LOG_H__


2 
	#__JSL_LOG_H__
 1

	)

4 
	edbcode
 {

5 
	mJSL_DBG_OFF
 = 0,

6 
	mJSL_DBG_1
 = 1,

7 
	mJSL_DBG_2
 = 2,

8 
	mJSL_DBG_3
 = 3,

9 
	mJSL_DBG_4
 = 4,

12 
JSL_DEBUG_LEVEL
;

14 
	#j¦_log
(
Ëv–
,...) \

16 if(
JSL_DEBUG_LEVEL
 < 
	`abs
(
Ëv–
)) \

19 { 
	`´štf
(
__VA_ARGS__
);} \

21 } 0)

	)

23 
j¦_£t_debug
(
Ëv–
);

	@rpc/marshall.h

1 #iâdeà
m¬sh®l_h


2 
	#m¬sh®l_h


	)

4 
	~<io¡»am
>

5 
	~<s¡»am
>

6 
	~<¡ršg
>

7 
	~<veùÜ
>

8 
	~<m­
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<c¡ddef
>

12 
	~<š‰y³s.h
>

13 
	~"Ïng/v”ify.h
"

14 
	~"Ïng/®gÜ™hm.h
"

16 
	s»q_h—d”
 {

17 
»q_h—d”
(
x
=0, 
p
=0, 
c
 = 0, 
s
 = 0, 
xi
 = 0):

18 
xid
(
x
), 
´oc
(
p
), 
şt_nÚû
(
c
), 
¤v_nÚû
(
s
), 
xid_»p
(
xi
) {}

19 
	mxid
;

20 
	m´oc
;

21 
	mşt_nÚû
;

22 
	m¤v_nÚû
;

23 
	mxid_»p
;

26 
	s»¶y_h—d”
 {

27 
»¶y_h—d”
(
x
=0, 
r
=0): 
xid
(x), 
»t
(r) {}

28 
	mxid
;

29 
	m»t
;

32 
ušt64_t
 
	t½c_checksum_t
;

33 
	t½c_sz_t
;

37 
	mDEFAULT_RPC_SZ
 = 1024,

38 #ià
RPC_CHECKSUMMING


40 
	mRPC_HEADER_SZ
 = 
¡©ic_max
<(
»q_h—d”
), (
	m»¶y_h—d”
)>::
v®ue
 + (
½c_sz_t
è+ (
½c_checksum_t
)

42 
RPC_HEADER_SZ
 = 
¡©ic_max
<(
»q_h—d”
), (
	m»¶y_h—d”
)>::
v®ue
 + (
½c_sz_t
)

46 şas 
	cm¬sh®l
 {

47 
	m´iv©e
:

48 *
_buf
;

49 
	m_ÿ·
;

50 
	m_šd
;

52 
	mpublic
:

53 
	$m¬sh®l
() {

54 
_buf
 = (*è
	`m®loc
(()*
DEFAULT_RPC_SZ
);

55 
	`VERIFY
(
_buf
);

56 
_ÿ·
 = 
DEFAULT_RPC_SZ
;

57 
_šd
 = 
RPC_HEADER_SZ
;

60 ~
	$m¬sh®l
() {

61 ià(
_buf
)

62 
	`ä“
(
_buf
);

63 
	}
}

65 
	$size
(è{  
_šd
;
	}
}

66 *
	$c¡r
(è{  
_buf
;
	}
}

68 
¿wby‹
();

69 
¿wby‹s
(const *, );

72 
	g¡d
::
¡ršg
 
	$g‘_cÚ‹Á
() {

73  
¡d
::
	`¡ršg
(
_buf
+
RPC_HEADER_SZ
,
_šd
-RPC_HEADER_SZ);

74 
	}
}

77 
	g¡d
::
¡ršg
 
	$¡r
() {

78  
	`g‘_cÚ‹Á
();

79 
	}
}

81 
·ck
(
i
);

83 
	$·ck_»q_h—d”
(cÚ¡ 
»q_h—d”
 &
h
) {

84 
§ved_sz
 = 
_šd
;

86 
_šd
 = (
½c_sz_t
);

87 #ià
RPC_CHECKSUMMING


88 
_šd
 +ğ(
½c_checksum_t
);

90 
	`·ck
(
h
.
xid
);

91 
	`·ck
(
h
.
´oc
);

92 
	`·ck
(()
h
.
şt_nÚû
);

93 
	`·ck
(()
h
.
¤v_nÚû
);

94 
	`·ck
(
h
.
xid_»p
);

95 
_šd
 = 
§ved_sz
;

96 
	}
}

98 
	$·ck_»¶y_h—d”
(cÚ¡ 
»¶y_h—d”
 &
h
) {

99 
§ved_sz
 = 
_šd
;

101 
_šd
 = (
½c_sz_t
);

102 #ià
RPC_CHECKSUMMING


103 
_šd
 +ğ(
½c_checksum_t
);

105 
	`·ck
(
h
.
xid
);

106 
	`·ck
(
h
.
»t
);

107 
_šd
 = 
§ved_sz
;

108 
	}
}

110 
	$ke_buf
(**
b
, *
s
) {

111 *
b
 = 
_buf
;

112 *
s
 = 
_šd
;

113 
_buf
 = 
NULL
;

114 
_šd
 = 0;

116 
	}
}

118 
	gm¬sh®l
& 
	gİ”©Ü
<<(m¬sh®È&, 
	gboŞ
);

119 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

120 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

121 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

122 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

123 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

124 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

125 
	gm¬sh®l
& 
	gİ”©Ü
<<(marshall &, );

126 
	gm¬sh®l
& 
	gİ”©Ü
<<(m¬sh®È&, cÚ¡ 
	g¡d
::
¡ršg
 &);

128 şas 
	cunm¬sh®l
 {

129 
	m´iv©e
:

130 *
_buf
;

131 
	m_sz
;

132 
	m_šd
;

133 
boŞ
 
	m_ok
;

134 
	mpublic
:

135 
	$unm¬sh®l
(): 
	`_buf
(
NULL
),
	`_sz
(0),
	`_šd
(0),
	$_ok
(
çl£
) {}

136 
	$unm¬sh®l
(*
b
, 
sz
): 
	`_buf
(b),
	`_sz
(sz),
	`_šd
(),
	$_ok
(
Œue
è{
	}
}

137 
	$unm¬sh®l
(cÚ¡ 
¡d
::
¡ršg
 &
s
è: 
	`_buf
(
NULL
),
	`_sz
(0),
	`_šd
(0),
	$_ok
(
çl£
)

140 
	`ke_cÚ‹Á
(
s
);

141 
	}
}

142 ~
	$unm¬sh®l
() {

143 ià(
_buf
è
	`ä“
(_buf);

144 
	}
}

147 
ke_š
(
unm¬sh®l
 &
ªÙh”
);

150 
	$ke_cÚ‹Á
(cÚ¡ 
¡d
::
¡ršg
 &
s
) {

151 
_sz
 = 
s
.
	`size
()+
RPC_HEADER_SZ
;

152 
_buf
 = (*)
	`»®loc
(_buf,
_sz
);

153 
	`VERIFY
(
_buf
);

154 
_šd
 = 
RPC_HEADER_SZ
;

155 
	`memıy
(
_buf
+
_šd
, 
s
.
	`d©a
(), s.
	`size
());

156 
_ok
 = 
Œue
;

157 
	}
}

159 
boŞ
 
	$ok
(è{  
_ok
; 
	}
}

160 *
	$c¡r
(è{  
_buf
;
	}
}

161 
boŞ
 
okdÚe
();

162 
¿wby‹
();

163 
¿wby‹s
(
¡d
::
¡ršg
 &
s
, 
n
);

165 
	$šd
(è{  
_šd
;
	}
}

166 
	$size
(è{  
_sz
;
	}
}

167 
uÅack
(*);

168 
	$ke_buf
(**
b
, *
sz
) {

169 *
b
 = 
_buf
;

170 *
sz
 = 
_sz
;

171 
_sz
 = 
_šd
 = 0;

172 
_buf
 = 
NULL
;

173 
	}
}

175 
	$uÅack_»q_h—d”
(
»q_h—d”
 *
h
) {

177 
_šd
 = (
½c_sz_t
);

178 #ià
RPC_CHECKSUMMING


179 
_šd
 +ğ(
½c_checksum_t
);

181 
	`uÅack
(&
h
->
xid
);

182 
	`uÅack
(&
h
->
´oc
);

183 
	`uÅack
((*)&
h
->
şt_nÚû
);

184 
	`uÅack
((*)&
h
->
¤v_nÚû
);

185 
	`uÅack
(&
h
->
xid_»p
);

186 
_šd
 = 
RPC_HEADER_SZ
;

187 
	}
}

189 
	$uÅack_»¶y_h—d”
(
»¶y_h—d”
 *
h
) {

191 
_šd
 = (
½c_sz_t
);

192 #ià
RPC_CHECKSUMMING


193 
_šd
 +ğ(
½c_checksum_t
);

195 
	`uÅack
(&
h
->
xid
);

196 
	`uÅack
(&
h
->
»t
);

197 
_šd
 = 
RPC_HEADER_SZ
;

198 
	}
}

201 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unm¬sh®È&, 
	gboŞ
 &);

202 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

203 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

204 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

205 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

206 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

207 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

208 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unmarshall &, &);

209 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unm¬sh®È&, 
	g¡d
::
¡ršg
 &);

211 
	g‹m¶©e
 <
şass
 
	gC
> 
	gm¬sh®l
 &

212 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	g¡d
::
veùÜ
<
C
> 
v
)

214 
m
 << (è
v
.
size
();

215 
	gi
 = 0; i < 
	gv
.
size
(); i++)

216 
	gm
 << 
	gv
[
i
];

217  
	gm
;

220 
	g‹m¶©e
 <
şass
 
	gC
> 
	gunm¬sh®l
 &

221 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g¡d
::
veùÜ
<
C
> &
v
)

223 
n
;

224 
	gu
 >> 
	gn
;

225 
	gi
 = 0; i < 
	gn
; i++){

226 
C
 
	gz
;

227 
	gu
 >> 
	gz
;

228 
	gv
.
push_back
(
z
);

230  
	gu
;

233 
	g‹m¶©e
 <
şass
 
	gA
, cÏs 
	gB
> 
	gm¬sh®l
 &

234 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, cÚ¡ 
	g¡d
::
m­
<
A
,
	gB
> &
	gd
) {

235 
ty³Çme
 
	g¡d
::
m­
<
A
,
	gB
>::
cÚ¡_™”©Ü
 
i
;

237 
	gm
 << (è
	gd
.
size
();

239 
	gi
 = 
d
.
begš
(); i !ğd.
’d
(); i++) {

240 
	gm
 << 
	gi
->
	gfœ¡
 << i->
	g£cÚd
;

242  
	gm
;

245 
	g‹m¶©e
 <
şass
 
	gA
, cÏs 
	gB
> 
	gunm¬sh®l
 &

246 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g¡d
::
m­
<
A
,
	gB
> &
	gd
) {

247 
	gn
;

248 
	gu
 >> 
	gn
;

250 
	gd
.
ş—r
();

252 
	glcv
 = 0;†cv < 
	gn
;†cv++) {

253 
A
 
	ga
;

254 
B
 
	gb
;

255 
	gu
 >> 
	ga
 >> 
	gb
;

256 
	gd
[
a
] = 
b
;

258  
	gu
;

	@rpc/method_thread.h

1 #iâdeà
m‘hod_th»ad_h


2 
	#m‘hod_th»ad_h


	)

7 
	~<±h»ad.h
>

8 
	~<¡dio.h
>

9 
	~<¡ršg.h
>

10 
	~<¡dlib.h
>

11 
	~"Ïng/v”ify.h
"

13 
±h»ad_t


14 
	$m‘hod_th»ad_·»Á
(*(*
â
)(*), *
¬g
, 
boŞ
 
d‘ach
)

16 
±h»ad_t
 
th
;

17 
±h»ad_©Œ_t
 
©Œ
;

18 
	`±h»ad_©Œ_š™
(&
©Œ
);

20 
	`±h»ad_©Œ_£t¡acksize
(&
©Œ
, 100*1024);

21 
”r
 = 
	`±h»ad_ü—‹
(&
th
, &
©Œ
, 
â
, 
¬g
);

22 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

23 ià(
”r
 != 0) {

24 
	`årštf
(
¡d”r
, "±h»ad_ü—‹„‘ %d %s\n", 
”r
, 
	`¡»¼Ü
(err));

25 
	`ex™
(1);

28 ià(
d‘ach
) {

32 
	`VERIFY
(
	`±h»ad_d‘ach
(
th
) == 0);

35  
th
;

36 
	}
}

39 
	$m‘hod_th»ad_chd
()

43 
Şd¡©e
, 
Şdty³
;

44 
	`VERIFY
(
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_DISABLE
, &
Şd¡©e
) == 0);

45 
	`VERIFY
(
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_DEFERRED
, &
Şdty³
) == 0);

46 
	}
}

48 
	g‹m¶©e
 <
şass
 
	gC
> 
±h»ad_t


49 
m‘hod_th»ad
(
C
 *
o
, 
boŞ
 
d‘ach
, (C::*
m
)())

51 şas 
	cXXX
 {

52 
public
:

53 
C
 *
o
;

54 (
C
::*
m
)();

55 *
	`yyy
(*
vvv
) {

56 
XXX
 *
x
 = (XXX*)
vvv
;

57 
C
 *
o
 = 
x
->o;

58 (
C
::*
m
)(èğ
x
->m;

59 
d–‘e
 
x
;

60 
	`m‘hod_th»ad_chd
();

61 (
o
->*
m
)();

64 
	}
};

65 
XXX
 *
	gx
 = 
Ãw
 XXX;

66 
	gx
->
	go
 = 
o
;

67 
	gx
->
	gm
 = 
m
;

68  
m‘hod_th»ad_·»Á
(&
XXX
::
yyy
, (*è
x
, 
d‘ach
);

71 
	g‹m¶©e
 <
şass
 
	gC
, cÏs 
	gA
> 
±h»ad_t


72 
m‘hod_th»ad
(
C
 *
o
, 
boŞ
 
d‘ach
, (C::*
m
)(
A
), A 
a
)

74 şas 
	cXXX
 {

75 
public
:

76 
C
 *
o
;

77 (
C
::*
m
)(
A
 
a
);

78 
A
 
a
;

79 *
	`yyy
(*
vvv
) {

80 
XXX
 *
x
 = (XXX*)
vvv
;

81 
C
 *
o
 = 
x
->o;

82 (
C
::*
m
)(
A
 ) = 
x
->m;

83 
A
 
a
 = 
x
->a;

84 
d–‘e
 
x
;

85 
	`m‘hod_th»ad_chd
();

86 (
o
->*
m
)(
a
);

89 
	}
};

90 
XXX
 *
	gx
 = 
Ãw
 XXX;

91 
	gx
->
	go
 = 
o
;

92 
	gx
->
	gm
 = 
m
;

93 
	gx
->
	ga
 = 
a
;

94  
m‘hod_th»ad_·»Á
(&
XXX
::
yyy
, (*è
x
, 
d‘ach
);

97 
	gÇme¥aû
 {

100 
	g‹m¶©e
 <
şass
 
	gC
, cÏs 
	gA1
, cÏs 
	gA2
>

101 şas 
	cXXX
 {

102 
	gpublic
:

103 
C
 *
o
;

104 (
	gC
::*
m
)(
A1
 
a1
, 
A2
 
	ga2
);

105 
A1
 
	ga1
;

106 
A2
 
	ga2
;

107 *
yyy
(*
vvv
) {

108 
XXX
 *
	gx
 = (XXX*)
vvv
;

109 
C
 *
	go
 = 
x
->
o
;

110 (
	gC
::*
m
)(
A1
 , 
	gA2
 ) = 
x
->m;

111 
A1
 
	ga1
 = 
x
->
a1
;

112 
A2
 
	ga2
 = 
x
->
a2
;

113 
d–‘e
 
	gx
;

114 
m‘hod_th»ad_chd
();

115 (
	go
->*
	gm
)(
	ga1
, 
	ga2
);

121 
	g‹m¶©e
 <
şass
 
	gC
, cÏs 
	gA1
, cÏs 
	gA2
> 
±h»ad_t


122 
m‘hod_th»ad
(
C
 *
o
, 
boŞ
 
d‘ach
, (C::*
m
)(
A1
 , 
A2
 ), A1 
a1
, A2 
a2
)

124 
XXX
<
C
,
A1
,
A2
> *
x
 = 
Ãw
 XXX<C,A1,A2>;

125 
x
->
o
 = o;

126 
x
->
m
 = m;

127 
x
->
a1
 =‡1;

128 
x
->
a2
 =‡2;

129  
	`m‘hod_th»ad_·»Á
(&
XXX
<
C
,
A1
,
A2
>::
yyy
, (*è
x
, 
d‘ach
);

130 
	}
}

132 
	g‹m¶©e
 <
şass
 
	gC
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
> 
±h»ad_t


133 
m‘hod_th»ad
(
C
 *
o
, 
boŞ
 
d‘ach
, (C::*
m
)(
A1
 , 
A2
, 
A3
 ), A1 
a1
, A2 
a2
, A3 
a3
)

135 şas 
	cXXX
 {

136 
public
:

137 
C
 *
o
;

138 (
C
::*
m
)(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
);

139 
A1
 
a1
;

140 
A2
 
a2
;

141 
A3
 
a3
;

142 *
	`yyy
(*
vvv
) {

143 
XXX
 *
x
 = (XXX*)
vvv
;

144 
C
 *
o
 = 
x
->o;

145 (
C
::*
m
)(
A1
 , 
A2
 , 
A3
 ) = 
x
->m;

146 
A1
 
a1
 = 
x
->a1;

147 
A2
 
a2
 = 
x
->a2;

148 
A3
 
a3
 = 
x
->a3;

149 
d–‘e
 
x
;

150 
	`m‘hod_th»ad_chd
();

151 (
o
->*
m
)(
a1
, 
a2
, 
a3
);

154 
	}
};

155 
XXX
 *
	gx
 = 
Ãw
 XXX;

156 
	gx
->
	go
 = 
o
;

157 
	gx
->
	gm
 = 
m
;

158 
	gx
->
	ga1
 = 
a1
;

159 
	gx
->
	ga2
 = 
a2
;

160 
	gx
->
	ga3
 = 
a3
;

161  
m‘hod_th»ad_·»Á
(&
XXX
::
yyy
, (*è
x
, 
d‘ach
);

	@rpc/pollmgr.cc

1 
	~<sys/time.h
>

2 
	~<”ºo.h
>

3 
	~<fú.h
>

4 
	~<uni¡d.h
>

6 
	~"¦ock.h
"

7 
	~"j¦_log.h
"

8 
	~"m‘hod_th»ad.h
"

9 
	~"Ïng/v”ify.h
"

10 
	~"pŞlmgr.h
"

12 
PŞlMgr
 *
	gPŞlMgr
::
š¡ªû
 = 
NULL
;

13 
±h»ad_Úû_t
 
	gpŞlmgr_is_š™Ÿlized
 = 
PTHREAD_ONCE_INIT
;

16 
	$PŞlMgrIn™
()

18 
PŞlMgr
::
š¡ªû
 = 
Ãw
 
	`PŞlMgr
();

19 
	}
}

21 
PŞlMgr
 *

22 
	gPŞlMgr
::
	$In¡ªû
()

24 
	`±h»ad_Úû
(&
pŞlmgr_is_š™Ÿlized
, 
PŞlMgrIn™
);

25  
š¡ªû
;

26 
	}
}

28 
	gPŞlMgr
::
	$PŞlMgr
(è: 
	$³ndšg_chªge_
(
çl£
)

30 
	`bz”o
(
ÿÎbacks_
, 
MAX_POLL_FDS
*(*));

31 
aio_
 = 
Ãw
 
	`S–eùAIO
();

34 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
m_
, 
NULL
) == 0);

35 
	`VERIFY
(
	`±h»ad_cÚd_š™
(&
chªgedÚe_c_
, 
NULL
) == 0);

36 
	`VERIFY
((
th_
 = 
	`m‘hod_th»ad
(
this
, 
çl£
, &
PŞlMgr
::
wa™_loİ
)) != 0);

37 
	}
}

39 
	gPŞlMgr
::~
	$PŞlMgr
()

42 
	`VERIFY
(0);

43 
	}
}

46 
	gPŞlMgr
::
	$add_ÿÎback
(
fd
, 
pŞl_æag
 
æag
, 
aio_ÿÎback
 *
ch
)

48 
	`VERIFY
(
fd
 < 
MAX_POLL_FDS
);

50 
ScİedLock
 
	`ml
(&
m_
);

51 
aio_
->
	`w©ch_fd
(
fd
, 
æag
);

53 
	`VERIFY
(!
ÿÎbacks_
[
fd
] || c®lbacks_[fd]==
ch
);

54 
ÿÎbacks_
[
fd
] = 
ch
;

55 
	}
}

61 
	gPŞlMgr
::
	$block_»move_fd
(
fd
)

63 
ScİedLock
 
	`ml
(&
m_
);

64 
aio_
->
	`unw©ch_fd
(
fd
, 
CB_RDWR
);

65 
³ndšg_chªge_
 = 
Œue
;

66 
	`VERIFY
(
	`±h»ad_cÚd_wa™
(&
chªgedÚe_c_
, &
m_
)==0);

67 
ÿÎbacks_
[
fd
] = 
NULL
;

68 
	}
}

71 
	gPŞlMgr
::
	$d–_ÿÎback
(
fd
, 
pŞl_æag
 
æag
)

73 
ScİedLock
 
	`ml
(&
m_
);

74 ià(
aio_
->
	`unw©ch_fd
(
fd
, 
æag
)) {

75 
ÿÎbacks_
[
fd
] = 
NULL
;

77 
	}
}

79 
boŞ


80 
	gPŞlMgr
::
	$has_ÿÎback
(
fd
, 
pŞl_æag
 
æag
, 
aio_ÿÎback
 *
c
)

82 
ScİedLock
 
	`ml
(&
m_
);

83 ià(!
ÿÎbacks_
[
fd
] || c®lbacks_[fd]!=
c
)

84  
çl£
;

86  
aio_
->
	`is_w©ched
(
fd
, 
æag
);

87 
	}
}

90 
	gPŞlMgr
::
	$wa™_loİ
()

93 
¡d
::
veùÜ
<> 
»adabË
;

94 
¡d
::
veùÜ
<> 
wr™abË
;

98 
ScİedLock
 
	`ml
(&
m_
);

99 ià(
³ndšg_chªge_
) {

100 
³ndšg_chªge_
 = 
çl£
;

101 
	`VERIFY
(
	`±h»ad_cÚd_brßdÿ¡
(&
chªgedÚe_c_
)==0);

104 
»adabË
.
	`ş—r
();

105 
wr™abË
.
	`ş—r
();

106 
aio_
->
	`wa™_»ady
(&
»adabË
,&
wr™abË
);

108 ià(!
»adabË
.
	`size
(è&& !
wr™abË
.size()) {

114 
i
 = 0; i < 
»adabË
.
	`size
(); i++) {

115 
fd
 = 
»adabË
[
i
];

116 ià(
ÿÎbacks_
[
fd
])

117 
ÿÎbacks_
[
fd
]->
	`»ad_cb
(fd);

120 
i
 = 0; i < 
wr™abË
.
	`size
(); i++) {

121 
fd
 = 
wr™abË
[
i
];

122 ià(
ÿÎbacks_
[
fd
])

123 
ÿÎbacks_
[
fd
]->
	`wr™e_cb
(fd);

126 
	}
}

128 
	gS–eùAIO
::
	$S–eùAIO
(è: 
	$highfds_
(0)

130 
	`FD_ZERO
(&
rfds_
);

131 
	`FD_ZERO
(&
wfds_
);

133 
	`VERIFY
(
	`pe
(
pefd_
) == 0);

134 
	`FD_SET
(
pefd_
[0], &
rfds_
);

135 
highfds_
 = 
pefd_
[0];

137 
æags
 = 
	`fú
(
pefd_
[0], 
F_GETFL
, 
NULL
);

138 
æags
 |ğ
O_NONBLOCK
;

139 
	`fú
(
pefd_
[0], 
F_SETFL
, 
æags
);

141 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
m_
, 
NULL
) == 0);

142 
	}
}

144 
	gS–eùAIO
::~
	$S–eùAIO
()

146 
	`VERIFY
(
	`±h»ad_mu‹x_de¡roy
(&
m_
) == 0);

147 
	}
}

150 
	gS–eùAIO
::
	$w©ch_fd
(
fd
, 
pŞl_æag
 
æag
)

152 
ScİedLock
 
	`ml
(&
m_
);

153 ià(
highfds_
 <ğ
fd
)

154 
highfds_
 = 
fd
;

156 ià(
æag
 =ğ
CB_RDONLY
) {

157 
	`FD_SET
(
fd
,&
rfds_
);

158 }ià(
æag
 =ğ
CB_WRONLY
) {

159 
	`FD_SET
(
fd
,&
wfds_
);

161 
	`FD_SET
(
fd
,&
rfds_
);

162 
	`FD_SET
(
fd
,&
wfds_
);

165 
tmp
 = 1;

166 
	`VERIFY
(
	`wr™e
(
pefd_
[1], &
tmp
, (tmp))==1);

167 
	}
}

169 
boŞ


170 
	gS–eùAIO
::
	$is_w©ched
(
fd
, 
pŞl_æag
 
æag
)

172 
ScİedLock
 
	`ml
(&
m_
);

173 ià(
æag
 =ğ
CB_RDONLY
) {

174  
	`FD_ISSET
(
fd
,&
rfds_
);

175 }ià(
æag
 =ğ
CB_WRONLY
) {

176  
	`FD_ISSET
(
fd
,&
wfds_
);

178  (
	`FD_ISSET
(
fd
,&
rfds_
è&& FD_ISSET(fd,&
wfds_
));

180 
	}
}

182 
boŞ


183 
	gS–eùAIO
::
	$unw©ch_fd
(
fd
, 
pŞl_æag
 
æag
)

185 
ScİedLock
 
	`ml
(&
m_
);

186 ià(
æag
 =ğ
CB_RDONLY
) {

187 
	`FD_CLR
(
fd
, &
rfds_
);

188 }ià(
æag
 =ğ
CB_WRONLY
) {

189 
	`FD_CLR
(
fd
, &
wfds_
);

190 }ià(
æag
 =ğ
CB_RDWR
) {

191 
	`FD_CLR
(
fd
, &
wfds_
);

192 
	`FD_CLR
(
fd
, &
rfds_
);

194 
	`VERIFY
(0);

197 ià(!
	`FD_ISSET
(
fd
,&
rfds_
è&& !FD_ISSET(fd,&
wfds_
)) {

198 ià(
fd
 =ğ
highfds_
) {

199 
Ãwh
 = 
pefd_
[0];

200 
i
 = 0; i <ğ
highfds_
; i++) {

201 ià(
	`FD_ISSET
(
i
, &
rfds_
)) {

202 
Ãwh
 = 
i
;

203 }ià(
	`FD_ISSET
(
i
, &
wfds_
)) {

204 
Ãwh
 = 
i
;

207 
highfds_
 = 
Ãwh
;

210 ià(
æag
 =ğ
CB_RDWR
) {

211 
tmp
 = 1;

212 
	`VERIFY
(
	`wr™e
(
pefd_
[1], &
tmp
, (tmp))==1);

214  (!
	`FD_ISSET
(
fd
, &
rfds_
è&& !FD_ISSET(fd, &
wfds_
));

215 
	}
}

218 
	gS–eùAIO
::
wa™_»ady
(
¡d
::
veùÜ
<> *
»adabË
, std::veùÜ<> *
wr™abË
)

220 
fd_£t
 
Œfds
, 
	gtwfds
;

221 
	ghigh
;

224 
ScİedLock
 
ml
(&
m_
);

225 
	gŒfds
 = 
rfds_
;

226 
	gtwfds
 = 
wfds_
;

227 
	ghigh
 = 
highfds_
;

231 
	g»t
 = 
£Ëù
(
high
+1, &
Œfds
, &
twfds
, 
NULL
, NULL);

233 ià(
	g»t
 < 0) {

234 ià(
	g”ºo
 =ğ
EINTR
) {

237 
³¼Ü
("select:");

238 
j¦_log
(
JSL_DBG_OFF
, "PŞlMgr::£Ëù_loİ fau»ƒ¼nØ%d\n",
”ºo
);

239 
VERIFY
(0);

243 
	gfd
 = 0; fd <ğ
high
; fd++) {

244 ià(
	gfd
 =ğ
pefd_
[0] && 
FD_ISSET
(
fd
, &
Œfds
)) {

245 
	gtmp
;

246 
VERIFY
 (
»ad
(
pefd_
[0],&
tmp
,(tmp))==1);

247 
VERIFY
(
tmp
==1);

249 ià(
FD_ISSET
(
fd
, &
twfds
)) {

250 
	gwr™abË
->
push_back
(
fd
);

252 ià(
FD_ISSET
(
fd
, &
Œfds
)) {

253 
	g»adabË
->
push_back
(
fd
);

259 #ifdeà
__lšux__


261 
	gEPŞlAIO
::
	$EPŞlAIO
()

263 
pŞlfd_
 = 
	`•Şl_ü—‹
(
MAX_POLL_FDS
);

264 
	`VERIFY
(
pŞlfd_
 >= 0);

265 
	`bz”o
(
fd¡©us_
, ()*
MAX_POLL_FDS
);

266 
	}
}

268 
	gEPŞlAIO
::~
	$EPŞlAIO
()

270 
	`şo£
(
pŞlfd_
);

271 
	}
}

273 
šlše


274 
	$pŞl_æag_to_ev’t
(
pŞl_æag
 
æag
)

276 
f
;

277 ià(
æag
 =ğ
CB_RDONLY
) {

278 
f
 = 
EPOLLIN
;

279 }ià(
æag
 =ğ
CB_WRONLY
) {

280 
f
 = 
EPOLLOUT
;

282 
f
 = 
EPOLLIN
 | 
EPOLLOUT
;

284  
f
;

285 
	}
}

288 
	gEPŞlAIO
::
	$w©ch_fd
(
fd
, 
pŞl_æag
 
æag
)

290 
	`VERIFY
(
fd
 < 
MAX_POLL_FDS
);

292 
•Şl_ev’t
 
ev
;

293 
İ
 = 
fd¡©us_
[
fd
]? 
EPOLL_CTL_MOD
 : 
EPOLL_CTL_ADD
;

294 
fd¡©us_
[
fd
] |ğ()
æag
;

296 
ev
.
ev’ts
 = 
EPOLLET
;

297 
ev
.
d©a
.
fd
 = fd;

299 ià(
fd¡©us_
[
fd
] & 
CB_RDONLY
) {

300 
ev
.
ev’ts
 |ğ
EPOLLIN
;

302 ià(
fd¡©us_
[
fd
] & 
CB_WRONLY
) {

303 
ev
.
ev’ts
 |ğ
EPOLLOUT
;

306 ià(
æag
 =ğ
CB_RDWR
) {

307 
	`VERIFY
(
ev
.
ev’ts
 =ğ(
ušt32_t
)(
EPOLLET
 | 
EPOLLIN
 | 
EPOLLOUT
));

310 
	`VERIFY
(
	`•Şl_ùl
(
pŞlfd_
, 
İ
, 
fd
, &
ev
) == 0);

311 
	}
}

313 
boŞ


314 
	gEPŞlAIO
::
	$unw©ch_fd
(
fd
, 
pŞl_æag
 
æag
)

316 
	`VERIFY
(
fd
 < 
MAX_POLL_FDS
);

317 
fd¡©us_
[
fd
] &ğ~()
æag
;

319 
•Şl_ev’t
 
ev
;

320 
İ
 = 
fd¡©us_
[
fd
]? 
EPOLL_CTL_MOD
 : 
EPOLL_CTL_DEL
;

322 
ev
.
ev’ts
 = 
EPOLLET
;

323 
ev
.
d©a
.
fd
 = fd;

325 ià(
fd¡©us_
[
fd
] & 
CB_RDONLY
) {

326 
ev
.
ev’ts
 |ğ
EPOLLIN
;

328 ià(
fd¡©us_
[
fd
] & 
CB_WRONLY
) {

329 
ev
.
ev’ts
 |ğ
EPOLLOUT
;

332 ià(
æag
 =ğ
CB_RDWR
) {

333 
	`VERIFY
(
İ
 =ğ
EPOLL_CTL_DEL
);

335 
	`VERIFY
(
	`•Şl_ùl
(
pŞlfd_
, 
İ
, 
fd
, &
ev
) == 0);

336  (
İ
 =ğ
EPOLL_CTL_DEL
);

337 
	}
}

339 
boŞ


340 
	gEPŞlAIO
::
	$is_w©ched
(
fd
, 
pŞl_æag
 
æag
)

342 
	`VERIFY
(
fd
 < 
MAX_POLL_FDS
);

343  ((
fd¡©us_
[
fd
] & 
CB_MASK
è=ğ
æag
);

344 
	}
}

347 
	gEPŞlAIO
::
wa™_»ady
(
¡d
::
veùÜ
<> *
»adabË
, std::veùÜ<> *
wr™abË
)

349 
nfds
 = 
•Şl_wa™
(
pŞlfd_
, 
»ady_
, 
MAX_POLL_FDS
, -1);

350 
	gi
 = 0; i < 
	gnfds
; i++) {

351 ià(
	g»ady_
[
i
].
	gev’ts
 & 
	gEPOLLIN
) {

352 
	g»adabË
->
push_back
(
»ady_
[
i
].
d©a
.
fd
);

354 ià(
	g»ady_
[
i
].
	gev’ts
 & 
	gEPOLLOUT
) {

355 
	gwr™abË
->
push_back
(
»ady_
[
i
].
d©a
.
fd
);

	@rpc/pollmgr.h

1 #iâdeà
pŞlmgr_h


2 
	#pŞlmgr_h


	)

4 
	~<sys/£Ëù.h
>

5 
	~<veùÜ
>

7 #ifdeà
__lšux__


8 
	~<sys/•Şl.h
>

11 
	#MAX_POLL_FDS
 128

	)

14 
	mCB_NONE
 = 0x0,

15 
	mCB_RDONLY
 = 0x1,

16 
	mCB_WRONLY
 = 0x10,

17 
	mCB_RDWR
 = 0x11,

18 
	mCB_MASK
 = ~0x11,

19 } 
	tpŞl_æag
;

21 şas 
	caio_mgr
 {

22 
	mpublic
:

23 
vœtu®
 
w©ch_fd
(
fd
, 
pŞl_æag
 
æag
) = 0;

24 
vœtu®
 
boŞ
 
unw©ch_fd
(
fd
, 
pŞl_æag
 
æag
) = 0;

25 
vœtu®
 
boŞ
 
is_w©ched
(
fd
, 
pŞl_æag
 
æag
) = 0;

26 
vœtu®
 
wa™_»ady
(
¡d
::
veùÜ
<> *
»adabË
, std::veùÜ<> *
wr™abË
) = 0;

27 
	mvœtu®
 ~
	$aio_mgr
() {}

28 
	}
};

30 şas 
	caio_ÿÎback
 {

31 
	mpublic
:

32 
vœtu®
 
»ad_cb
(
fd
) = 0;

33 
vœtu®
 
wr™e_cb
(
fd
) = 0;

34 
	mvœtu®
 ~
	$aio_ÿÎback
() {}

35 
	}
};

37 şas 
	cPŞlMgr
 {

38 
	mpublic
:

39 
PŞlMgr
();

40 ~
PŞlMgr
();

42 
PŞlMgr
 *
In¡ªû
();

43 
PŞlMgr
 *
C»©eIn¡
();

45 
add_ÿÎback
(
fd
, 
pŞl_æag
 
æag
, 
aio_ÿÎback
 *
ch
);

46 
d–_ÿÎback
(
fd
, 
pŞl_æag
 
æag
);

47 
boŞ
 
has_ÿÎback
(
fd
, 
pŞl_æag
 
æag
, 
aio_ÿÎback
 *
ch
);

48 
block_»move_fd
(
fd
);

49 
wa™_loİ
();

52 
PŞlMgr
 *
	mš¡ªû
;

53 
	mu£ful
;

54 
	mu£Ëss
;

56 
	m´iv©e
:

57 
±h»ad_mu‹x_t
 
m_
;

58 
±h»ad_cÚd_t
 
	mchªgedÚe_c_
;

59 
±h»ad_t
 
	mth_
;

61 
aio_ÿÎback
 *
	mÿÎbacks_
[
MAX_POLL_FDS
];

62 
aio_mgr
 *
	maio_
;

63 
boŞ
 
	m³ndšg_chªge_
;

67 şas 
	cS–eùAIO
 : 
public
 
aio_mgr
 {

68 
public
 :

70 
S–eùAIO
();

71 ~
S–eùAIO
();

72 
w©ch_fd
(
fd
, 
pŞl_æag
 
æag
);

73 
boŞ
 
unw©ch_fd
(
fd
, 
pŞl_æag
 
æag
);

74 
boŞ
 
is_w©ched
(
fd
, 
pŞl_æag
 
æag
);

75 
wa™_»ady
(
¡d
::
veùÜ
<> *
»adabË
, std::veùÜ<> *
wr™abË
);

77 
	m´iv©e
:

79 
fd_£t
 
rfds_
;

80 
fd_£t
 
	mwfds_
;

81 
	mhighfds_
;

82 
	mpefd_
[2];

84 
±h»ad_mu‹x_t
 
	mm_
;

88 #ifdeà
__lšux__


89 şas 
	cEPŞlAIO
 : 
public
 
aio_mgr
 {

90 
public
:

91 
EPŞlAIO
();

92 ~
EPŞlAIO
();

93 
w©ch_fd
(
fd
, 
pŞl_æag
 
æag
);

94 
boŞ
 
unw©ch_fd
(
fd
, 
pŞl_æag
 
æag
);

95 
boŞ
 
is_w©ched
(
fd
, 
pŞl_æag
 
æag
);

96 
wa™_»ady
(
¡d
::
veùÜ
<> *
»adabË
, std::veùÜ<> *
wr™abË
);

98 
	m´iv©e
:

99 
pŞlfd_
;

100 
•Şl_ev’t
 
	m»ady_
[
MAX_POLL_FDS
];

101 
	mfd¡©us_
[
MAX_POLL_FDS
];

	@rpc/rpc.cc

63 
	~"½c.h
"

64 
	~"m‘hod_th»ad.h
"

65 
	~"¦ock.h
"

67 
	~<sys/ty³s.h
>

68 
	~<¬·/š‘.h
>

69 
	~<Ãtš‘/tı.h
>

70 
	~<time.h
>

71 
	~<Ãtdb.h
>

73 
	~"j¦_log.h
"

74 
	~"g‘time.h
"

75 
	~"Ïng/v”ify.h
"

77 cÚ¡ 
	g½cc
::
TO
 
½cc
::
to_max
 = { 120000 };

78 cÚ¡ 
	g½cc
::
TO
 
½cc
::
to_mš
 = { 1000 };

80 
	g½cc
::
ÿÎ”
::
	$ÿÎ”
(
xxid
, 
unm¬sh®l
 *
xun
)

81 : 
	`xid
(
xxid
), 
	`un
(
xun
), 
	$dÚe
(
çl£
)

83 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
m
,0) == 0);

84 
	`VERIFY
(
	`±h»ad_cÚd_š™
(&
c
, 0) == 0);

85 
	}
}

87 
	g½cc
::
ÿÎ”
::~
	$ÿÎ”
()

89 
	`VERIFY
(
	`±h»ad_mu‹x_de¡roy
(&
m
) == 0);

90 
	`VERIFY
(
	`±h»ad_cÚd_de¡roy
(&
c
) == 0);

91 
	}
}

93 
šlše


94 
	$£t_¿nd_£ed
()

96 
time¥ec
 
ts
;

97 
	`şock_g‘time
(
CLOCK_REALTIME
, &
ts
);

98 
	`¤ªdom
(()
ts
.
tv_n£c
^(()
	`g‘pid
()));

99 
	}
}

101 
	g½cc
::
	$½cc
(
sockaddr_š
 
d
, 
boŞ
 
»Œªs
) :

102 
	`d¡_
(
d
), 
	`¤v_nÚû_
(0), 
	`bšd_dÚe_
(
çl£
), 
	`xid_
(1), 
	`lossy‹¡_
(0),

103 
	`»Œªs_
(
»Œªs
), 
	`»achabË_
(
Œue
), 
	`chª_
(
NULL
), 
	`de¡roy_wa™_
 (
çl£
), 
	`xid_»p_dÚe_
(-1)

105 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
m_
, 0) == 0);

106 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
chª_m_
, 0) == 0);

107 
	`VERIFY
(
	`±h»ad_cÚd_š™
(&
de¡roy_wa™_c_
, 0) == 0);

109 if(
»Œªs
){

110 
	`£t_¿nd_£ed
();

111 
şt_nÚû_
 = 
	`¿ndom
();

116 
şt_nÚû_
 = 0;

119 *
loss_’v
 = 
	`g‘’v
("RPC_LOSSY");

120 if(
loss_’v
 !ğ
NULL
){

121 
lossy‹¡_
 = 
	`©oi
(
loss_’v
);

125 
xid_»p_wšdow_
.
	`push_back
(0);

127 
	`j¦_log
(
JSL_DBG_2
, "rpcc::rpcc cltn_nonce is %d†ossy %d\n",

128 
şt_nÚû_
, 
lossy‹¡_
);

129 
	}
}

133 
	g½cc
::~
	$½cc
()

135 
	`j¦_log
(
JSL_DBG_2
, "rpcc::~rpcc delete‚once %d channo=%d\n",

136 
şt_nÚû_
, 
chª_
?chª_->
	`chªno
():-1);

137 if(
chª_
){

138 
chª_
->
	`şo£cÚn
();

139 
chª_
->
	`deüef
();

141 
	`VERIFY
(
ÿÎs_
.
	`size
() == 0);

142 
	`VERIFY
(
	`±h»ad_mu‹x_de¡roy
(&
m_
) == 0);

143 
	`VERIFY
(
	`±h»ad_mu‹x_de¡roy
(&
chª_m_
) == 0);

144 
	}
}

147 
	g½cc
::
	$bšd
(
TO
 
to
)

149 
r
;

150 
»t
 = 
	`ÿÎ
(
½c_cÚ¡
::
bšd
, 0, 
r
, 
to
);

151 if(
»t
 == 0){

152 
ScİedLock
 
	`ml
(&
m_
);

153 
bšd_dÚe_
 = 
Œue
;

154 
¤v_nÚû_
 = 
r
;

156 
	`j¦_log
(
JSL_DBG_2
, "rpcc::bind %s failed %d\n",

157 
	`š‘_Áß
(
d¡_
.
sš_addr
), 
»t
);

159  
»t
;

160 
	}
};

164 
	g½cc
::
	$ÿnûl
()

166 
ScİedLock
 
	`ml
(&
m_
);

167 
	`´štf
("rpcc::cancel: force callerso fail\n");

168 
¡d
::
m­
<,
ÿÎ”
*>::
™”©Ü
 
™”
;

169 
™”
 = 
ÿÎs_
.
	`begš
(); i‹¸!ğÿÎs_.
	`’d
(); iter++){

170 
ÿÎ”
 *
ÿ
 = 
™”
->
£cÚd
;

172 
	`j¦_log
(
JSL_DBG_2
, "rpcc::cancel: force callero fail\n");

174 
ScİedLock
 
	`ş
(&
ÿ
->
m
);

175 
ÿ
->
dÚe
 = 
Œue
;

176 
ÿ
->
šŒ‘
 = 
½c_cÚ¡
::
ÿnûl_çu»
;

177 
	`VERIFY
(
	`±h»ad_cÚd_sigÇl
(&
ÿ
->
c
) == 0);

181 
ÿÎs_
.
	`size
 () > 0){

182 
de¡roy_wa™_
 = 
Œue
;

183 
	`VERIFY
(
	`±h»ad_cÚd_wa™
(&
de¡roy_wa™_c_
,&
m_
) == 0);

185 
	`´štf
("rpcc::cancel: done\n");

186 
	}
}

189 
	g½cc
::
	$ÿÎ1
(
´oc
, 
m¬sh®l
 &
»q
, 
unm¬sh®l
 &
»p
,

190 
TO
 
to
)

193 
ÿÎ”
 
	`ÿ
(0, &
»p
);

194 
xid_»p
;

196 
ScİedLock
 
	`ml
(&
m_
);

198 if((
´oc
 !ğ
½c_cÚ¡
::
bšd
 && !
bšd_dÚe_
) ||

199 (
´oc
 =ğ
½c_cÚ¡
::
bšd
 && 
bšd_dÚe_
)){

200 
	`j¦_log
(
JSL_DBG_1
, "rpcc::call1„pcc has‚ot been boundo dst or bindingwice\n");

201  
½c_cÚ¡
::
bšd_çu»
;

204 if(
de¡roy_wa™_
){

205  
½c_cÚ¡
::
ÿnûl_çu»
;

208 
ÿ
.
xid
 = 
xid_
++;

209 
ÿÎs_
[
ÿ
.
xid
] = &ca;

211 
»q_h—d”
 
	`h
(
ÿ
.
xid
, 
´oc
, 
şt_nÚû_
, 
¤v_nÚû_
,

212 
xid_»p_wšdow_
.
	`äÚt
());

213 
»q
.
	`·ck_»q_h—d”
(
h
);

214 
xid_»p
 = 
xid_»p_wšdow_
.
	`äÚt
();

217 
TO
 
cu¼_to
;

218 
time¥ec
 
now
, 
Ãxtd—dlše
, 
fš®d—dlše
;

220 
	`şock_g‘time
(
CLOCK_REALTIME
, &
now
);

221 
	`add_time¥ec
(
now
, 
to
.to, &
fš®d—dlše
);

222 
cu¼_to
.
to
 = 
to_mš
.to;

224 
boŞ
 
Œªsm™
 = 
Œue
;

225 
cÚÃùiÚ
 *
ch
 = 
NULL
;

228 if(
Œªsm™
){

229 
	`g‘_»fcÚn
(&
ch
);

230 if(
ch
){

231 if(
»achabË_
) {

232 
»que¡
 
fÜgÙ
;

234 
ScİedLock
 
	`ml
(&
m_
);

235 ià(
dup_»q_
.
	`isv®id
(è&& 
xid_»p_dÚe_
 > dup_»q_.
xid
) {

236 
fÜgÙ
 = 
dup_»q_
;

237 
dup_»q_
.
	`ş—r
();

240 ià(
fÜgÙ
.
	`isv®id
())

241 
ch
->
	`£nd
((*)
fÜgÙ
.
buf
.
	`c_¡r
(), fÜgÙ.buf.
	`size
());

242 
ch
->
	`£nd
(
»q
.
	`c¡r
(),„eq.
	`size
());

244 
	`j¦_log
(
JSL_DBG_1
, "not„eachable\n");

245 
	`j¦_log
(
JSL_DBG_2
,

247 
şt_nÚû_
, 
´oc
, 
ÿ
.
xid
, clt_nonce_);

249 
Œªsm™
 = 
çl£
;

252 if(!
fš®d—dlše
.
tv_£c
)

255 
	`şock_g‘time
(
CLOCK_REALTIME
, &
now
);

256 
	`add_time¥ec
(
now
, 
cu¼_to
.
to
, &
Ãxtd—dlše
);

257 if(
	`cmp_time¥ec
(
Ãxtd—dlše
,
fš®d—dlše
) > 0){

258 
Ãxtd—dlše
 = 
fš®d—dlše
;

259 
fš®d—dlše
.
tv_£c
 = 0;

263 
ScİedLock
 
	`ÿl
(&
ÿ
.
m
);

264 !
ÿ
.
dÚe
){

265 
	`j¦_log
(
JSL_DBG_2
, "rpcc:call1: wait\n");

266 if(
	`±h»ad_cÚd_timedwa™
(&
ÿ
.
c
, &ÿ.
m
,

267 &
Ãxtd—dlše
è=ğ
ETIMEDOUT
){

268 
	`j¦_log
(
JSL_DBG_2
, "rpcc::call1:imeout\n");

272 if(
ÿ
.
dÚe
){

273 
	`j¦_log
(
JSL_DBG_2
, "rpcc::call1:„eply„eceived\n");

278 if(
»Œªs_
 && (!
ch
 || ch->
	`isd—d
())){

281 
Œªsm™
 = 
Œue
;

283 
cu¼_to
.
to
 <<= 1;

288 
ScİedLock
 
	`ml
(&
m_
);

289 
ÿÎs_
.
	`”a£
(
ÿ
.
xid
);

293 
	`upd©e_xid_»p
(
ÿ
.
xid
);

295 if(
de¡roy_wa™_
){

296 
	`VERIFY
(
	`±h»ad_cÚd_sigÇl
(&
de¡roy_wa™_c_
) == 0);

300 ià(
ÿ
.
dÚe
 && 
lossy‹¡_
)

302 
ScİedLock
 
	`ml
(&
m_
);

303 ià(!
dup_»q_
.
	`isv®id
()) {

304 
dup_»q_
.
buf
.
	`assign
(
»q
.
	`c¡r
(),„eq.
	`size
());

305 
dup_»q_
.
xid
 = 
ÿ
.xid;

307 ià(
xid_»p
 > 
xid_»p_dÚe_
)

308 
xid_»p_dÚe_
 = 
xid_»p
;

311 
ScİedLock
 
	`ÿl
(&
ÿ
.
m
);

313 
	`j¦_log
(
JSL_DBG_2
,

315 
şt_nÚû_
, 
´oc
, 
ÿ
.
xid
, 
	`š‘_Áß
(
d¡_
.
sš_addr
),

316 
	`Áohs
(
d¡_
.
sš_pÜt
), 
ÿ
.
dÚe
, ca.
šŒ‘
);

318 if(
ch
)

319 
ch
->
	`deüef
();

322  (
ÿ
.
dÚe
? ca.
šŒ‘
 : 
½c_cÚ¡
::
timeout_çu»
);

323 
	}
}

326 
	g½cc
::
	$g‘_»fcÚn
(
cÚÃùiÚ
 **
ch
)

328 
ScİedLock
 
	`ml
(&
chª_m_
);

329 if(!
chª_
 || chª_->
	`isd—d
()){

330 if(
chª_
)

331 
chª_
->
	`deüef
();

332 
chª_
 = 
	`cÚÃù_to_d¡
(
d¡_
, 
this
, 
lossy‹¡_
);

334 if(
ch
 && 
chª_
){

335 if(*
ch
){

336 (*
ch
)->
	`deüef
();

338 *
ch
 = 
chª_
;

339 (*
ch
)->
	`šüef
();

341 
	}
}

348 
boŞ


349 
	g½cc
::
	$gÙ_pdu
(
cÚÃùiÚ
 *
c
, *
b
, 
sz
)

351 
unm¬sh®l
 
	`»p
(
b
, 
sz
);

352 
»¶y_h—d”
 
h
;

353 
»p
.
	`uÅack_»¶y_h—d”
(&
h
);

355 if(!
»p
.
	`ok
()){

356 
	`j¦_log
(
JSL_DBG_1
, "rpcc:got_pdu unmarshall header failed!!!\n");

357  
Œue
;

360 
ScİedLock
 
	`ml
(&
m_
);

362 
	`upd©e_xid_»p
(
h
.
xid
);

364 if(
ÿÎs_
.
	`fšd
(
h
.
xid
è=ğÿÎs_.
	`’d
()){

365 
	`j¦_log
(
JSL_DBG_2
, "½cc::gÙ_pdu xid %d‚Ø³ndšg„eque¡\n", 
h
.
xid
);

366  
Œue
;

368 
ÿÎ”
 *
ÿ
 = 
ÿÎs_
[
h
.
xid
];

370 
ScİedLock
 
	`ş
(&
ÿ
->
m
);

371 if(!
ÿ
->
dÚe
){

372 
ÿ
->
un
->
	`ke_š
(
»p
);

373 
ÿ
->
šŒ‘
 = 
h
.
»t
;

374 if(
ÿ
->
šŒ‘
 < 0){

375 
	`j¦_log
(
JSL_DBG_2
, "rpcc::got_pdu: RPC„eplyƒrror for xid %d intret %d\n",

376 
h
.
xid
, 
ÿ
->
šŒ‘
);

378 
ÿ
->
dÚe
 = 1;

380 
	`VERIFY
(
	`±h»ad_cÚd_brßdÿ¡
(&
ÿ
->
c
) == 0);

381  
Œue
;

382 
	}
}

386 
	g½cc
::
	$upd©e_xid_»p
(
xid
)

388 
¡d
::
li¡
<>::
™”©Ü
 
™
;

390 if(
xid
 <ğ
xid_»p_wšdow_
.
	`äÚt
()){

394 
™
 = 
xid_»p_wšdow_
.
	`begš
(); iˆ!ğxid_»p_wšdow_.
	`’d
(); it++){

395 if(*
™
 > 
xid
){

396 
xid_»p_wšdow_
.
	`š£¹
(
™
, 
xid
);

397 
com´ess
;

400 
xid_»p_wšdow_
.
	`push_back
(
xid
);

402 
com´ess
:

403 
™
 = 
xid_»p_wšdow_
.
	`begš
();

404 
™
++; iˆ!ğ
xid_»p_wšdow_
.
	`’d
(); it++){

405 
xid_»p_wšdow_
.
	`äÚt
(è+ 1 =ğ*
™
)

406 
xid_»p_wšdow_
.
	`pİ_äÚt
();

408 
	}
}

411 
	g½cs
::
	$½cs
(
p1
, 
couÁ
)

412 : 
	`pÜt_
(
p1
), 
	`couÁšg_
(
couÁ
), 
	`cu¼_couÁs_
(couÁ), 
	`lossy‹¡_
(0), 
	$»achabË_
 (
Œue
)

414 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
´ocs_m_
, 0) == 0);

415 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
couÁ_m_
, 0) == 0);

416 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
»¶y_wšdow_m_
, 0) == 0);

417 
	`VERIFY
(
	`±h»ad_mu‹x_š™
(&
cÚss_m_
, 0) == 0);

419 
	`£t_¿nd_£ed
();

420 
nÚû_
 = 
	`¿ndom
();

421 
	`j¦_log
(
JSL_DBG_2
, "½cs::½c ü—‹d w™h‚Úû %d\n", 
nÚû_
);

423 *
loss_’v
 = 
	`g‘’v
("RPC_LOSSY");

424 if(
loss_’v
 !ğ
NULL
){

425 
lossy‹¡_
 = 
	`©oi
(
loss_’v
);

428 
	`»g
(
½c_cÚ¡
::
bšd
, 
this
, &
½cs
::
½cbšd
);

429 
di¥©chpoŞ_
 = 
Ãw
 
	`ThrPoŞ
(6,
çl£
);

431 
li¡’”_
 = 
Ãw
 
	`tıscÚn
(
this
, 
pÜt_
, 
lossy‹¡_
);

432 
	}
}

434 
	g½cs
::~
	$½cs
()

437 
d–‘e
 
li¡’”_
;

438 
d–‘e
 
di¥©chpoŞ_
;

439 
	`ä“_»¶y_wšdow
();

440 
	}
}

442 
boŞ


443 
	g½cs
::
	$gÙ_pdu
(
cÚÃùiÚ
 *
c
, *
b
, 
sz
)

445 if(!
»achabË_
){

446 
	`j¦_log
(
JSL_DBG_1
, "rpcss::got_pdu:‚ot„eachable\n");

447  
Œue
;

450 
djob_t
 *
j
 = 
Ãw
 
	`djob_t
(
c
, 
b
, 
sz
);

451 
c
->
	`šüef
();

452 
boŞ
 
succ
 = 
di¥©chpoŞ_
->
	`addObjJob
(
this
, &
½cs
::
di¥©ch
, 
j
);

453 if(!
succ
 || !
»achabË_
){

454 
c
->
	`deüef
();

455 
d–‘e
 
j
;

457  
succ
;

458 
	}
}

461 
	g½cs
::
	$»g1
(
´oc
, 
hªdËr
 *
h
)

463 
ScİedLock
 
	`¶
(&
´ocs_m_
);

464 
	`VERIFY
(
´ocs_
.
	`couÁ
(
´oc
) == 0);

465 
´ocs_
[
´oc
] = 
h
;

466 
	`VERIFY
(
´ocs_
.
	`couÁ
(
´oc
) >= 1);

467 
	}
}

470 
	g½cs
::
	$upd©e¡©
(
´oc
)

472 
ScİedLock
 
	`ş
(&
couÁ_m_
);

473 
couÁs_
[
´oc
]++;

474 
cu¼_couÁs_
--;

475 if(
cu¼_couÁs_
 == 0){

476 
¡d
::
m­
<, >::
™”©Ü
 
i
;

477 
	`´štf
("RPC STATS: ");

478 
i
 = 
couÁs_
.
	`begš
(); i !ğcouÁs_.
	`’d
(); i++){

479 
	`´štf
("%x:%d ", 
i
->
fœ¡
, i->
£cÚd
);

481 
	`´štf
("\n");

483 
ScİedLock
 
	`rwl
(&
»¶y_wšdow_m_
);

484 
¡d
::
m­
<,¡d::
li¡
<
»¶y_t
> >::
™”©Ü
 
şt
;

486 
tÙ®»p
 = 0, 
max»p
 = 0;

487 
şt
 = 
»¶y_wšdow_
.
	`begš
(); cÉ !ğ»¶y_wšdow_.
	`’d
(); clt++){

488 
tÙ®»p
 +ğ
şt
->
£cÚd
.
	`size
();

489 if(
şt
->
£cÚd
.
	`size
(è> 
max»p
)

490 
max»p
 = 
şt
->
£cÚd
.
	`size
();

492 
	`j¦_log
(
JSL_DBG_1
, "REPLY WINDOW: clients %dotal„eply %d max…er client %d\n",

493 (è
»¶y_wšdow_
.
	`size
(), 
tÙ®»p
, 
max»p
);

494 
cu¼_couÁs_
 = 
couÁšg_
;

496 
	}
}

499 
	g½cs
::
	$di¥©ch
(
djob_t
 *
j
)

501 
cÚÃùiÚ
 *
c
 = 
j
->
cÚn
;

502 
unm¬sh®l
 
	`»q
(
j
->
buf
, j->
sz
);

503 
d–‘e
 
j
;

505 
»q_h—d”
 
h
;

506 
»q
.
	`uÅack_»q_h—d”
(&
h
);

507 
´oc
 = 
h
.proc;

509 if(!
»q
.
	`ok
()){

510 
	`j¦_log
(
JSL_DBG_1
, "rpcs:dispatch unmarshall header failed!!!\n");

511 
c
->
	`deüef
();

515 
	`j¦_log
(
JSL_DBG_2
,

517 
h
.
xid
, 
´oc
, h.
xid_»p
, h.
şt_nÚû
, h.
¤v_nÚû
);

519 
m¬sh®l
 
»p
;

520 
»¶y_h—d”
 
	`rh
(
h
.
xid
,0);

523 if(
h
.
¤v_nÚû
 !ğ0 && h.¤v_nÚû !ğ
nÚû_
){

524 
	`j¦_log
(
JSL_DBG_2
,

526 
h
.
¤v_nÚû
, 
nÚû_
, h.
´oc
);

527 
rh
.
»t
 = 
½c_cÚ¡
::
Şd¤v_çu»
;

528 
»p
.
	`·ck_»¶y_h—d”
(
rh
);

529 
c
->
	`£nd
(
»p
.
	`c¡r
(),»p.
	`size
());

533 
hªdËr
 *
f
;

536 
ScİedLock
 
	`¶
(&
´ocs_m_
);

537 if(
´ocs_
.
	`couÁ
(
´oc
) < 1){

538 
	`årštf
(
¡d”r
, "rpcs::dispatch: unknown…roc %x.\n",

539 
´oc
);

540 
c
->
	`deüef
();

541 
	`VERIFY
(0);

545 
f
 = 
´ocs_
[
´oc
];

548 
½cs
::
½c¡©e_t
 
¡©
;

549 *
b1
;

550 
sz1
;

552 if(
h
.
şt_nÚû
){

555 
ScİedLock
 
	`rwl
(&
»¶y_wšdow_m_
);

557 if(
»¶y_wšdow_
.
	`fšd
(
h
.
şt_nÚû
è=ğ»¶y_wšdow_.
	`’d
()){

558 
	`VERIFY
 (
»¶y_wšdow_
[
h
.
şt_nÚû
].
	`size
() == 0);

559 
	`j¦_log
(
JSL_DBG_2
,

561 
h
.
şt_nÚû
, h.
xid
, 
c
->
	`chªno
(), ()
»¶y_wšdow_
.
	`size
());

567 
ScİedLock
 
	`rwl
(&
cÚss_m_
);

568 if(
cÚns_
.
	`fšd
(
h
.
şt_nÚû
è=ğcÚns_.
	`’d
()){

569 
c
->
	`šüef
();

570 
cÚns_
[
h
.
şt_nÚû
] = 
c
;

571 } if(
cÚns_
[
h
.
şt_nÚû
]->
	`com·»
(
c
) < 0){

572 
cÚns_
[
h
.
şt_nÚû
]->
	`deüef
();

573 
c
->
	`šüef
();

574 
cÚns_
[
h
.
şt_nÚû
] = 
c
;

578 
¡©
 = 
	`checkdu¶iÿ‹_ªd_upd©e
(
h
.
şt_nÚû
, h.
xid
,

579 
h
.
xid_»p
, &
b1
, &
sz1
);

582 
¡©
 = 
NEW
;

585 
¡©
){

586 
NEW
:

587 if(
couÁšg_
){

588 
	`upd©e¡©
(
´oc
);

591 
rh
.
»t
 = 
f
->
	`â
(
»q
, 
»p
);

592 ià(
rh
.
»t
 =ğ
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
) {

593 
	`årštf
(
¡d”r
, "rpcs::dispatch: failedo"

596 "y³ oà¬gum’ts.\n", 
´oc
);

597 
	`VERIFY
(0);

599 
	`VERIFY
(
rh
.
»t
 >= 0);

601 
»p
.
	`·ck_»¶y_h—d”
(
rh
);

602 
»p
.
	`ke_buf
(&
b1
,&
sz1
);

604 
	`j¦_log
(
JSL_DBG_2
,

606 
sz1
, 
h
.
xid
, 
´oc
, 
rh
.
»t
, h.
şt_nÚû
);

608 if(
h
.
şt_nÚû
 > 0){

610 
	`add_»¶y
(
h
.
şt_nÚû
, h.
xid
, 
b1
, 
sz1
);

615 
ScİedLock
 
	`rwl
(&
cÚss_m_
);

616 if(
c
->
	`isd—d
(è&& c !ğ
cÚns_
[
h
.
şt_nÚû
]){

617 
c
->
	`deüef
();

618 
c
 = 
cÚns_
[
h
.
şt_nÚû
];

619 
c
->
	`šüef
();

623 
c
->
	`£nd
(
b1
, 
sz1
);

624 if(
h
.
şt_nÚû
 == 0){

626 
	`ä“
(
b1
);

629 
INPROGRESS
:

631 
DONE
:

632 
c
->
	`£nd
(
b1
, 
sz1
);

634 
FORGOTTEN
:

635 
	`j¦_log
(
JSL_DBG_2
, "rpcs::dispatch: very old„equest %u from %u\n",

636 
h
.
xid
, h.
şt_nÚû
);

637 
rh
.
»t
 = 
½c_cÚ¡
::
©mo¡Úû_çu»
;

638 
»p
.
	`·ck_»¶y_h—d”
(
rh
);

639 
c
->
	`£nd
(
»p
.
	`c¡r
(),»p.
	`size
());

642 
c
->
	`deüef
();

643 
	}
}

659 
	g½cs
::
½c¡©e_t


660 
½cs
::
	$checkdu¶iÿ‹_ªd_upd©e
(
şt_nÚû
, 
xid
,

661 
xid_»p
, **
b
, *
sz
)

663 
ScİedLock
 
	`rwl
(&
»¶y_wšdow_m_
);

666  
NEW
;

667 
	}
}

675 
	g½cs
::
	$add_»¶y
(
şt_nÚû
, 
xid
,

676 *
b
, 
sz
)

678 
ScİedLock
 
	`rwl
(&
»¶y_wšdow_m_
);

680 
	}
}

683 
	g½cs
::
	$ä“_»¶y_wšdow
()

685 
¡d
::
m­
<,¡d::
li¡
<
»¶y_t
> >::
™”©Ü
 
şt
;

686 
¡d
::
li¡
<
»¶y_t
>::
™”©Ü
 
™
;

688 
ScİedLock
 
	`rwl
(&
»¶y_wšdow_m_
);

689 
şt
 = 
»¶y_wšdow_
.
	`begš
(); cÉ !ğ»¶y_wšdow_.
	`’d
(); clt++){

690 
™
 = 
şt
->
£cÚd
.
	`begš
(); iˆ!ğşt->£cÚd.
	`’d
(); it++){

691 
	`ä“
((*
™
).
buf
);

693 
şt
->
£cÚd
.
	`ş—r
();

695 
»¶y_wšdow_
.
	`ş—r
();

696 
	}
}

700 
	g½cs
::
	$½cbšd
(
a
, &
r
)

702 
	`j¦_log
(
JSL_DBG_2
, "½cs::½cbšd c®Ëd„‘uº‚Úû %u\n", 
nÚû_
);

703 
r
 = 
nÚû_
;

705 
	}
}

708 
	gm¬sh®l
::
	$¿wby‹
(
x
)

710 if(
_šd
 >ğ
_ÿ·
){

711 
_ÿ·
 *= 2;

712 
	`VERIFY
 (
_buf
 !ğ
NULL
);

713 
_buf
 = (*)
	`»®loc
(_buf, 
_ÿ·
);

714 
	`VERIFY
(
_buf
);

716 
_buf
[
_šd
++] = 
x
;

717 
	}
}

720 
	gm¬sh®l
::
	$¿wby‹s
(cÚ¡ *
p
, 
n
)

722 if((
_šd
+
n
è> 
_ÿ·
){

723 
_ÿ·
 = _ÿ· > 
n
? 2*_capa:(_capa+n);

724 
	`VERIFY
 (
_buf
 !ğ
NULL
);

725 
_buf
 = (*)
	`»®loc
(_buf, 
_ÿ·
);

726 
	`VERIFY
(
_buf
);

728 
	`memıy
(
_buf
+
_šd
, 
p
, 
n
);

729 
_šd
 +ğ
n
;

730 
	}
}

732 
	gm¬sh®l
 &

733 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
boŞ
 
	gx
)

735 
	gm
.
¿wby‹
(
x
);

736  
	gm
;

739 
	gm¬sh®l
 &

740 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

742 
	gm
.
¿wby‹
(
x
);

743  
	gm
;

746 
	gm¬sh®l
 &

747 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

749 
	gm
 << (è
	gx
;

750  
	gm
;

754 
	gm¬sh®l
 &

755 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

757 
	gm
.
¿wby‹
((
x
 >> 8) & 0xff);

758 
	gm
.
¿wby‹
(
x
 & 0xff);

759  
	gm
;

762 
	gm¬sh®l
 &

763 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

765 
	gm
 << (è
	gx
;

766  
	gm
;

769 
	gm¬sh®l
 &

770 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

773 
	gm
.
¿wby‹
((
x
 >> 24) & 0xff);

774 
	gm
.
¿wby‹
((
x
 >> 16) & 0xff);

775 
	gm
.
¿wby‹
((
x
 >> 8) & 0xff);

776 
	gm
.
¿wby‹
(
x
 & 0xff);

777  
	gm
;

780 
	gm¬sh®l
 &

781 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

783 
	gm
 << (è
	gx
;

784  
	gm
;

787 
	gm¬sh®l
 &

788 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, cÚ¡ 
	g¡d
::
¡ršg
 &
s
)

790 
m
 << (è
s
.
size
();

791 
	gm
.
¿wby‹s
(
s
.
d©a
(), s.
size
());

792  
	gm
;

795 
	gm¬sh®l
 &

796 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	gx
)

798 
	gm
 << (è(
	gx
 >> 32);

799 
	gm
 << (è
	gx
;

800  
	gm
;

804 
	gm¬sh®l
::
	$·ck
(
x
)

806 
	`¿wby‹
((
x
 >> 24) & 0xff);

807 
	`¿wby‹
((
x
 >> 16) & 0xff);

808 
	`¿wby‹
((
x
 >> 8) & 0xff);

809 
	`¿wby‹
(
x
 & 0xff);

810 
	}
}

813 
	gunm¬sh®l
::
	$uÅack
(*
x
)

815 (*
x
èğ(
	`¿wby‹
() & 0xff) << 24;

816 (*
x
è|ğ(
	`¿wby‹
() & 0xff) << 16;

817 (*
x
è|ğ(
	`¿wby‹
() & 0xff) << 8;

818 (*
x
è|ğ
	`¿wby‹
() & 0xff;

819 
	}
}

823 
	gunm¬sh®l
::
	$ke_š
(
unm¬sh®l
 &
ªÙh”
)

825 if(
_buf
)

826 
	`ä“
(
_buf
);

827 
ªÙh”
.
	`ke_buf
(&
_buf
, &
_sz
);

828 
_šd
 = 
RPC_HEADER_SZ
;

829 
_ok
 = 
_sz
 >ğ
RPC_HEADER_SZ
?
Œue
:
çl£
;

830 
	}
}

832 
boŞ


833 
	gunm¬sh®l
::
	$okdÚe
()

835 if(
	`ok
(è&& 
_šd
 =ğ
_sz
){

836  
Œue
;

838  
çl£
;

840 
	}
}

843 
	gunm¬sh®l
::
	$¿wby‹
()

845 
c
 = 0;

846 if(
_šd
 >ğ
_sz
)

847 
_ok
 = 
çl£
;

849 
c
 = 
_buf
[
_šd
++];

850  
c
;

851 
	}
}

853 
	gunm¬sh®l
 &

854 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	gboŞ
 &
	gx
)

856 
	gx
 = (
boŞ
è
u
.
¿wby‹
() ;

857  
	gu
;

860 
	gunm¬sh®l
 &

861 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

863 
	gx
 = (è
u
.
¿wby‹
() ;

864  
	gu
;

867 
	gunm¬sh®l
 &

868 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

870 
	gx
 = (è
u
.
¿wby‹
();

871  
	gu
;

875 
	gunm¬sh®l
 &

876 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

878 
	gx
 = (
u
.
¿wby‹
() & 0xff) << 8;

879 
	gx
 |ğ
u
.
¿wby‹
() & 0xff;

880  
	gu
;

883 
	gunm¬sh®l
 &

884 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

886 
	gx
 = (
u
.
¿wby‹
() & 0xff) << 8;

887 
	gx
 |ğ
u
.
¿wby‹
() & 0xff;

888  
	gu
;

891 
	gunm¬sh®l
 &

892 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

894 
	gx
 = (
u
.
¿wby‹
() & 0xff) << 24;

895 
	gx
 |ğ(
u
.
¿wby‹
() & 0xff) << 16;

896 
	gx
 |ğ(
u
.
¿wby‹
() & 0xff) << 8;

897 
	gx
 |ğ
u
.
¿wby‹
() & 0xff;

898  
	gu
;

901 
	gunm¬sh®l
 &

902 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

904 
	gx
 = (
u
.
¿wby‹
() & 0xff) << 24;

905 
	gx
 |ğ(
u
.
¿wby‹
() & 0xff) << 16;

906 
	gx
 |ğ(
u
.
¿wby‹
() & 0xff) << 8;

907 
	gx
 |ğ
u
.
¿wby‹
() & 0xff;

908  
	gu
;

911 
	gunm¬sh®l
 &

912 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, &
	gx
)

914 
	gh
, 
	gl
;

915 
	gu
 >> 
	gh
;

916 
	gu
 >> 
	gl
;

917 
	gx
 = 
l
 | ((è
h
 << 32);

918  
	gu
;

921 
	gunm¬sh®l
 &

922 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	g¡d
::
¡ršg
 &
s
)

924 
sz
;

925 
	gu
 >> 
	gsz
;

926 if(
	gu
.
ok
())

927 
	gu
.
¿wby‹s
(
s
, 
sz
);

928  
	gu
;

932 
	gunm¬sh®l
::
	$¿wby‹s
(
¡d
::
¡ršg
 &
ss
, 
n
)

934 if((
_šd
+
n
è> ()
_sz
){

935 
_ok
 = 
çl£
;

937 
¡d
::
¡ršg
 
tmps
 = std::
	`¡ršg
(
_buf
+
_šd
, 
n
);

938 
	`sw­
(
ss
, 
tmps
);

939 
	`VERIFY
(
ss
.
	`size
(è=ğ
n
);

940 
_šd
 +ğ
n
;

942 
	}
}

944 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gsockaddr_š
 &
	ga
, cÚ¡ sockaddr_š &
	gb
){

945  ((
	ga
.
	gsš_addr
.
	gs_addr
 < 
	gb
.sin_addr.s_addr) ||

946 ((
	ga
.
	gsš_addr
.
	gs_addr
 =ğ
b
.
sš_addr
.
s_addr
) &&

947 ((
a
.
sš_pÜt
 < 
b
.sin_port))));

952 
	$make_sockaddr
(cÚ¡ *
ho¡ªdpÜt
, 
sockaddr_š
 *
d¡
){

954 
ho¡
[200];

955 cÚ¡ *
loÿlho¡
 = "127.0.0.1";

956 cÚ¡ *
pÜt
 = 
	`šdex
(
ho¡ªdpÜt
, ':');

957 if(
pÜt
 =ğ
NULL
){

958 
	`memıy
(
ho¡
, 
loÿlho¡
, 
	`¡¾’
(localhost)+1);

959 
pÜt
 = 
ho¡ªdpÜt
;

961 
	`memıy
(
ho¡
, 
ho¡ªdpÜt
, 
pÜt
-hostandport);

962 
ho¡
[
pÜt
-
ho¡ªdpÜt
] = '\0';

963 
pÜt
++;

966 
	`make_sockaddr
(
ho¡
, 
pÜt
, 
d¡
);

968 
	}
}

971 
	$make_sockaddr
(cÚ¡ *
ho¡
, cÚ¡ *
pÜt
, 
sockaddr_š
 *
d¡
){

973 
š_addr_t
 
a
;

975 
	`bz”o
(
d¡
, (*dst));

976 
d¡
->
sš_çmy
 = 
AF_INET
;

978 
a
 = 
	`š‘_addr
(
ho¡
);

979 if(
a
 !ğ
INADDR_NONE
){

980 
d¡
->
sš_addr
.
s_addr
 = 
a
;

982 
ho¡’t
 *
hp
 = 
	`g‘ho¡byÇme
(
ho¡
);

983 if(
hp
 =ğ0 || hp->
h_Ëngth
 != 4){

984 
	`årštf
(
¡d”r
, "ÿÂÙ fšd ho¡‚am%s\n", 
ho¡
);

985 
	`ex™
(1);

987 
d¡
->
sš_addr
.
s_addr
 = ((
š_addr
 *)(
hp
->
h_addr
))->s_addr;

989 
d¡
->
sš_pÜt
 = 
	`htÚs
(
	`©oi
(
pÜt
));

990 
	}
}

993 
	$cmp_time¥ec
(cÚ¡ 
time¥ec
 &
a
, cÚ¡ time¥eø&
b
)

995 if(
a
.
tv_£c
 > 
b
.tv_sec)

997 if(
a
.
tv_£c
 < 
b
.tv_sec)

1000 if(
a
.
tv_n£c
 > 
b
.tv_nsec)

1002 if(
a
.
tv_n£c
 < 
b
.tv_nsec)

1007 
	}
}

1010 
	$add_time¥ec
(cÚ¡ 
time¥ec
 &
a
, 
b
, time¥eø*
»suÉ
)

1013 
»suÉ
->
tv_£c
 = 
a
.tv_£ø+ 
b
/1000;

1014 
»suÉ
->
tv_n£c
 = 
a
.tv_n£ø+ (
b
 % 1000) * 1000000;

1015 
	`VERIFY
(
»suÉ
->
tv_n£c
 >= 0);

1016 
»suÉ
->
tv_n£c
 > 1000000000){

1017 
»suÉ
->
tv_£c
++;

1018 
»suÉ
->
tv_n£c
-=1000000000;

1020 
	}
}

1023 
	$diff_time¥ec
(cÚ¡ 
time¥ec
 &
’d
, cÚ¡ time¥eø&
¡¬t
)

1025 
diff
 = (
’d
.
tv_£c
 > 
¡¬t
.tv_sec)?(end.tv_sec-start.tv_sec)*1000:0;

1026 
	`VERIFY
(
diff
 || 
’d
.
tv_£c
 =ğ
¡¬t
.tv_sec);

1027 if(
’d
.
tv_n£c
 > 
¡¬t
.tv_nsec){

1028 
diff
 +ğ(
’d
.
tv_n£c
-
¡¬t
.tv_nsec)/1000000;

1030 
diff
 -ğ(
¡¬t
.
tv_n£c
-
’d
.tv_nsec)/1000000;

1032  
diff
;

1033 
	}
}

	@rpc/rpc.h

1 #iâdeà
½c_h


2 
	#½c_h


	)

4 
	~<sys/sock‘.h
>

5 
	~<Ãtš‘/š.h
>

6 
	~<li¡
>

7 
	~<m­
>

8 
	~<¡dio.h
>

10 
	~"thr_poŞ.h
"

11 
	~"m¬sh®l.h
"

12 
	~"cÚÃùiÚ.h
"

14 #ifdeà
DMALLOC


15 
	~"dm®loc.h
"

18 şas 
	c½c_cÚ¡
 {

19 
	mpublic
:

20 cÚ¡ 
bšd
 = 1;

21 cÚ¡ 
	mtimeout_çu»
 = -1;

22 cÚ¡ 
	munm¬sh®_¬gs_çu»
 = -2;

23 cÚ¡ 
	munm¬sh®_»¶y_çu»
 = -3;

24 cÚ¡ 
	m©mo¡Úû_çu»
 = -4;

25 cÚ¡ 
	mŞd¤v_çu»
 = -5;

26 cÚ¡ 
	mbšd_çu»
 = -6;

27 cÚ¡ 
	mÿnûl_çu»
 = -7;

33 şas 
	c½cc
 : 
public
 
chªmgr
 {

35 
´iv©e
:

38 
	sÿÎ”
 {

39 
ÿÎ”
(
xxid
, 
unm¬sh®l
 *
un
);

40 ~
ÿÎ”
();

42 
	mxid
;

43 
unm¬sh®l
 *
	mun
;

44 
	mšŒ‘
;

45 
boŞ
 
	mdÚe
;

46 
±h»ad_mu‹x_t
 
	mm
;

47 
±h»ad_cÚd_t
 
	mc
;

50 
g‘_»fcÚn
(
cÚÃùiÚ
 **
ch
);

51 
upd©e_xid_»p
(
xid
);

54 
sockaddr_š
 
	gd¡_
;

55 
	gşt_nÚû_
;

56 
	g¤v_nÚû_
;

57 
boŞ
 
	gbšd_dÚe_
;

58 
	gxid_
;

59 
	glossy‹¡_
;

60 
boŞ
 
	g»Œªs_
;

61 
boŞ
 
	g»achabË_
;

63 
cÚÃùiÚ
 *
	gchª_
;

65 
±h»ad_mu‹x_t
 
	gm_
;

66 
±h»ad_mu‹x_t
 
	gchª_m_
;

68 
boŞ
 
	gde¡roy_wa™_
;

69 
±h»ad_cÚd_t
 
	gde¡roy_wa™_c_
;

71 
	g¡d
::
m­
<, 
	gÿÎ”
 *> 
	gÿÎs_
;

72 
	g¡d
::
li¡
<> 
xid_»p_wšdow_
;

74 
	s»que¡
 {

75 
»que¡
(è{ 
ş—r
(); }

76 
ş—r
(è{ 
	gbuf
.ş—r(); 
	gxid
 = -1; }

77 
boŞ
 
isv®id
(è{  
	gxid
 != -1; }

78 
	g¡d
::
¡ršg
 
buf
;

79 
	gxid
;

81 
»que¡
 
	gdup_»q_
;

82 
	gxid_»p_dÚe_
;

83 
	gpublic
:

85 
½cc
(
sockaddr_š
 
d
, 
boŞ
 
»Œªs
=
Œue
);

86 ~
½cc
();

88 
	sTO
 {

89 
	gto
;

91 cÚ¡ 
TO
 
	gto_max
;

92 cÚ¡ 
TO
 
	gto_mš
;

93 
TO
 
	$to
(
x
è{ 
TO
 
t
;.
to
 = x; ;
	}
}

95 
	$id
(è{  
şt_nÚû_
; 
	}
}

97 
bšd
(
TO
 
to
 = 
to_max
);

99 
	$£t_»achabË
(
boŞ
 
r
è{ 
»achabË_
 =„; 
	}
}

101 
ÿnûl
();

103 
	$i¦ossy
(è{  
lossy‹¡_
 > 0; 
	}
}

105 
ÿÎ1
(
´oc
,

106 
m¬sh®l
 &
»q
, 
unm¬sh®l
 &
»p
, 
TO
 
to
);

108 
boŞ
 
gÙ_pdu
(
cÚÃùiÚ
 *
c
, *
b
, 
sz
);

111 
	g‹m¶©e
<
şass
 
	gR
>

112 
ÿÎ_m
(
´oc
, 
m¬sh®l
 &
»q
, 
R
 & 
r
, 
TO
 
to
);

114 
	g‹m¶©e
<
şass
 
	gR
>

115 
ÿÎ
(
´oc
, 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

116 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
>

117 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

118 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
>

119 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
, 
R
 & 
r
,

120 
TO
 
to
 = 
to_max
);

121 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

122 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
, cÚ¡ 
A3
 & 
a3
,

123 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

124 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

125 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
, cÚ¡ 
A3
 & 
a3
,

126 cÚ¡ 
A4
 & 
a4
, 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

127 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

128 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
, cÚ¡ 
A3
 & 
a3
,

129 cÚ¡ 
A4
 & 
a4
, cÚ¡ 
A5
 & 
a5
, 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

130 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
,

131 
şass
 
	gA6
>

132 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
, cÚ¡ 
A3
 & 
a3
,

133 cÚ¡ 
A4
 & 
a4
, cÚ¡ 
A5
 & 
a5
, cÚ¡ 
A6
 & 
a6
,

134 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

135 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
,

136 
şass
 
	gA6
, cÏs 
	gA7
>

137 
ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
, cÚ¡ 
A3
 & 
a3
,

138 cÚ¡ 
A4
 & 
a4
, cÚ¡ 
A5
 & 
a5
, cÚ¡ 
A6
 &
a6
, cÚ¡ 
A7
 &
a7
,

139 
R
 & 
r
, 
TO
 
to
 = 
to_max
);

143 
	g‹m¶©e
<
şass
 
	gR
> 

144 
	g½cc
::
	$ÿÎ_m
(
´oc
, 
m¬sh®l
 &
»q
, 
R
 & 
r
, 
TO
 
to
)

146 
unm¬sh®l
 
u
;

147 
šŒ‘
 = 
	`ÿÎ1
(
´oc
, 
»q
, 
u
, 
to
);

148 ià(
šŒ‘
 < 0)  intret;

149 
u
 >> 
r
;

150 if(
u
.
	`okdÚe
(è!ğ
Œue
) {

151 
	`årštf
(
¡d”r
, "rpcc::call_m: failedo unmarshallhe„eply."

153 "ty³.\n", 
´oc
);

154 
	`VERIFY
(0);

155  
½c_cÚ¡
::
unm¬sh®_»¶y_çu»
;

157  
šŒ‘
;

158 
	}
}

160 
	g‹m¶©e
<
şass
 
	gR
> 

161 
	g½cc
::
	$ÿÎ
(
´oc
, 
R
 & 
r
, 
TO
 
to
)

163 
m¬sh®l
 
m
;

164  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

165 
	}
}

167 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
> 

168 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, 
R
 & 
r
, 
TO
 
to
)

170 
m¬sh®l
 
m
;

171 
m
 << 
a1
;

172  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

173 
	}
}

175 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
> 

176 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
,

177 
R
 & 
r
, 
TO
 
to
)

179 
m¬sh®l
 
m
;

180 
m
 << 
a1
;

181 
m
 << 
a2
;

182  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

183 
	}
}

185 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
> 

186 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
,

187 cÚ¡ 
A3
 & 
a3
, 
R
 & 
r
, 
TO
 
to
)

189 
m¬sh®l
 
m
;

190 
m
 << 
a1
;

191 
m
 << 
a2
;

192 
m
 << 
a3
;

193  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

194 
	}
}

196 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
> 

197 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
,

198 cÚ¡ 
A3
 & 
a3
, cÚ¡ 
A4
 & 
a4
, 
R
 & 
r
, 
TO
 
to
)

200 
m¬sh®l
 
m
;

201 
m
 << 
a1
;

202 
m
 << 
a2
;

203 
m
 << 
a3
;

204 
m
 << 
a4
;

205  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

206 
	}
}

208 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
> 

209 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
,

210 cÚ¡ 
A3
 & 
a3
, cÚ¡ 
A4
 & 
a4
, cÚ¡ 
A5
 & 
a5
, 
R
 & 
r
, 
TO
 
to
)

212 
m¬sh®l
 
m
;

213 
m
 << 
a1
;

214 
m
 << 
a2
;

215 
m
 << 
a3
;

216 
m
 << 
a4
;

217 
m
 << 
a5
;

218  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

219 
	}
}

221 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
,

222 
şass
 
	gA6
> 

223 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
,

224 cÚ¡ 
A3
 & 
a3
, cÚ¡ 
A4
 & 
a4
, cÚ¡ 
A5
 & 
a5
,

225 cÚ¡ 
A6
 & 
a6
, 
R
 & 
r
, 
TO
 
to
)

227 
m¬sh®l
 
m
;

228 
m
 << 
a1
;

229 
m
 << 
a2
;

230 
m
 << 
a3
;

231 
m
 << 
a4
;

232 
m
 << 
a5
;

233 
m
 << 
a6
;

234  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

235 
	}
}

237 
	g‹m¶©e
<
şass
 
	gR
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
,

238 
şass
 
	gA6
, cÏs 
	gA7
> 

239 
	g½cc
::
	$ÿÎ
(
´oc
, cÚ¡ 
A1
 & 
a1
, cÚ¡ 
A2
 & 
a2
,

240 cÚ¡ 
A3
 & 
a3
, cÚ¡ 
A4
 & 
a4
, cÚ¡ 
A5
 & 
a5
,

241 cÚ¡ 
A6
 & 
a6
, cÚ¡ 
A7
 & 
a7
,

242 
R
 & 
r
, 
TO
 
to
)

244 
m¬sh®l
 
m
;

245 
m
 << 
a1
;

246 
m
 << 
a2
;

247 
m
 << 
a3
;

248 
m
 << 
a4
;

249 
m
 << 
a5
;

250 
m
 << 
a6
;

251 
m
 << 
a7
;

252  
	`ÿÎ_m
(
´oc
, 
m
, 
r
, 
to
);

253 
	}
}

255 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gsockaddr_š
 &
	ga
, cÚ¡ sockaddr_š &
	gb
);

257 şas 
	chªdËr
 {

258 
	mpublic
:

259 
	$hªdËr
() { }

260 
vœtu®
 ~
	$hªdËr
(è{ 
	}
}

261 
vœtu®
 
â
(
unm¬sh®l
 &, 
m¬sh®l
 &) = 0;

266 şas 
	c½cs
 : 
public
 
chªmgr
 {

269 
NEW
,

270 
	mINPROGRESS
,

271 
	mDONE
,

272 
	mFORGOTTEN
,

273 } 
	t½c¡©e_t
;

275 
	g´iv©e
:

281 
	s»¶y_t
 {

282 
»¶y_t
 (
_xid
) {

283 
xid
 = 
_xid
;

284 
	gcb_´e£Á
 = 
çl£
;

285 
	gbuf
 = 
NULL
;

286 
	gsz
 = 0;

288 
	gxid
;

289 
boŞ
 
	gcb_´e£Á
;

290 *
	gbuf
;

291 
	gsz
;

294 
	gpÜt_
;

295 
	gnÚû_
;

300 
	g¡d
::
m­
<, std::
li¡
<
»¶y_t
> > 
»¶y_wšdow_
;

302 
ä“_»¶y_wšdow
();

303 
add_»¶y
(
şt_nÚû
, 
xid
, *
b
, 
sz
);

305 
½c¡©e_t
 
checkdu¶iÿ‹_ªd_upd©e
(
şt_nÚû
,

306 
xid
, 
»p_xid
,

307 **
b
, *
sz
);

309 
upd©e¡©
(
´oc
);

312 
	g¡d
::
m­
<, 
	gcÚÃùiÚ
 *> 
	gcÚns_
;

315 cÚ¡ 
	gcouÁšg_
;

316 
	gcu¼_couÁs_
;

317 
	g¡d
::
m­
<, > 
	gcouÁs_
;

319 
	glossy‹¡_
;

320 
boŞ
 
	g»achabË_
;

323 
	g¡d
::
m­
<, 
	ghªdËr
 *> 
	g´ocs_
;

325 
±h»ad_mu‹x_t
 
	g´ocs_m_
;

326 
±h»ad_mu‹x_t
 
	gcouÁ_m_
;

327 
±h»ad_mu‹x_t
 
	g»¶y_wšdow_m_
;

328 
±h»ad_mu‹x_t
 
	gcÚss_m_
;

331 
	g´Ùeùed
:

333 
	sdjob_t
 {

334 
djob_t
 (
cÚÃùiÚ
 *
c
, *
b
, 
bsz
):
buf
(b),
sz
(bsz),
cÚn
(c) {}

335 *
	gbuf
;

336 
	gsz
;

337 
cÚÃùiÚ
 *
	gcÚn
;

339 
di¥©ch
(
djob_t
 *);

342 
»g1
(
´oc
, 
hªdËr
 *);

344 
ThrPoŞ
* 
	gdi¥©chpoŞ_
;

345 
tıscÚn
* 
	gli¡’”_
;

347 
	gpublic
:

348 
½cs
(
pÜt
, 
couÁs
=0);

349 ~
½cs
();

352 
½cbšd
(
a
, &
r
);

354 
	$£t_»achabË
(
boŞ
 
r
è{ 
»achabË_
 =„; 
	}
}

356 
boŞ
 
gÙ_pdu
(
cÚÃùiÚ
 *
c
, *
b
, 
sz
);

359 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gR
>

360 
»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, 
R
 & 
r
));

361 
‹m¶©e
<
şass
 
S
, cÏs 
A1
, cÏs 
A2
, cÏs 
R
>

362 
	`»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
,

363 
R
 & 
r
));

364 
‹m¶©e
<
şass
 
S
, cÏs 
A1
, cÏs 
A2
, cÏs 
A3
, cÏs 
R
>

365 
	`»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
, cÚ¡ 
A2
,

366 cÚ¡ 
A3
, 
R
 & 
r
));

367 
‹m¶©e
<
şass
 
S
, cÏs 
A1
, cÏs 
A2
, cÏs 
A3
, cÏs 
A4
, cÏs 
R
>

368 
	`»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
, cÚ¡ 
A2
,

369 cÚ¡ 
A3
, cÚ¡ 
A4
, 
R
 & 
r
));

370 
‹m¶©e
<
şass
 
S
, cÏs 
A1
, cÏs 
A2
, cÏs 
A3
, cÏs 
A4
, cÏs 
A5
, cÏs 
R
>

371 
	`»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
, cÚ¡ 
A2
,

372 cÚ¡ 
A3
, cÚ¡ 
A4
, cÚ¡ 
A5
,

373 
R
 & 
r
));

374 
‹m¶©e
<
şass
 
S
, cÏs 
A1
, cÏs 
A2
, cÏs 
A3
, cÏs 
A4
, cÏs 
A5
, cÏs 
A6
,

375 
şass
 
R
>

376 
	`»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
, cÚ¡ 
A2
,

377 cÚ¡ 
A3
, cÚ¡ 
A4
, cÚ¡ 
A5
,

378 cÚ¡ 
A6
, 
R
 & 
r
));

379 
‹m¶©e
<
şass
 
S
, cÏs 
A1
, cÏs 
A2
, cÏs 
A3
, cÏs 
A4
, cÏs 
A5
, cÏs 
A6
,

380 
şass
 
A7
, cÏs 
R
>

381 
	`»g
(
´oc
, 
S
*, (S::*
m‘h
)(cÚ¡ 
A1
, cÚ¡ 
A2
,

382 cÚ¡ 
A3
, cÚ¡ 
A4
, cÚ¡ 
A5
,

383 cÚ¡ 
A6
, cÚ¡ 
A7
,

384 
R
 & 
r
));

385 
	}
};

387 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gR
> 

388 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, 
R
 & 
r
))

390 şas 
	ch1
 : 
public
 
hªdËr
 {

391 
´iv©e
:

392 
S
 * 
sob
;

393 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, 
R
 & 
r
);

394 
public
:

395 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, 
R
 & 
r
))

396 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

397 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

398 
A1
 
a1
;

399 
R
 
r
;

400 
¬gs
 >> 
a1
;

401 if(!
¬gs
.
	`okdÚe
())

402  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

403 
b
 = (
sob
->*
m‘h
)(
a1
, 
r
);

404 
»t
 << 
r
;

405  
b
;

407 
	}
};

408 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

411 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gR
> 

412 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
,

413 
R
 & 
r
))

415 şas 
	ch1
 : 
public
 
hªdËr
 {

416 
´iv©e
:

417 
S
 * 
sob
;

418 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, 
R
 & 
r
);

419 
public
:

420 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, 
R
 & 
r
))

421 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

422 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

423 
A1
 
a1
;

424 
A2
 
a2
;

425 
R
 
r
;

426 
¬gs
 >> 
a1
;

427 
¬gs
 >> 
a2
;

428 if(!
¬gs
.
	`okdÚe
())

429  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

430 
b
 = (
sob
->*
m‘h
)(
a1
, 
a2
, 
r
);

431 
»t
 << 
r
;

432  
b
;

434 
	}
};

435 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

438 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gR
> 

439 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
,

440 cÚ¡ 
A3
 
a3
, 
R
 & 
r
))

442 şas 
	ch1
 : 
public
 
hªdËr
 {

443 
´iv©e
:

444 
S
 * 
sob
;

445 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
, 
R
 & 
r
);

446 
public
:

447 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
, 
R
 & 
r
))

448 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

449 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

450 
A1
 
a1
;

451 
A2
 
a2
;

452 
A3
 
a3
;

453 
R
 
r
;

454 
¬gs
 >> 
a1
;

455 
¬gs
 >> 
a2
;

456 
¬gs
 >> 
a3
;

457 if(!
¬gs
.
	`okdÚe
())

458  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

459 
b
 = (
sob
->*
m‘h
)(
a1
, 
a2
, 
a3
, 
r
);

460 
»t
 << 
r
;

461  
b
;

463 
	}
};

464 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

467 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gR
> 

468 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
,

469 cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

470 
R
 & 
r
))

472 şas 
	ch1
 : 
public
 
hªdËr
 {

473 
´iv©e
:

474 
S
 * 
sob
;

475 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
, 
R
 & 
r
);

476 
public
:

477 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
,

478 cÚ¡ 
A4
 
a4
, 
R
 & 
r
))

479 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

480 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

481 
A1
 
a1
;

482 
A2
 
a2
;

483 
A3
 
a3
;

484 
A4
 
a4
;

485 
R
 
r
;

486 
¬gs
 >> 
a1
;

487 
¬gs
 >> 
a2
;

488 
¬gs
 >> 
a3
;

489 
¬gs
 >> 
a4
;

490 if(!
¬gs
.
	`okdÚe
())

491  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

492 
b
 = (
sob
->*
m‘h
)(
a1
, 
a2
, 
a3
, 
a4
, 
r
);

493 
»t
 << 
r
;

494  
b
;

496 
	}
};

497 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

500 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gR
> 

501 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
,

502 cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

503 cÚ¡ 
A5
 
a5
, 
R
 & 
r
))

505 şas 
	ch1
 : 
public
 
hªdËr
 {

506 
´iv©e
:

507 
S
 * 
sob
;

508 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

509 cÚ¡ 
A5
 
a5
, 
R
 & 
r
);

510 
public
:

511 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
,

512 cÚ¡ 
A4
 
a4
, cÚ¡ 
A5
 
a5
, 
R
 & 
r
))

513 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

514 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

515 
A1
 
a1
;

516 
A2
 
a2
;

517 
A3
 
a3
;

518 
A4
 
a4
;

519 
A5
 
a5
;

520 
R
 
r
;

521 
¬gs
 >> 
a1
;

522 
¬gs
 >> 
a2
;

523 
¬gs
 >> 
a3
;

524 
¬gs
 >> 
a4
;

525 
¬gs
 >> 
a5
;

526 if(!
¬gs
.
	`okdÚe
())

527  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

528 
b
 = (
sob
->*
m‘h
)(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
r
);

529 
»t
 << 
r
;

530  
b
;

532 
	}
};

533 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

536 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gR
> 

537 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
,

538 cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

539 cÚ¡ 
A5
 
a5
, cÚ¡ 
A6
 
a6
,

540 
R
 & 
r
))

542 şas 
	ch1
 : 
public
 
hªdËr
 {

543 
´iv©e
:

544 
S
 * 
sob
;

545 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

546 cÚ¡ 
A5
 
a5
, cÚ¡ 
A6
 
a6
, 
R
 & 
r
);

547 
public
:

548 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
,

549 cÚ¡ 
A4
 
a4
, cÚ¡ 
A5
 
a5
, cÚ¡ 
A6
 
a6
, 
R
 & 
r
))

550 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

551 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

552 
A1
 
a1
;

553 
A2
 
a2
;

554 
A3
 
a3
;

555 
A4
 
a4
;

556 
A5
 
a5
;

557 
A6
 
a6
;

558 
R
 
r
;

559 
¬gs
 >> 
a1
;

560 
¬gs
 >> 
a2
;

561 
¬gs
 >> 
a3
;

562 
¬gs
 >> 
a4
;

563 
¬gs
 >> 
a5
;

564 
¬gs
 >> 
a6
;

565 if(!
¬gs
.
	`okdÚe
())

566  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

567 
b
 = (
sob
->*
m‘h
)(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
r
);

568 
»t
 << 
r
;

569  
b
;

571 
	}
};

572 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

575 
	g‹m¶©e
<
şass
 
	gS
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
,

576 
şass
 
	gA6
, cÏs 
	gA7
, cÏs 
	gR
> 

577 
	g½cs
::
»g
(
´oc
, 
S
*
sob
, (S::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
,

578 cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

579 cÚ¡ 
A5
 
a5
, cÚ¡ 
A6
 
a6
,

580 cÚ¡ 
A7
 
a7
, 
R
 & 
r
))

582 şas 
	ch1
 : 
public
 
hªdËr
 {

583 
´iv©e
:

584 
S
 * 
sob
;

585 (
S
::*
m‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
, cÚ¡ 
A4
 
a4
,

586 cÚ¡ 
A5
 
a5
, cÚ¡ 
A6
 
a6
, cÚ¡ 
A7
 
a7
, 
R
 & 
r
);

587 
public
:

588 
	`h1
(
S
 *
xsob
, (S::*
xm‘h
)(cÚ¡ 
A1
 
a1
, cÚ¡ 
A2
 
a2
, cÚ¡ 
A3
 
a3
,

589 cÚ¡ 
A4
 
a4
, cÚ¡ 
A5
 
a5
, cÚ¡ 
A6
 
a6
,

590 cÚ¡ 
A7
 
a7
, 
R
 & 
r
))

591 : 
	`sob
(
xsob
), 
	`m‘h
(
xm‘h
) { }

592 
	`â
(
unm¬sh®l
 &
¬gs
, 
m¬sh®l
 &
»t
) {

593 
A1
 
a1
;

594 
A2
 
a2
;

595 
A3
 
a3
;

596 
A4
 
a4
;

597 
A5
 
a5
;

598 
A6
 
a6
;

599 
A7
 
a7
;

600 
R
 
r
;

601 
¬gs
 >> 
a1
;

602 
¬gs
 >> 
a2
;

603 
¬gs
 >> 
a3
;

604 
¬gs
 >> 
a4
;

605 
¬gs
 >> 
a5
;

606 
¬gs
 >> 
a6
;

607 
¬gs
 >> 
a7
;

608 if(!
¬gs
.
	`okdÚe
())

609  
½c_cÚ¡
::
unm¬sh®_¬gs_çu»
;

610 
b
 = (
sob
->*
m‘h
)(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
r
);

611 
»t
 << 
r
;

612  
b
;

614 
	}
};

615 
»g1
(
´oc
, 
Ãw
 
h1
(
sob
, 
m‘h
));

619 
make_sockaddr
(cÚ¡ *
ho¡ªdpÜt
, 
sockaddr_š
 *
d¡
);

620 
make_sockaddr
(cÚ¡ *
ho¡
, cÚ¡ *
pÜt
,

621 
sockaddr_š
 *
d¡
);

623 
cmp_time¥ec
(cÚ¡ 
time¥ec
 &
a
, cÚ¡ time¥eø&
b
);

624 
add_time¥ec
(cÚ¡ 
time¥ec
 &
a
, 
b
, time¥eø*
»suÉ
);

625 
diff_time¥ec
(cÚ¡ 
time¥ec
 &
a
, cÚ¡ time¥eø&
b
);

	@rpc/rpctest.cc

4 
	~"½c.h
"

5 
	~<¬·/š‘.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

8 
	~<¡ršg.h
>

9 
	~<g‘İt.h
>

10 
	~"j¦_log.h
"

11 
	~"g‘time.h
"

12 
	~"Ïng/v”ify.h
"

14 
	#NUM_CL
 2

	)

16 
½cs
 *
	g£rv”
;

17 
½cc
 *
	gş›Ás
[
NUM_CL
];

18 
sockaddr_š
 
	gd¡
;

19 
	gpÜt
;

20 
±h»ad_©Œ_t
 
	g©Œ
;

25 şas 
	c¤v
 {

26 
	mpublic
:

27 
hªdË_22
(cÚ¡ 
¡d
::
¡ršg
 
a
, cÚ¡ std::¡ršg 
b
, std::¡ršg & 
r
);

28 
hªdË_ç¡
(cÚ¡ 
a
, &
r
);

29 
hªdË_¦ow
(cÚ¡ 
a
, &
r
);

30 
hªdË_big»p
(cÚ¡ 
a
, 
¡d
::
¡ršg
 &
r
);

41 
	g¤v
::
	$hªdË_22
(cÚ¡ 
¡d
::
¡ršg
 
a
, std::¡ršg 
b
, std::¡ršg &
r
)

43 
r
 = 
a
 + 
b
;

45 
	}
}

48 
	g¤v
::
	$hªdË_ç¡
(cÚ¡ 
a
, &
r
)

50 
r
 = 
a
 + 1;

52 
	}
}

55 
	g¤v
::
	$hªdË_¦ow
(cÚ¡ 
a
, &
r
)

57 
	`u¦“p
(
	`¿ndom
() % 5000);

58 
r
 = 
a
 + 2;

60 
	}
}

63 
	g¤v
::
	$hªdË_big»p
(cÚ¡ 
Ën
, 
¡d
::
¡ršg
 &
r
)

65 
r
 = 
¡d
::
	`¡ršg
(
Ën
, 'x');

67 
	}
}

69 
¤v
 
	g£rviû
;

71 
	$¡¬t£rv”
()

73 
£rv”
 = 
Ãw
 
	`½cs
(
pÜt
);

74 
£rv”
->
	`»g
(22, &
£rviû
, &
¤v
::
hªdË_22
);

75 
£rv”
->
	`»g
(23, &
£rviû
, &
¤v
::
hªdË_ç¡
);

76 
£rv”
->
	`»g
(24, &
£rviû
, &
¤v
::
hªdË_¦ow
);

77 
£rv”
->
	`»g
(25, &
£rviû
, &
¤v
::
hªdË_big»p
);

78 
	}
}

81 
	$‹¡m¬sh®l
()

83 
m¬sh®l
 
m
;

84 
»q_h—d”
 
	`rh
(1,2,3,4,5);

85 
m
.
	`·ck_»q_h—d”
(
rh
);

86 
	`VERIFY
(
m
.
	`size
()==
RPC_HEADER_SZ
);

87 
i
 = 12345;

88 
l
 = 1223344455L;

89 
¡d
::
¡ršg
 
s
 = std::
	`¡ršg
("hallo....");

90 
m
 << 
i
;

91 
m
 << 
l
;

92 
m
 << 
s
;

94 *
b
;

95 
sz
;

96 
m
.
	`ke_buf
(&
b
,&
sz
);

97 
	`VERIFY
(
sz
 =ğ()(
RPC_HEADER_SZ
+(
i
)+(
l
)+
s
.
	`size
()+()));

99 
unm¬sh®l
 
	`un
(
b
,
sz
);

100 
»q_h—d”
 
rh1
;

101 
un
.
	`uÅack_»q_h—d”
(&
rh1
);

102 
	`VERIFY
(
	`memcmp
(&
rh
,&
rh1
,(rh))==0);

103 
i1
;

104 
l1
;

105 
¡d
::
¡ršg
 
s1
;

106 
un
 >> 
i1
;

107 
un
 >> 
l1
;

108 
un
 >> 
s1
;

109 
	`VERIFY
(
un
.
	`okdÚe
());

110 
	`VERIFY
(
i1
==
i
 && 
l1
==
l
 && 
s1
==
s
);

111 
	}
}

114 
	$ş›Á1
(*
xx
)

118 
which_ş
 = ((è
xx
 ) % 
NUM_CL
;

120 
i
 = 0; i < 100; i++){

121 
¬g
 = (
	`¿ndom
() % 2000);

122 
¡d
::
¡ršg
 
»p
;

123 
»t
 = 
ş›Ás
[
which_ş
]->
	`ÿÎ
(25, 
¬g
, 
»p
);

124 
	`VERIFY
(
»t
 == 0);

125 ià(()
»p
.
	`size
()!=
¬g
) {

126 
	`´štf
("»psizwrÚg %d!=%d\n", ()
»p
.
	`size
(), 
¬g
);

128 
	`VERIFY
(()
»p
.
	`size
(è=ğ
¬g
);

133 
i
 = 0; i < 100; i++){

134 
which
 = (
	`¿ndom
() % 2);

135 
¬g
 = (
	`¿ndom
() % 1000);

136 
»p
;

138 
time¥ec
 
¡¬t
,
’d
;

139 
	`şock_g‘time
(
CLOCK_REALTIME
, &
¡¬t
);

141 
»t
 = 
ş›Ás
[
which_ş
]->
	`ÿÎ
(
which
 ? 23 : 24, 
¬g
, 
»p
);

142 
	`şock_g‘time
(
CLOCK_REALTIME
, &
’d
);

143 
diff
 = 
	`diff_time¥ec
(
’d
, 
¡¬t
);

144 ià(
»t
 != 0)

145 
	`´štf
("%d m hav–­£d!!!\n", 
diff
);

146 
	`VERIFY
(
»t
 == 0);

147 
	`VERIFY
(
»p
 =ğ(
which
 ? 
¬g
+1 :‡rg+2));

151 
	}
}

154 
	$ş›Á2
(*
xx
)

156 
which_ş
 = ((è
xx
 ) % 
NUM_CL
;

158 
time_t
 
t1
;

159 
	`time
(&
t1
);

161 
	`time
(0è- 
t1
 < 10){

162 
¬g
 = (
	`¿ndom
() % 2000);

163 
¡d
::
¡ršg
 
»p
;

164 
»t
 = 
ş›Ás
[
which_ş
]->
	`ÿÎ
(25, 
¬g
, 
»p
);

165 ià(()
»p
.
	`size
()!=
¬g
) {

166 
	`´štf
("ask for %d„eply got %d„et %d\n",

167 
¬g
, ()
»p
.
	`size
(), 
»t
);

169 
	`VERIFY
(()
»p
.
	`size
(è=ğ
¬g
);

172 
	}
}

175 
	$ş›Á3
(*
xx
)

177 
½cc
 *
c
 = (½cø*è
xx
;

179 
i
 = 0; i < 4; i++){

180 
»p
;

181 
»t
 = 
c
->
	`ÿÎ
(24, 
i
, 
»p
, 
½cc
::
	`to
(3000));

182 
	`VERIFY
(
»t
 =ğ
½c_cÚ¡
::
timeout_çu»
 || 
»p
 =ğ
i
+2);

185 
	}
}

189 
	$sim¶e_‹¡s
(
½cc
 *
c
)

191 
	`´štf
("simple_tests\n");

196 
¡d
::
¡ršg
 
»p
;

197 
šŒ‘
 = 
c
->
	`ÿÎ
(22, (
¡d
::
¡ršg
)"h–lo", (¡d::¡ršg)" goodbye", 
»p
);

198 
	`VERIFY
(
šŒ‘
 == 0);

199 
	`VERIFY
(
»p
 == "hello goodbye");

200 
	`´štf
(" -- string concat RPC .. ok\n");

203 
šŒ‘
 = 
c
->
	`ÿÎ
(25, 70000, 
»p
, 
½cc
::
	`to
(200000));

204 
	`VERIFY
(
šŒ‘
 == 0);

205 
	`VERIFY
(
»p
.
	`size
() == 70000);

206 
	`´štf
(" -- small„equest, big„eply .. ok\n");

210 
šŒ‘
 = 
c
->
	`ÿÎ
(22, (
¡d
::
¡ršg
)"ju¡ oÃ", 
»p
);

211 
	`VERIFY
(
šŒ‘
 < 0);

212 
	`´štf
(" --oo few‡rguments .. failed ok\n");

215 
šŒ‘
 = 
c
->
	`ÿÎ
(23, 1001, 1002, 
»p
);

216 
	`VERIFY
(
šŒ‘
 < 0);

217 
	`´štf
(" --oo many‡rguments .. failed ok\n");

220 
wrÚg»p
;

221 
šŒ‘
 = 
c
->
	`ÿÎ
(23, (
¡d
::
¡ršg
)"h–lo", (¡d::¡ršg)" goodbye", 
wrÚg»p
);

222 
	`VERIFY
(
šŒ‘
 < 0);

223 
	`´štf
(" -- wrong„et value size .. failed ok\n");

227 
xx
 = 0;

228 
šŒ‘
 = 
c
->
	`ÿÎ
(23, 77, 
xx
, 
½cc
::
	`to
(3000));

229 
	`VERIFY
(
šŒ‘
 =ğ0 && 
xx
 == 78);

230 
	`´štf
(" --‚o supriousimeout .. ok\n");

234 
¡d
::
¡ršg
 
	`¬g
(1000, 'x');

235 
¡d
::
¡ršg
 
»p
;

236 
c
->
	`ÿÎ
(22, 
¬g
, (
¡d
::
¡ršg
)"x", 
»p
, 
½cc
::
	`to
(3000));

237 
	`VERIFY
(
»p
.
	`size
() == 1001);

238 
	`´štf
(" --‚o supriousimeout .. ok\n");

242 
¡d
::
¡ršg
 
	`big
(1000000, 'x');

243 
šŒ‘
 = 
c
->
	`ÿÎ
(22, 
big
, (
¡d
::
¡ršg
)"z", 
»p
);

244 
	`VERIFY
(
»p
.
	`size
() == 1000001);

245 
	`´štf
(" -- huge 1M„pc„equest .. ok\n");

248 
sockaddr_š
 
nÚ_exi¡’t
;

249 
	`mem£t
(&
nÚ_exi¡’t
, 0, (non_existent));

250 
nÚ_exi¡’t
.
sš_çmy
 = 
AF_INET
;

251 
nÚ_exi¡’t
.
sš_addr
.
s_addr
 = 
	`š‘_addr
("127.0.0.1");

252 
nÚ_exi¡’t
.
sš_pÜt
 = 
	`htÚs
(7661);

253 
½cc
 *
c1
 = 
Ãw
 
	`½cc
(
nÚ_exi¡’t
);

254 
time_t
 
t0
 = 
	`time
(0);

255 
šŒ‘
 = 
c1
->
	`bšd
(
½cc
::
	`to
(3000));

256 
time_t
 
t1
 = 
	`time
(0);

257 
	`VERIFY
(
šŒ‘
 < 0 && (
t1
 - 
t0
) <= 4);

258 
	`´štf
(" --„pcimeout .. ok\n");

259 
	`´štf
("simple_tests OK\n");

260 
	}
}

263 
	$cÚcu¼’t_‹¡
(
Á
)

268 
»t
;

270 
	`´štf
("¡¬ˆcÚcu¼’t_‹¡ (%dh»adsè...", 
Á
);

272 
±h»ad_t
 
th
[
Á
];

273 
i
 = 0; i < 
Á
; i++){

274 
»t
 = 
	`±h»ad_ü—‹
(&
th
[
i
], &
©Œ
, 
ş›Á1
, (*è(
ušŒ_t
)i);

275 
	`VERIFY
(
»t
 == 0);

278 
i
 = 0; i < 
Á
; i++){

279 
	`VERIFY
(
	`±h»ad_još
(
th
[
i
], 
NULL
) == 0);

281 
	`´štf
(" OK\n");

282 
	}
}

285 
	$lossy_‹¡
()

287 
»t
;

289 
	`´štf
("start†ossy_test ...");

290 
	`VERIFY
(
	`£‹nv
("RPC_LOSSY", "5", 1) == 0);

292 ià(
£rv”
) {

293 
d–‘e
 
£rv”
;

294 
	`¡¬t£rv”
();

297 
i
 = 0; i < 
NUM_CL
; i++) {

298 
d–‘e
 
ş›Ás
[
i
];

299 
ş›Ás
[
i
] = 
Ãw
 
	`½cc
(
d¡
);

300 
	`VERIFY
(
ş›Ás
[
i
]->
	`bšd
()==0);

303 
Á
 = 1;

304 
±h»ad_t
 
th
[
Á
];

305 
i
 = 0; i < 
Á
; i++){

306 
»t
 = 
	`±h»ad_ü—‹
(&
th
[
i
], &
©Œ
, 
ş›Á2
, (*è(
ušŒ_t
)i);

307 
	`VERIFY
(
»t
 == 0);

309 
i
 = 0; i < 
Á
; i++){

310 
	`VERIFY
(
	`±h»ad_još
(
th
[
i
], 
NULL
) == 0);

312 
	`´štf
(".. OK\n");

313 
	`VERIFY
(
	`£‹nv
("RPC_LOSSY", "0", 1) == 0);

314 
	}
}

317 
	$çu»_‹¡
()

319 
½cc
 *
ş›Á1
;

320 
½cc
 *
ş›Á
 = 
ş›Ás
[0];

322 
	`´štf
("failure_test\n");

324 
d–‘e
 
£rv”
;

326 
ş›Á1
 = 
Ãw
 
	`½cc
(
d¡
);

327 
	`VERIFY
 (
ş›Á1
->
	`bšd
(
½cc
::
	`to
(3000)) < 0);

328 
	`´štf
(" -- create‚ew client‡ndryo bindo failed server .. failed ok\n");

330 
d–‘e
 
ş›Á1
;

332 
	`¡¬t£rv”
();

334 
¡d
::
¡ršg
 
»p
;

335 
šŒ‘
 = 
ş›Á
->
	`ÿÎ
(22, (
¡d
::
¡ršg
)"h–lo", (¡d::¡ršg)" goodbye", 
»p
);

336 
	`VERIFY
(
šŒ‘
 =ğ
½c_cÚ¡
::
Şd¤v_çu»
);

337 
	`´štf
(" -- call„ecovered server with old client .. failed ok\n");

339 
d–‘e
 
ş›Á
;

341 
ş›Ás
[0] = 
ş›Á
 = 
Ãw
 
	`½cc
(
d¡
);

342 
	`VERIFY
 (
ş›Á
->
	`bšd
() >= 0);

343 
	`VERIFY
 (
ş›Á
->
	`bšd
() < 0);

345 
šŒ‘
 = 
ş›Á
->
	`ÿÎ
(22, (
¡d
::
¡ršg
)"h–lo", (¡d::¡ršg)" goodbye", 
»p
);

346 
	`VERIFY
(
šŒ‘
 == 0);

347 
	`VERIFY
(
»p
 == "hello goodbye");

349 
	`´štf
(" -- deleteƒxisting„pc client, create„eplacement„pc client .. ok\n");

352 
Á
 = 10;

353 
»t
;

354 
	`´štf
(" -- cÚcu¼’ˆ‹¡ oÀÃw„pøş›Á w/ %dh»ad ..", 
Á
);

356 
±h»ad_t
 
th
[
Á
];

357 
i
 = 0; i < 
Á
; i++){

358 
»t
 = 
	`±h»ad_ü—‹
(&
th
[
i
], &
©Œ
, 
ş›Á3
, (*è
ş›Á
);

359 
	`VERIFY
(
»t
 == 0);

362 
i
 = 0; i < 
Á
; i++){

363 
	`VERIFY
(
	`±h»ad_još
(
th
[
i
], 
NULL
) == 0);

365 
	`´štf
("ok\n");

367 
d–‘e
 
£rv”
;

368 
d–‘e
 
ş›Á
;

370 
	`¡¬t£rv”
();

371 
ş›Ás
[0] = 
ş›Á
 = 
Ãw
 
	`½cc
(
d¡
);

372 
	`VERIFY
 (
ş›Á
->
	`bšd
() >= 0);

373 
	`´štf
(" -- deleteƒxisting„pc client‡nd server, create„eplacements.. ok\n");

375 
	`´štf
(" -- cÚcu¼’ˆ‹¡ oÀÃw cl›Á‡nd s”v” w/ %dh»ad ..", 
Á
);

376 
i
 = 0; i < 
Á
; i++){

377 
»t
 = 
	`±h»ad_ü—‹
(&
th
[
i
], &
©Œ
, 
ş›Á3
, (*)
ş›Á
);

378 
	`VERIFY
(
»t
 == 0);

381 
i
 = 0; i < 
Á
; i++){

382 
	`VERIFY
(
	`±h»ad_još
(
th
[
i
], 
NULL
) == 0);

384 
	`´štf
("ok\n");

386 
	`´štf
("failure_test OK\n");

387 
	}
}

390 
	$maš
(
¬gc
, *
¬gv
[])

393 
	`£tvbuf
(
¡dout
, 
NULL
, 
_IONBF
, 0);

394 
	`£tvbuf
(
¡d”r
, 
NULL
, 
_IONBF
, 0);

395 
debug_Ëv–
 = 0;

397 
boŞ
 
isş›Á
 = 
çl£
;

398 
boŞ
 
is£rv”
 = 
çl£
;

400 
	`¤ªdom
(
	`g‘pid
());

401 
pÜt
 = 20000 + (
	`g‘pid
() % 10000);

403 
ch
 = 0;

404 (
ch
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "csd:p:l"))!=-1) {

405 
ch
) {

407 
isş›Á
 = 
Œue
;

410 
is£rv”
 = 
Œue
;

413 
debug_Ëv–
 = 
	`©oi
(
İrg
);

416 
pÜt
 = 
	`©oi
(
İrg
);

419 
	`VERIFY
(
	`£‹nv
("RPC_LOSSY", "5", 1) == 0);

425 ià(!
is£rv”
 && !
isş›Á
) {

426 
is£rv”
 = 
isş›Á
 = 
Œue
;

429 ià(
debug_Ëv–
 > 0) {

431 
	`j¦_£t_debug
(
debug_Ëv–
);

432 
	`j¦_log
(
JSL_DBG_1
, "DEBUG LEVEL: %d\n", 
debug_Ëv–
);

435 
	`‹¡m¬sh®l
();

437 
	`±h»ad_©Œ_š™
(&
©Œ
);

439 
	`±h»ad_©Œ_£t¡acksize
(&
©Œ
, 32*1024);

441 ià(
is£rv”
) {

442 
	`´štf
("¡¬tšg s”v” oÀpÜˆ%d RPC_HEADER_SZ %d\n", 
pÜt
, 
RPC_HEADER_SZ
);

443 
	`¡¬t£rv”
();

446 ià(
isş›Á
) {

448 
	`mem£t
(&
d¡
, 0, (dst));

449 
d¡
.
sš_çmy
 = 
AF_INET
;

450 
d¡
.
sš_addr
.
s_addr
 = 
	`š‘_addr
("127.0.0.1");

451 
d¡
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

459 
i
 = 0; i < 
NUM_CL
; i++) {

460 
ş›Ás
[
i
] = 
Ãw
 
	`½cc
(
d¡
);

461 
	`VERIFY
 (
ş›Ás
[
i
]->
	`bšd
() == 0);

464 
	`sim¶e_‹¡s
(
ş›Ás
[0]);

465 
	`cÚcu¼’t_‹¡
(10);

466 
	`lossy_‹¡
();

467 ià(
is£rv”
) {

468 
	`çu»_‹¡
();

471 
	`´štf
("rpctest OK\n");

473 
	`ex™
(0);

477 
	`¦“p
(1);

479 
	}
}

	@rpc/slock.h

1 #iâdeà
__SCOPED_LOCK__


2 
	#__SCOPED_LOCK__


	)

4 
	~<±h»ad.h
>

5 
	~"Ïng/v”ify.h
"

6 
	sScİedLock
 {

7 
	m´iv©e
:

8 
±h»ad_mu‹x_t
 *
m_
;

9 
	mpublic
:

10 
ScİedLock
(
±h»ad_mu‹x_t
 *
m
): 
m_
(m) {

11 
VERIFY
(
±h»ad_mu‹x_lock
(
m_
)==0);

13 ~
ScİedLock
() {

14 
VERIFY
(
±h»ad_mu‹x_uÆock
(
m_
)==0);

	@rpc/thr_pool.cc

1 
	~"¦ock.h
"

2 
	~"thr_poŞ.h
"

3 
	~<¡dlib.h
>

4 
	~<”ºo.h
>

5 
	~"Ïng/v”ify.h
"

8 
	$do_wÜk”
(*
¬g
)

10 
ThrPoŞ
 *

 = (ThrPoŞ *)
¬g
;

12 
ThrPoŞ
::
job_t
 
j
;

13 ià(!

->
	`keJob
(&
j
))

16 ()(
j
.
f
)(j.
a
);

18 
	`±h»ad_ex™
(
NULL
);

19 
	}
}

23 
	gThrPoŞ
::
	$ThrPoŞ
(
sz
, 
boŞ
 
blockšg
)

24 : 
	`Áh»ads_
(
sz
),
	`blockadd_
(
blockšg
),
	$jobq_
(100*
sz
)

26 
	`±h»ad_©Œ_š™
(&
©Œ_
);

27 
	`±h»ad_©Œ_£t¡acksize
(&
©Œ_
, 128<<10);

29 
i
 = 0; i < 
sz
; i++) {

30 
±h»ad_t
 
t
;

31 
	`VERIFY
(
	`±h»ad_ü—‹
(&
t
, &
©Œ_
, 
do_wÜk”
, (*)
this
) ==0);

32 
th_
.
	`push_back
(
t
);

34 
	}
}

38 
	gThrPoŞ
::~
	$ThrPoŞ
()

40 
i
 = 0; i < 
Áh»ads_
; i++) {

41 
job_t
 
j
;

42 
j
.
f
 = (*(*)(*))
NULL
;

43 
jobq_
.
	`’q
(
j
);

46 
i
 = 0; i < 
Áh»ads_
; i++) {

47 
	`VERIFY
(
	`±h»ad_još
(
th_
[
i
], 
NULL
)==0);

50 
	`VERIFY
(
	`±h»ad_©Œ_de¡roy
(&
©Œ_
)==0);

51 
	}
}

53 
boŞ


54 
	gThrPoŞ
::
	$addJob
(*(*
f
)(*), *
a
)

56 
job_t
 
j
;

57 
j
.
f
 = f;

58 
j
.
a
 =‡;

60  
jobq_
.
	`’q
(
j
,
blockadd_
);

61 
	}
}

63 
boŞ


64 
	gThrPoŞ
::
	$keJob
(
job_t
 *
j
)

66 
jobq_
.
	`deq
(
j
);

67  (
j
->
f
!=
NULL
);

68 
	}
}

	@rpc/thr_pool.h

1 #iâdeà
__THR_POOL__


2 
	#__THR_POOL__


	)

4 
	~<±h»ad.h
>

5 
	~<veùÜ
>

7 
	~"fifo.h
"

9 şas 
	cThrPoŞ
 {

12 
	mpublic
:

13 
	sjob_t
 {

14 *(*
f
)(*);

15 *
	ma
;

18 
ThrPoŞ
(
sz
, 
boŞ
 
blockšg
=
Œue
);

19 ~
ThrPoŞ
();

20 
	g‹m¶©e
<
şass
 
	gC
, cÏs 
	gA
> 
boŞ
 
addObjJob
(
C
 *
o
, (C::*
m
)(
A
), A 
a
);

21 
	`wa™DÚe
();

23 
boŞ
 
	`keJob
(
job_t
 *
j
);

25 
´iv©e
:

26 
±h»ad_©Œ_t
 
©Œ_
;

27 
Áh»ads_
;

28 
boŞ
 
blockadd_
;

31 
fifo
<
job_t
> 
jobq_
;

32 
¡d
::
veùÜ
<
±h»ad_t
> 
th_
;

34 
boŞ
 
	`addJob
(*(*
f
)(*), *
a
);

35 
	}
};

37 
	g‹m¶©e
 <
şass
 
	gC
, cÏs 
	gA
> 
boŞ


38 
	gThrPoŞ
::
addObjJob
(
C
 *
o
, (C::*
m
)(
A
), A 
a
)

41 şas 
	cobjfunc_w¿µ”
 {

42 
public
:

43 
C
 *
o
;

44 (
C
::*
m
)(
A
 
a
);

45 
A
 
a
;

46 *
	`func
(*
vvv
) {

47 
objfunc_w¿µ”
 *
x
 = (objfunc_w¿µ”*)
vvv
;

48 
C
 *
o
 = 
x
->o;

49 (
C
::*
m
)(
A
 ) = 
x
->m;

50 
A
 
a
 = 
x
->a;

51 (
o
->*
m
)(
a
);

52 
d–‘e
 
x
;

55 
	}
};

57 
objfunc_w¿µ”
 *
	gx
 = 
Ãw
 objfunc_wrapper;

58 
	gx
->
	go
 = 
o
;

59 
	gx
->
	gm
 = 
m
;

60 
	gx
->
	ga
 = 
a
;

61  
addJob
(&
objfunc_w¿µ”
::
func
, (*)
x
);

	@rsm.cc

81 
	~<f¡»am
>

82 
	~<io¡»am
>

83 
	~<uni¡d.h
>

84 
	~"hªdË.h
"

85 
	~"rsm.h
"

86 
	~"rštf.h
"

87 
	~"Ïng/v”ify.h
"

90 
	$»cov”yth»ad
(*
x
)

92 
rsm
 *
r
 = (rsm *è
x
;

93 
r
->
	`»cov”y
();

95 
	}
}

97 
	grsm
::
	$rsm
(
¡d
::
¡ršg
 
_fœ¡
, std::¡ršg 
_me
)

98 : 
	`¡f
(0), 
	`´im¬y
(
_fœ¡
), 
	`šsync
 (
çl£
), 
	`šv›wchªge
 (
Œue
), 
	`vid_comm™
(0),

99 
	`·¹™iÚed
 (
çl£
), 
	`dİ¬t™iÚ
(çl£), 
	`b»ak1
(çl£), 
	$b»ak2
(
çl£
)

101 
±h»ad_t
 
th
;

103 
Ï¡_myvs
.
vid
 = 0;

104 
Ï¡_myvs
.
£qno
 = 0;

105 
myvs
 = 
Ï¡_myvs
;

106 
myvs
.
£qno
 = 1;

108 
	`±h»ad_mu‹x_š™
(&
rsm_mu‹x
, 
NULL
);

109 
	`±h»ad_mu‹x_š™
(&
švoke_mu‹x
, 
NULL
);

110 
	`±h»ad_cÚd_š™
(&
»cov”y_cÚd
, 
NULL
);

111 
	`±h»ad_cÚd_š™
(&
sync_cÚd
, 
NULL
);

113 
cfg
 = 
Ãw
 
	`cÚfig
(
_fœ¡
, 
_me
, 
this
);

115 ià(
_fœ¡
 =ğ
_me
) {

118 
	`comm™_chªge
(1);

120 
rsm½c
 = 
cfg
->
	`g‘_½cs
();

121 
rsm½c
->
	`»g
(
rsm_ş›Á_´ÙocŞ
::
švoke
, 
this
, &
rsm
::
ş›Á_švoke
);

122 
rsm½c
->
	`»g
(
rsm_ş›Á_´ÙocŞ
::
memb”s
, 
this
, &
rsm
::
ş›Á_memb”s
);

123 
rsm½c
->
	`»g
(
rsm_´ÙocŞ
::
švoke
, 
this
, &
rsm
::invoke);

124 
rsm½c
->
	`»g
(
rsm_´ÙocŞ
::
Œªsã¼eq
, 
this
, &
rsm
::transferreq);

125 
rsm½c
->
	`»g
(
rsm_´ÙocŞ
::
ŒªsãrdÚ”eq
, 
this
, &
rsm
::transferdonereq);

126 
rsm½c
->
	`»g
(
rsm_´ÙocŞ
::
još»q
, 
this
, &
rsm
::joinreq);

129 
‹¡svr
 = 
Ãw
 
	`½cs
(
	`©oi
(
_me
.
	`c_¡r
()) + 1);

130 
‹¡svr
->
	`»g
(
rsm_‹¡_´ÙocŞ
::
Ãt_»·œ
, 
this
, &
rsm
::
‹¡_Ãt_»·œ»q
);

131 
‹¡svr
->
	`»g
(
rsm_‹¡_´ÙocŞ
::
b»akpošt
, 
this
, &
rsm
::
b»akpošŒeq
);

134 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

135 
	`VERIFY
(
	`±h»ad_ü—‹
(&
th
, 
NULL
, &
»cov”yth»ad
, (*è
this
) == 0);

137 
	}
}

142 
	grsm
::
	$»cov”y
()

144 
boŞ
 
r
 = 
Œue
;

145 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

148 !
cfg
->
	`ismemb”
(cfg->
	`myaddr
(), 
vid_comm™
)) {

149 ià(
	`još
(
´im¬y
)) {

150 
	`rštf
("recovery: joined\n");

151 
	`comm™_chªge_wo
(
cfg
->
	`vid
());

153 
	`VERIFY
(
	`±h»ad_mu‹x_uÆock
(&
rsm_mu‹x
)==0);

154 
	`¦“p
 (30);

155 
	`VERIFY
(
	`±h»ad_mu‹x_lock
(&
rsm_mu‹x
)==0);

158 
vid_šsync
 = 
vid_comm™
;

159 
	`rštf
("»cov”y: synøvid_šsynø%d\n", 
vid_šsync
);

160 ià(
´im¬y
 =ğ
cfg
->
	`myaddr
()) {

161 
r
 = 
	`sync_w™h_backups
();

163 
r
 = 
	`sync_w™h_´im¬y
();

165 
	`rštf
("recovery: sync done\n");

169 ià(
vid_šsync
 !ğ
vid_comm™
)

172 ià(
r
) {

173 
myvs
.
vid
 = 
vid_comm™
;

174 
myvs
.
£qno
 = 1;

175 
šv›wchªge
 = 
çl£
;

177 
	`rštf
("»cov”y: gØtØ¦“°%d %d\n", 
šsync
, 
šv›wchªge
);

178 
	`±h»ad_cÚd_wa™
(&
»cov”y_cÚd
, &
rsm_mu‹x
);

180 
	}
}

182 
boŞ


183 
	grsm
::
	$sync_w™h_backups
()

185 
	`±h»ad_mu‹x_uÆock
(&
rsm_mu‹x
);

190 
ScİedLock
 
	`ml
(&
švoke_mu‹x
);

197 
	`±h»ad_mu‹x_lock
(&
rsm_mu‹x
);

199 
šsync
 = 
Œue
;

203 
šsync
 = 
çl£
;

204  
Œue
;

205 
	}
}

208 
boŞ


209 
	grsm
::
	$sync_w™h_´im¬y
()

212 
¡d
::
¡ršg
 
m
 = 
´im¬y
;

215  
Œue
;

216 
	}
}

223 
boŞ


224 
	grsm
::
	$¡©‘¿nsãr
(
¡d
::
¡ršg
 
m
)

226  
Œue
;

227 
	}
}

229 
boŞ


230 
	grsm
::
	$¡©‘¿nsãrdÚe
(
¡d
::
¡ršg
 
m
) {

232  
Œue
;

233 
	}
}

236 
boŞ


237 
	grsm
::
	$još
(
¡d
::
¡ršg
 
m
) {

238 
hªdË
 
	`h
(
m
);

239 
»t
;

240 
rsm_´ÙocŞ
::
još»s
 
r
;

242 
	`rštf
("rsm::još: % myÏ¡ (%d,%d)\n", 
m
.
	`c_¡r
(), 
Ï¡_myvs
.
vid
,

243 
Ï¡_myvs
.
£qno
);

244 
	`VERIFY
(
	`±h»ad_mu‹x_uÆock
(&
rsm_mu‹x
)==0);

245 
½cc
 *
ş
 = 
h
.
	`§ãbšd
();

246 ià(
ş
 != 0) {

247 
»t
 = 
ş
->
	`ÿÎ
(
rsm_´ÙocŞ
::
još»q
, 
cfg
->
	`myaddr
(), 
Ï¡_myvs
,

248 
r
, 
½cc
::
	`to
(120000));

250 
	`VERIFY
(
	`±h»ad_mu‹x_lock
(&
rsm_mu‹x
)==0);

252 ià(
ş
 =ğ0 || 
»t
 !ğ
rsm_´ÙocŞ
::
OK
) {

253 
	`rštf
("rsm::još: couldn'ˆ»ach % %°%d\n", 
m
.
	`c_¡r
(),

254 
ş
, 
»t
);

255  
çl£
;

257 
	`rštf
("rsm::još: sucûeded %s\n", 
r
.
log
.
	`c_¡r
());

258 
cfg
->
	`»¡Üe
(
r
.
log
);

259  
Œue
;

260 
	}
}

267 
	grsm
::
	$comm™_chªge
(
vid
)

269 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

270 
	`comm™_chªge_wo
(
vid
);

271 
	}
}

274 
	grsm
::
	$comm™_chªge_wo
(
vid
)

276 ià(
vid
 <ğ
vid_comm™
)

278 
	`rštf
("commit_change:‚ew view (%d)†ast vs (%d,%d) %s insync %d\n",

279 
vid
, 
Ï¡_myvs
.vid,†a¡_myvs.
£qno
, 
´im¬y
.
	`c_¡r
(), 
šsync
);

280 
vid_comm™
 = 
vid
;

281 
šv›wchªge
 = 
Œue
;

282 
	`£t_´im¬y
(
vid
);

283 
	`±h»ad_cÚd_sigÇl
(&
»cov”y_cÚd
);

284 ià(
cfg
->
	`ismemb”
(cfg->
	`myaddr
(), 
vid_comm™
))

285 
	`b»akpošt2
();

286 
	}
}

296 
	grsm_ş›Á_´ÙocŞ
::
¡©us


297 
rsm
::
	$ş›Á_švoke
(
´oúo
, 
¡d
::
¡ršg
 
»q
, std::¡ršg &
r
)

299 
»t
 = 
rsm_ş›Á_´ÙocŞ
::
OK
;

300  
»t
;

301 
	}
}

310 
	grsm_´ÙocŞ
::
¡©us


311 
rsm
::
	$švoke
(
´oc
, 
v›w¡amp
 
vs
, 
¡d
::
¡ršg
 
»q
, &
dummy
)

313 
rsm_´ÙocŞ
::
¡©us
 
»t
 =„sm_´ÙocŞ::
OK
;

314  
»t
;

315 
	}
}

320 
	grsm_´ÙocŞ
::
¡©us


321 
rsm
::
	$Œªsã¼eq
(
¡d
::
¡ršg
 
¤c
, 
v›w¡amp
 
Ï¡
, 
vid
,

322 
rsm_´ÙocŞ
::
Œªsã¼es
 &
r
)

324 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

325 
»t
 = 
rsm_´ÙocŞ
::
OK
;

326  
»t
;

327 
	}
}

333 
	grsm_´ÙocŞ
::
¡©us


334 
rsm
::
	$ŒªsãrdÚ”eq
(
¡d
::
¡ršg
 
m
, 
vid
, &)

336 
»t
 = 
rsm_´ÙocŞ
::
OK
;

337 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

342  
»t
;

343 
	}
}

347 
	grsm_´ÙocŞ
::
¡©us


348 
rsm
::
	$još»q
(
¡d
::
¡ršg
 
m
, 
v›w¡amp
 
Ï¡
, 
rsm_´ÙocŞ
::
još»s
 &
r
)

350 
»t
 = 
rsm_´ÙocŞ
::
OK
;

352 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

353 
	`rštf
("još»q: srø% Ï¡ (%d,%dèmyÏ¡ (%d,%d)\n", 
m
.
	`c_¡r
(),

354 
Ï¡
.
vid
,†a¡.
£qno
, 
Ï¡_myvs
.vid,†ast_myvs.seqno);

355 ià(
cfg
->
	`ismemb”
(
m
, 
vid_comm™
)) {

356 
	`rštf
("joinreq: is still‡ member\n");

357 
r
.
log
 = 
cfg
->
	`dump
();

358 } ià(
cfg
->
	`myaddr
(è!ğ
´im¬y
) {

359 
	`rštf
("joinreq: busy\n");

360 
»t
 = 
rsm_´ÙocŞ
::
BUSY
;

364 
vid_ÿche
 = 
vid_comm™
;

365 
	`VERIFY
 (
	`±h»ad_mu‹x_uÆock
(&
rsm_mu‹x
) == 0);

366 
boŞ
 
succ
 = 
cfg
->
	`add
(
m
, 
vid_ÿche
);

367 
	`VERIFY
 (
	`±h»ad_mu‹x_lock
(&
rsm_mu‹x
) == 0);

368 ià(
cfg
->
	`ismemb”
(
m
, cfg->
	`vid
())) {

369 
r
.
log
 = 
cfg
->
	`dump
();

370 
	`rštf
("još»q:„‘ %d†og %s\n:", 
»t
, 
r
.
log
.
	`c_¡r
());

372 
	`rštf
("još»q: faed;…rİo£¸couldn'ˆadd %d\n", 
succ
);

373 
»t
 = 
rsm_´ÙocŞ
::
BUSY
;

376  
»t
;

377 
	}
}

384 
	grsm_ş›Á_´ÙocŞ
::
¡©us


385 
rsm
::
ş›Á_memb”s
(
i
, 
¡d
::
veùÜ
<¡d::
¡ršg
> &
r
)

387 
¡d
::
veùÜ
<¡d::
¡ršg
> 
m
;

388 
ScİedLock
 
ml
(&
rsm_mu‹x
);

389 
	gm
 = 
cfg
->
g‘_v›w
(
vid_comm™
);

390 
	gm
.
push_back
(
´im¬y
);

391 
	gr
 = 
m
;

392 
rštf
("rsm::ş›Á_memb” »tuº % m %s\n", 
´št_memb”s
(
m
).
c_¡r
(),

393 
´im¬y
.
c_¡r
());

394  
	grsm_ş›Á_´ÙocŞ
::
OK
;

401 
	grsm
::
	$£t_´im¬y
(
vid
)

403 
¡d
::
veùÜ
<¡d::
¡ršg
> 
c
 = 
cfg
->
	`g‘_v›w
(
vid
);

404 
¡d
::
veùÜ
<¡d::
¡ršg
> 
p
 = 
cfg
->
	`g‘_v›w
(
vid
 - 1);

405 
	`VERIFY
 (
c
.
	`size
() > 0);

407 ià(
	`i§memb”
(
´im¬y
,
c
)) {

408 
	`rštf
("£t_´im¬y:…rim¬y sy %s\n", 
´im¬y
.
	`c_¡r
());

412 
	`VERIFY
(
p
.
	`size
() > 0);

413 
i
 = 0; i < 
p
.
	`size
(); i++) {

414 ià(
	`i§memb”
(
p
[
i
], 
c
)) {

415 
´im¬y
 = 
p
[
i
];

416 
	`rštf
("£t_´im¬y:…rim¬y i %s\n", 
´im¬y
.
	`c_¡r
());

420 
	`VERIFY
(0);

421 
	}
}

423 
boŞ


424 
	grsm
::
	$amrim¬y
()

426 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

427  
´im¬y
 =ğ
cfg
->
	`myaddr
(è&& !
šv›wchªge
;

428 
	}
}

437 
	grsm
::
	$Ãt_»·œ_wo
(
boŞ
 
h—l
)

439 
¡d
::
veùÜ
<¡d::
¡ršg
> 
m
;

440 
m
 = 
cfg
->
	`g‘_v›w
(
vid_comm™
);

441 
i
 = 0; i < 
m
.
	`size
(); i++) {

442 ià(
m
[
i
] !ğ
cfg
->
	`myaddr
()) {

443 
hªdË
 
	`h
(
m
[
i
]);

444 
	`rštf
("rsm::Ãt_»·œ_wo: % %d\n", 
m
[
i
].
	`c_¡r
(), 
h—l
);

445 ià(
h
.
	`§ãbšd
()èh.§ãbšd()->
	`£t_»achabË
(
h—l
);

448 
rsm½c
->
	`£t_»achabË
(
h—l
);

449 
	}
}

451 
	grsm_‹¡_´ÙocŞ
::
¡©us


452 
rsm
::
	$‹¡_Ãt_»·œ»q
(
h—l
, &
r
)

454 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

455 
	`rštf
("rsm::test_net_repairreq: %d (dopartition %d,…artitioned %d)\n",

456 
h—l
, 
dİ¬t™iÚ
, 
·¹™iÚed
);

457 ià(
h—l
) {

458 
	`Ãt_»·œ_wo
(
h—l
);

459 
·¹™iÚed
 = 
çl£
;

461 
dİ¬t™iÚ
 = 
Œue
;

462 
·¹™iÚed
 = 
çl£
;

464 
r
 = 
rsm_‹¡_´ÙocŞ
::
OK
;

465  
r
;

466 
	}
}

471 
	grsm
::
	$b»akpošt1
()

473 ià(
b»ak1
) {

474 
	`rštf
("Dying‡t breakpoint 1 in„sm!\n");

475 
	`ex™
(1);

477 
	}
}

480 
	grsm
::
	$b»akpošt2
()

482 ià(
b»ak2
) {

483 
	`rštf
("Dying‡t breakpoint 2 in„sm!\n");

484 
	`ex™
(1);

486 
	}
}

489 
	grsm
::
	$·¹™iÚ1
()

491 ià(
dİ¬t™iÚ
) {

492 
	`Ãt_»·œ_wo
(
çl£
);

493 
dİ¬t™iÚ
 = 
çl£
;

494 
·¹™iÚed
 = 
Œue
;

496 
	}
}

498 
	grsm_‹¡_´ÙocŞ
::
¡©us


499 
rsm
::
	$b»akpošŒeq
(
b
, &
r
)

501 
r
 = 
rsm_‹¡_´ÙocŞ
::
OK
;

502 
ScİedLock
 
	`ml
(&
rsm_mu‹x
);

503 
	`rštf
("rsm::b»akpošŒeq: %d\n", 
b
);

504 ià(
b
 =ğ1è
b»ak1
 = 
Œue
;

505 ià(
b
 =ğ2è
b»ak2
 = 
Œue
;

506 ià(
b
 =ğ3 || b =ğ4è
cfg
->
	`b»akpošt
(b);

507 
r
 = 
rsm_‹¡_´ÙocŞ
::
ERR
;

508  
r
;

509 
	}
}

	@rsm.h

3 #iâdeà
rsm_h


4 
	#rsm_h


	)

6 
	~<¡ršg
>

7 
	~<veùÜ
>

8 
	~"rsm_´ÙocŞ.h
"

9 
	~"rsm_¡©e_Œªsãr.h
"

10 
	~"½c.h
"

11 
	~<¬·/š‘.h
>

12 
	~"cÚfig.h
"

15 şas 
	crsm
 : 
public
 
cÚfig_v›w_chªge
 {

16 
´Ùeùed
:

17 
¡d
::
m­
<, 
	mhªdËr
 *> 
	m´ocs
;

18 
cÚfig
 *
	mcfg
;

19 
şass
 
rsm_¡©e_Œªsãr
 *
	m¡f
;

20 
½cs
 *
	mrsm½c
;

23 
v›w¡amp
 
	mmyvs
;

24 
v›w¡amp
 
	mÏ¡_myvs
;

25 
	m¡d
::
¡ršg
 
´im¬y
;

26 
boŞ
 
	mšsync
;

27 
boŞ
 
	mšv›wchªge
;

28 
	mvid_comm™
;

29 
	mvid_šsync
;

30 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
> 
backups
;

33 
½cs
 *
	m‹¡svr
;

34 
boŞ
 
	m·¹™iÚed
;

35 
boŞ
 
	mdİ¬t™iÚ
;

36 
boŞ
 
	mb»ak1
;

37 
boŞ
 
	mb»ak2
;

40 
	mrsm_ş›Á_´ÙocŞ
::
¡©us
 
ş›Á_memb”s
(
i
,

41 
¡d
::
veùÜ
<¡d::
¡ršg
> &
r
);

42 
	mrsm_´ÙocŞ
::
¡©us
 
švoke
(
´oc
, 
v›w¡amp
 
vs
, 
¡d
::
¡ršg
 
m»q
,

43 &
dummy
);

44 
	mrsm_´ÙocŞ
::
¡©us
 
Œªsã¼eq
(
¡d
::
¡ršg
 
¤c
, 
v›w¡amp
 
Ï¡
, 
vid
,

45 
rsm_´ÙocŞ
::
Œªsã¼es
 &
r
);

46 
	mrsm_´ÙocŞ
::
¡©us
 
ŒªsãrdÚ”eq
(
¡d
::
¡ršg
 
m
, 
vid
, &);

47 
	mrsm_´ÙocŞ
::
¡©us
 
još»q
(
¡d
::
¡ršg
 
¤c
, 
v›w¡amp
 
Ï¡
,

48 
rsm_´ÙocŞ
::
još»s
 &
r
);

49 
	mrsm_‹¡_´ÙocŞ
::
¡©us
 
‹¡_Ãt_»·œ»q
(
h—l
, &
r
);

50 
	mrsm_‹¡_´ÙocŞ
::
¡©us
 
b»akpošŒeq
(
b
, &
r
);

52 
±h»ad_mu‹x_t
 
	mrsm_mu‹x
;

53 
±h»ad_mu‹x_t
 
	mšvoke_mu‹x
;

54 
±h»ad_cÚd_t
 
	m»cov”y_cÚd
;

55 
±h»ad_cÚd_t
 
	msync_cÚd
;

57 
	mrsm_ş›Á_´ÙocŞ
::
¡©us
 
ş›Á_švoke
(
´oúo
, 
¡d
::
¡ršg
 
»q
,

58 
¡d
::
¡ršg
 &
r
);

59 
boŞ
 
¡©‘¿nsãr
(
¡d
::
¡ršg
 
m
);

60 
boŞ
 
¡©‘¿nsãrdÚe
(
¡d
::
¡ršg
 
m
);

61 
boŞ
 
još
(
¡d
::
¡ršg
 
m
);

62 
£t_´im¬y
(
vid
);

63 
	m¡d
::
¡ršg
 
fšd_highe¡
(
v›w¡amp
 &
vs
, 
¡d
::¡ršg &
m
, &
vid
);

64 
boŞ
 
sync_w™h_backups
();

65 
boŞ
 
sync_w™h_´im¬y
();

66 
Ãt_»·œ_wo
(
boŞ
 
h—l
);

67 
b»akpošt1
();

68 
b»akpošt2
();

69 
·¹™iÚ1
();

70 
comm™_chªge_wo
(
vid
);

71 
	mpublic
:

72 
rsm
 (
¡d
::
¡ršg
 
_fœ¡
, std::¡ršg 
_me
);

73 ~
	$rsm
() {};

75 
boŞ
 
	`amrim¬y
();

76 
	$£t_¡©e_Œªsãr
(
rsm_¡©e_Œªsãr
 *
_¡f
è{ 
¡f
 = _¡f; 
	}
};

77 
»cov”y
();

78 
comm™_chªge
(
vid
);

	@rsm_protocol.h

1 #iâdeà
rsm_´ÙocŞ_h


2 
	#rsm_´ÙocŞ_h


	)

4 
	~"½c.h
"

7 şas 
	crsm_ş›Á_´ÙocŞ
 {

8 
	mpublic
:

9 
	exx¡©us
 { 
OK
, 
	mERR
, 
	mNOTPRIMARY
, 
	mBUSY
};

10 
	t¡©us
;

11 
	e½c_numb”s
 {

12 
	gšvoke
 = 0x9001,

13 
	gmemb”s
,

18 
	sv›w¡amp
 {

19 
v›w¡amp
 (
_vid
 = 0, 
_£qno
 = 0) {

20 
vid
 = 
_vid
;

21 
	m£qno
 = 
_£qno
;

23 
	mvid
;

24 
	m£qno
;

27 şas 
	crsm_´ÙocŞ
 {

28 
	mpublic
:

29 
	exx¡©us
 { 
OK
, 
	mERR
, 
	mBUSY
};

30 
	t¡©us
;

31 
	e½c_numb”s
 {

32 
	gšvoke
 = 0x10001,

33 
	gŒªsã¼eq
,

34 
	gŒªsãrdÚ”eq
,

35 
	gjoš»q
,

38 
	sŒªsã¼es
 {

39 
	g¡d
::
¡ršg
 
¡©e
;

40 
v›w¡amp
 
	gÏ¡
;

43 
	sjoš»s
 {

44 
	g¡d
::
¡ršg
 
log
;

48 
šlše
 
boŞ
 
	gİ”©Ü
==(
v›w¡amp
 
a
, v›w¡am°
	gb
) {

49  
	ga
.
	gvid
 =ğ
b
.
vid
 && 
a
.
£qno
 == b.seqno;

52 
šlše
 
boŞ
 
	gİ”©Ü
>(
v›w¡amp
 
	ga
, v›w¡am°
	gb
) {

53  (
	ga
.
	gvid
 > 
	gb
.vidè|| (×.vid =ğ
b
.
vid
è&& 
a
.
£qno
 > b.seqno);

56 
šlše
 
boŞ
 
	gİ”©Ü
!=(
v›w¡amp
 
a
, v›w¡am°
	gb
) {

57  
	ga
.
	gvid
 !ğ
b
.
vid
 || 
a
.
£qno
 != b.seqno;

60 
šlše
 
	gm¬sh®l
& 
	gİ”©Ü
<<(m¬sh®È&
	gm
, 
v›w¡amp
 
	gv
)

62 
	gm
 << 
	gv
.
	gvid
;

63 
	gm
 << 
	gv
.
	g£qno
;

64  
	gm
;

67 
šlše
 
	gunm¬sh®l
& 
	gİ”©Ü
>>(unm¬sh®È&
	gu
, 
	gv›w¡amp
 &
	gv
) {

68 
	gu
 >> 
	gv
.
	gvid
;

69 
	gu
 >> 
	gv
.
	g£qno
;

70  
	gu
;

73 
šlše
 
	gm¬sh®l
 &

74 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	grsm_´ÙocŞ
::
Œªsã¼es
 
r
)

76 
m
 << 
r
.
¡©e
;

77 
	gm
 << 
	gr
.
	gÏ¡
;

78  
	gm
;

81 
šlše
 
	gunm¬sh®l
 &

82 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	grsm_´ÙocŞ
::
Œªsã¼es
 &
r
)

84 
u
 >> 
r
.
¡©e
;

85 
	gu
 >> 
	gr
.
	gÏ¡
;

86  
	gu
;

89 
šlše
 
	gm¬sh®l
 &

90 
	gİ”©Ü
<<(
	gm¬sh®l
 &
	gm
, 
	grsm_´ÙocŞ
::
još»s
 
r
)

92 
m
 << 
r
.
log
;

93  
	gm
;

96 
šlše
 
	gunm¬sh®l
 &

97 
	gİ”©Ü
>>(
	gunm¬sh®l
 &
	gu
, 
	grsm_´ÙocŞ
::
još»s
 &
r
)

99 
u
 >> 
r
.
log
;

100  
	gu
;

103 şas 
	crsm_‹¡_´ÙocŞ
 {

104 
	mpublic
:

105 
	exx¡©us
 { 
OK
, 
	mERR
};

106 
	t¡©us
;

107 
	e½c_numb”s
 {

108 
	gÃt_»·œ
 = 0x12001,

109 
	gb»akpošt
 = 0x12002,

	@rsm_state_transfer.h

1 #iâdeà
rsm_¡©e_Œªsãr_h


2 
	#rsm_¡©e_Œªsãr_h


	)

4 şas 
	crsm_¡©e_Œªsãr
 {

5 
	mpublic
:

6 
vœtu®
 
¡d
::
¡ršg
 
m¬sh®_¡©e
() = 0;

7 
vœtu®
 
unm¬sh®_¡©e
(
¡d
::
¡ršg
) = 0;

8 
	mvœtu®
 ~
	$rsm_¡©e_Œªsãr
() {};

9 
	}
};

	@rsm_tester.cc

5 
	~"rsm_´ÙocŞ.h
"

6 
	~"rsm‹¡_ş›Á.h
"

7 
	~"½c.h
"

8 
	~<¬·/š‘.h
>

9 
	~<veùÜ
>

10 
	~<¡dlib.h
>

11 
	~<¡dio.h
>

12 
	~<¡ršg
>

13 
usšg
 
Çme¥aû
 
	g¡d
;

15 
rsm‹¡_ş›Á
 *
	glc
;

18 
	$maš
(
¬gc
, *
¬gv
[])

20 
r
;

22 if(
¬gc
 != 4){

23 
	`årštf
(
¡d”r
, "U§ge: % [ho¡:]pÜˆ[·¹™iÚ]‡rg\n", 
¬gv
[0]);

24 
	`ex™
(1);

27 
lc
 = 
Ãw
 
	`rsm‹¡_ş›Á
(
¬gv
[1]);

28 
¡ršg
 
	`commªd
(
¬gv
[2]);

29 ià(
commªd
 == "partition") {

30 
r
 = 
lc
->
	`Ãt_»·œ
(
	`©oi
(
¬gv
[3]));

31 
	`´štf
 ("Ãt_»·œ„‘uºed %d\n", 
r
);

32 } ià(
commªd
 == "breakpoint") {

33 
b
 = 
	`©oi
(
¬gv
[3]);

34 
r
 = 
lc
->
	`b»akpošt
(
b
);

35 
	`´štf
 ("b»akpošˆ%d„‘uºed %d\n", 
b
, 
r
);

37 
	`årštf
(
¡d”r
, "UnknowÀcommªd %s\n", 
¬gv
[2]);

39 
	`ex™
(0);

40 
	}
}

	@rsmtest_client.cc

3 
	~"rsm‹¡_ş›Á.h
"

4 
	~"½c.h
"

5 
	~<¬·/š‘.h
>

7 
	~<s¡»am
>

8 
	~<io¡»am
>

9 
	~<¡dio.h
>

11 
	grsm‹¡_ş›Á
::
	$rsm‹¡_ş›Á
(
¡d
::
¡ršg
 
d¡
)

13 
sockaddr_š
 
d¡sock
;

14 
	`make_sockaddr
(
d¡
.
	`c_¡r
(), &
d¡sock
);

15 
ş
 = 
Ãw
 
	`½cc
(
d¡sock
);

16 ià(
ş
->
	`bšd
() < 0) {

17 
	`´štf
("rsmtest_client: call bind\n");

19 
	}
}

22 
	grsm‹¡_ş›Á
::
	$Ãt_»·œ
(
h—l
)

24 
r
;

25 
»t
 = 
ş
->
	`ÿÎ
(
rsm_‹¡_´ÙocŞ
::
Ãt_»·œ
, 
h—l
, 
r
);

26 
	`VERIFY
 (
»t
 =ğ
rsm_‹¡_´ÙocŞ
::
OK
);

27  
r
;

28 
	}
}

31 
	grsm‹¡_ş›Á
::
	$b»akpošt
(
b
)

33 
r
;

34 
»t
 = 
ş
->
	`ÿÎ
(
rsm_‹¡_´ÙocŞ
::
b»akpošt
, 
b
, 
r
);

35 
	`VERIFY
 (
»t
 =ğ
rsm_‹¡_´ÙocŞ
::
OK
);

36  
r
;

37 
	}
}

	@rsmtest_client.h

3 #iâdeà
rsm‹¡_ş›Á_h


4 
	#rsm‹¡_ş›Á_h


	)

6 
	~<¡ršg
>

7 
	~"rsm_´ÙocŞ.h
"

8 
	~"½c.h
"

11 şas 
	crsm‹¡_ş›Á
 {

12 
	m´Ùeùed
:

13 
½cc
 *
ş
;

14 
	mpublic
:

15 
rsm‹¡_ş›Á
(
¡d
::
¡ršg
 
d
);

16 
	mvœtu®
 ~
	$rsm‹¡_ş›Á
() {};

17 
vœtu®
 
rsm_‹¡_´ÙocŞ
::
¡©us
 
	`Ãt_»·œ
(
h—l
);

18 
vœtu®
 
rsm_‹¡_´ÙocŞ
::
¡©us
 
	`b»akpošt
(
b
);

19 
	}
};

	@test-lab-3-b.c

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<uni¡d.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty³s.h
>

14 
	~<sys/¡©.h
>

15 
	~<sys/wa™.h
>

16 
	~<dœ’t.h
>

17 
	~<¡ršg.h
>

18 
	~<fú.h
>

19 
	~<”ºo.h
>

21 
	gd1
[512], 
	gd2
[512];

22 
”ºo
;

24 
	gbig
[20001];

25 
	ghuge
[65536*2+1];

28 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

30 
fd
;

31 
n
[512];

37 
	`¦“p
(1);

39 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

40 
fd
 = 
	`ü—t
(
n
, 0666);

41 if(
fd
 < 0){

42 
	`årštf
(
¡d”r
, "test-lab-3-b: create(%s): %s\n",

43 
n
, 
	`¡»¼Ü
(
”ºo
));

44 
	`ex™
(1);

46 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

47 
	`årštf
(
¡d”r
, "test-lab-3-b: write(%s): %s\n",

48 
n
, 
	`¡»¼Ü
(
”ºo
));

49 
	`ex™
(1);

51 if(
	`şo£
(
fd
) != 0){

52 
	`årštf
(
¡d”r
, "test-lab-3-b: close(%s): %s\n",

53 
n
, 
	`¡»¼Ü
(
”ºo
));

54 
	`ex™
(1);

56 
	}
}

59 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

61 
fd
, 
cc
;

62 
n
[512], 
buf
[21000];

64 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

65 
fd
 = 
	`İ’
(
n
, 0);

66 if(
fd
 < 0){

67 
	`årštf
(
¡d”r
, "test-lab-3-b: open(%s): %s\n",

68 
n
, 
	`¡»¼Ü
(
”ºo
));

69 
	`ex™
(1);

71 
”ºo
 = 0;

72 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

73 if(
cc
 !ğ
	`¡¾’
(
š
)){

74 
	`årštf
(
¡d”r
, "test-lab-3-b:„ead(%s)„eturnedoo†ittle %d%s%s\n",

75 
n
,

76 
cc
,

77 
”ºo
 ? ": " : "",

78 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

79 
	`ex™
(1);

81 
	`şo£
(
fd
);

82 
buf
[
cc
] = '\0';

83 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(
n
)) != 0){

84 
	`årštf
(
¡d”r
, "test-lab-3-b:„ead(%s) got \"%s\",‚ot \"%s\"\n",

85 
n
, 
buf
, 
š
);

86 
	`ex™
(1);

88 
	}
}

91 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

93 
n
[512];

95 
	`¦“p
(1);

97 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

98 if(
	`uÆšk
(
n
) != 0){

99 
	`årštf
(
¡d”r
, "test-lab-3-b: unlink(%s): %s\n",

100 
n
, 
	`¡»¼Ü
(
”ºo
));

101 
	`ex™
(1);

103 
	}
}

106 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

108 
fd
;

109 
n
[512];

111 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

112 
fd
 = 
	`İ’
(
n
, 0);

113 if(
fd
 >= 0){

114 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-b: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

115 
	`ex™
(1);

117 
	}
}

120 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

122 
fd
;

123 
n
[512];

125 
	`¦“p
(1);

127 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

128 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

129 if(
fd
 < 0){

130 
	`årštf
(
¡d”r
, "test-lab-3-b:‡ppend open(%s): %s\n",

131 
n
, 
	`¡»¼Ü
(
”ºo
));

132 
	`ex™
(1);

134 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

135 
	`årštf
(
¡d”r
, "test-lab-3-b:‡ppend write(%s): %s\n",

136 
n
, 
	`¡»¼Ü
(
”ºo
));

137 
	`ex™
(1);

139 if(
	`şo£
(
fd
) != 0){

140 
	`årštf
(
¡d”r
, "test-lab-3-b:‡ppend close(%s): %s\n",

141 
n
, 
	`¡»¼Ü
(
”ºo
));

142 
	`ex™
(1);

144 
	}
}

149 
	$wr™e1
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

151 
fd
;

152 
Çme
[512];

154 
	`¦“p
(1);

156 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

157 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
|
O_CREAT
, 0666);

158 ià(
fd
 < 0 && 
”ºo
 =ğ
EEXIST
)

159 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
, 0666);

160 if(
fd
 < 0){

161 
	`årštf
(
¡d”r
, "test-lab-3-b: open(%s): %s\n",

162 
Çme
, 
	`¡»¼Ü
(
”ºo
));

163 
	`ex™
(1);

165 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

166 
	`årštf
(
¡d”r
, "test-lab-3-b:†seek(%s, %d): %s\n",

167 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

168 
	`ex™
(1);

170 
i
 = 0; i < 
n
; i++){

171 if(
	`wr™e
(
fd
, &
c
, 1) != 1){

172 
	`årštf
(
¡d”r
, "test-lab-3-b: write(%s): %s\n",

173 
Çme
, 
	`¡»¼Ü
(
”ºo
));

174 
	`ex™
(1);

176 if(
	`fsync
(
fd
) != 0){

177 
	`årštf
(
¡d”r
, "test-lab-3-b: fsync(%s): %s\n",

178 
Çme
, 
	`¡»¼Ü
(
”ºo
));

179 
	`ex™
(1);

182 if(
	`şo£
(
fd
) != 0){

183 
	`årštf
(
¡d”r
, "test-lab-3-b: close(%s): %s\n",

184 
Çme
, 
	`¡»¼Ü
(
”ºo
));

185 
	`ex™
(1);

187 
	}
}

191 
	$check»ad
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

193 
fd
;

194 
Çme
[512];

196 
	`¦“p
(1);

198 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

199 
fd
 = 
	`İ’
(
Çme
, 0);

200 if(
fd
 < 0){

201 
	`årštf
(
¡d”r
, "test-lab-3-b: open(%s): %s\n",

202 
Çme
, 
	`¡»¼Ü
(
”ºo
));

203 
	`ex™
(1);

205 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

206 
	`årštf
(
¡d”r
, "test-lab-3-b:†seek(%s, %d): %s\n",

207 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

208 
	`ex™
(1);

210 
i
 = 0; i < 
n
; i++){

211 
xc
;

212 if(
	`»ad
(
fd
, &
xc
, 1) != 1){

213 
	`årštf
(
¡d”r
, "test-lab-3-b:„ead(%s): %s\n",

214 
Çme
, 
	`¡»¼Ü
(
”ºo
));

215 
	`ex™
(1);

217 if(
xc
 !ğ
c
){

218 
	`årštf
(
¡d”r
, "test-lab-3-b: checkread off %d %02x != %02x\n",

219 
¡¬t
 + 
i
, 
xc
, 
c
);

220 
	`ex™
(1);

223 
	`şo£
(
fd
);

224 
	}
}

228 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
, 
boŞ
 
possibË_dup
)

230 
fd
, 
i
;

231 
n
[512];

237 
	`¦“p
(1);

239 
i
 = 0; i < 
nf
; i++){

240 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

241 
fd
 = 
	`ü—t
(
n
, 0666);

242 ià(
fd
 < 0 && 
possibË_dup
 && 
”ºo
 =ğ
EEXIST
)

244 if(
fd
 < 0){

245 
	`årštf
(
¡d”r
, "test-lab-3-b: create(%s): %s\n",

246 
n
, 
	`¡»¼Ü
(
”ºo
));

247 
	`ex™
(1);

249 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

250 
	`årštf
(
¡d”r
, "test-lab-3-b: write(%s): %s\n",

251 
n
, 
	`¡»¼Ü
(
”ºo
));

252 
	`ex™
(1);

254 if(
	`şo£
(
fd
) != 0){

255 
	`årštf
(
¡d”r
, "test-lab-3-b: close(%s): %s\n",

256 
n
, 
	`¡»¼Ü
(
”ºo
));

257 
	`ex™
(1);

260 
	}
}

263 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

265 
fd
, 
i
, 
cc
, 
j
;

266 
n
[512];

268 
i
 = 0; i < 
nf
; i++){

269 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

270 
fd
 = 
	`İ’
(
n
, 0);

271 if(
fd
 < 0){

272 
	`årštf
(
¡d”r
, "test-lab-3-b: open(%s): %s\n",

273 
n
, 
	`¡»¼Ü
(
”ºo
));

274 
	`ex™
(1);

276 
j
 = -1;

277 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

278 if(
cc
 !ğ(
j
)){

279 
	`årštf
(
¡d”r
, "test-lab-3-b:„ead(%s)„eturnedoo†ittle %d%s%s\n",

280 
n
,

281 
cc
,

282 
”ºo
 ? ": " : "",

283 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

284 
	`ex™
(1);

286 if(
j
 !ğ
i
){

287 
	`årštf
(
¡d”r
, "test-lab-3-b: checkn %s contained %d‚ot %d\n",

288 
n
, 
j
, 
i
);

289 
	`ex™
(1);

291 
	`şo£
(
fd
);

293 
	}
}

296 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

298 
n
[512];

299 
i
;

301 
	`¦“p
(1);

303 
i
 = 0; i < 
nf
; i++){

304 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

305 if(
	`uÆšk
(
n
) != 0){

306 
	`årštf
(
¡d”r
, "test-lab-3-b: unlink(%s): %s\n",

307 
n
, 
	`¡»¼Ü
(
”ºo
));

308 
	`ex™
(1);

311 
	}
}

314 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

316 *
a
 = *(**)
xa
;

317 *
b
 = *(**)
xb
;

318  
	`¡rcmp
(
a
, 
b
);

319 
	}
}

322 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

324 
DIR
 *
dp
;

325 
dœ’t
 *
e
;

326 *
Çmes
[1000];

327 
Âames
 = 0, 
i
;

329 
dp
 = 
	`İ’dœ
(
d
);

330 if(
dp
 == 0){

331 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-b: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

332 
	`ex™
(1);

334 (
e
 = 
	`»addœ
(
dp
))){

335 if(
e
->
d_Çme
[0] != '.'){

336 if(
Âames
 >ğ(
Çmes
)/(names[0])){

337 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

339 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

340 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

341 
Âames
++;

344 
	`şo£dœ
(
dp
);

346 if(
nf
 !ğ
Âames
){

347 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-b: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

348 
	`ex™
(1);

352 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

353 
i
 = 0; i < 
Âames
-1; i++){

354 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

355 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-b: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

356 
	`ex™
(1);

360 
i
 = 0; i < 
Âames
; i++)

361 
	`ä“
(
Çmes
[
i
]);

362 
	}
}

365 
	$»­
 (
pid
)

367 
wpid
, 
¡©us
;

368 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

369 ià(
wpid
 < 0) {

370 
	`³¼Ü
("waitpid");

371 
	`ex™
(1);

373 ià(
wpid
 !ğ
pid
) {

374 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

375 
	`ex™
(1);

377 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

378 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

379 
	`ex™
(1);

381 
	}
}

384 
	$maš
(
¬gc
, *
¬gv
[])

386 
pid
, 
i
;

388 if(
¬gc
 != 3){

389 
	`årštf
(
¡d”r
, "Usage:est-lab-3-b dir1 dir2\n");

390 
	`ex™
(1);

393 
	`¥rštf
(
d1
, "%s/d%d", 
¬gv
[1], 
	`g‘pid
());

394 if(
	`mkdœ
(
d1
, 0777) != 0){

395 
	`årštf
(
¡d”r
, "test-lab-3-b: failed: mkdir(%s): %s\n",

396 
d1
, 
	`¡»¼Ü
(
”ºo
));

397 
	`ex™
(1);

399 
	`¥rštf
(
d2
, "%s/d%d", 
¬gv
[2], 
	`g‘pid
());

400 if(
	`acûss
(
d2
, 0) != 0){

401 
	`årštf
(
¡d”r
, "test-lab-3-b: failed:‡ccess(%s)‡fter mkdir %s: %s\n",

402 
d2
, 
d1
, 
	`¡»¼Ü
(
”ºo
));

403 
	`ex™
(1);

406 
	`£tbuf
(
¡dout
, 0);

408 
i
 = 0; i < (
big
)-1; i++)

409 
big
[
i
] = 'x';

410 
i
 = 0; i < (
huge
)-1; i++)

411 
huge
[
i
] = '0';

413 
	`´štf
("Createhen„ead: ");

414 
	`ü—‹1
(
d1
, "f1", "aaa");

415 
	`check1
(
d2
, "f1", "aaa");

416 
	`check1
(
d1
, "f1", "aaa");

417 
	`´štf
("OK\n");

419 
	`´štf
("Unlink: ");

420 
	`uÆšk1
(
d2
, "f1");

421 
	`ü—‹1
(
d1
, "fx1", "fxx");

422 
	`uÆšk1
(
d1
, "fx1");

423 
	`checknÙ
(
d1
, "f1");

424 
	`checknÙ
(
d2
, "f1");

425 
	`ü—‹1
(
d1
, "f2", "222");

426 
	`uÆšk1
(
d2
, "f2");

427 
	`checknÙ
(
d1
, "f2");

428 
	`checknÙ
(
d2
, "f2");

429 
	`ü—‹1
(
d1
, "f3", "333");

430 
	`check1
(
d2
, "f3", "333");

431 
	`check1
(
d1
, "f3", "333");

432 
	`uÆšk1
(
d1
, "f3");

433 
	`ü—‹1
(
d2
, "fx2", "22");

434 
	`uÆšk1
(
d2
, "fx2");

435 
	`checknÙ
(
d2
, "f3");

436 
	`checknÙ
(
d1
, "f3");

437 
	`´štf
("OK\n");

439 
	`´štf
("Append: ");

440 
	`ü—‹1
(
d2
, "f1", "aaa");

441 
	`­³nd1
(
d1
, "f1", "bbb");

442 
	`­³nd1
(
d2
, "f1", "ccc");

443 
	`check1
(
d1
, "f1", "aaabbbccc");

444 
	`check1
(
d2
, "f1", "aaabbbccc");

445 
	`´štf
("OK\n");

447 
	`´štf
("Readdir: ");

448 
	`dœcheck
(
d1
, 1);

449 
	`dœcheck
(
d2
, 1);

450 
	`uÆšk1
(
d1
, "f1");

451 
	`dœcheck
(
d1
, 0);

452 
	`dœcheck
(
d2
, 0);

453 
	`ü—‹1
(
d2
, "f2", "aaa");

454 
	`ü—‹1
(
d1
, "f3", "aaa");

455 
	`dœcheck
(
d1
, 2);

456 
	`dœcheck
(
d2
, 2);

457 
	`uÆšk1
(
d2
, "f2");

458 
	`dœcheck
(
d2
, 1);

459 
	`dœcheck
(
d1
, 1);

460 
	`uÆšk1
(
d2
, "f3");

461 
	`dœcheck
(
d1
, 0);

462 
	`dœcheck
(
d2
, 0);

463 
	`´štf
("OK\n");

465 
	`´štf
("Many sequential creates: ");

466 
	`ü—‹n
(
d1
, "¯", 10, 
çl£
);

467 
	`ü—‹n
(
d2
, "bb", 10, 
çl£
);

468 
	`dœcheck
(
d2
, 20);

469 
	`checkn
(
d2
, "bb", 10);

470 
	`checkn
(
d2
, "aa", 10);

471 
	`checkn
(
d1
, "aa", 10);

472 
	`checkn
(
d1
, "bb", 10);

473 
	`uÆškn
(
d1
, "aa", 10);

474 
	`uÆškn
(
d2
, "bb", 10);

475 
	`´štf
("OK\n");

477 
	`´štf
("Write 20000 bytes: ");

478 
	`ü—‹1
(
d1
, "bf", 
big
);

479 
	`check1
(
d1
, "bf", 
big
);

480 
	`check1
(
d2
, "bf", 
big
);

481 
	`uÆšk1
(
d1
, "bf");

482 
	`´štf
("OK\n");

484 
	`´štf
("Concurrent creates: ");

485 
pid
 = 
	`fÜk
();

486 if(
pid
 < 0){

487 
	`³¼Ü
("test-lab-3-b: fork");

488 
	`ex™
(1);

490 if(
pid
 == 0){

491 
	`ü—‹n
(
d2
, "xx", 20, 
çl£
);

492 
	`ex™
(0);

494 
	`ü—‹n
(
d1
, "yy", 20, 
çl£
);

495 
	`¦“p
(10);

496 
	`»­
(
pid
);

497 
	`dœcheck
(
d1
, 40);

498 
	`checkn
(
d1
, "xx", 20);

499 
	`checkn
(
d2
, "yy", 20);

500 
	`uÆškn
(
d1
, "xx", 20);

501 
	`uÆškn
(
d1
, "yy", 20);

502 
	`´štf
("OK\n");

504 
	`´štf
("Concurrent creates ofhe same file: ");

505 
pid
 = 
	`fÜk
();

506 if(
pid
 < 0){

507 
	`³¼Ü
("test-lab-3-b: fork");

508 
	`ex™
(1);

510 if(
pid
 == 0){

511 
	`ü—‹n
(
d2
, "zz", 20, 
Œue
);

512 
	`ex™
(0);

514 
	`ü—‹n
(
d1
, "zz", 20, 
Œue
);

515 
	`¦“p
(4);

516 
	`dœcheck
(
d1
, 20);

517 
	`»­
(
pid
);

518 
	`checkn
(
d1
, "zz", 20);

519 
	`checkn
(
d2
, "zz", 20);

520 
	`uÆškn
(
d1
, "zz", 20);

521 
	`´štf
("OK\n");

523 
	`´štf
("Concurrent create/delete: ");

524 
	`ü—‹n
(
d1
, "x1", 20, 
çl£
);

525 
	`ü—‹n
(
d2
, "x2", 20, 
çl£
);

526 
pid
 = 
	`fÜk
();

527 if(
pid
 < 0){

528 
	`³¼Ü
("test-lab-3-b: fork");

529 
	`ex™
(1);

531 if(
pid
 == 0){

532 
	`uÆškn
(
d2
, "x1", 20);

533 
	`ü—‹n
(
d1
, "x3", 20, 
çl£
);

534 
	`ex™
(0);

536 
	`ü—‹n
(
d1
, "x4", 20, 
çl£
);

537 
	`»­
(
pid
);

538 
	`uÆškn
(
d2
, "x2", 20);

539 
	`uÆškn
(
d2
, "x4", 20);

540 
	`uÆškn
(
d2
, "x3", 20);

541 
	`dœcheck
(
d1
, 0);

542 
	`´štf
("OK\n");

544 
	`´štf
("Concurrent creates, same file, same server: ");

545 
pid
 = 
	`fÜk
();

546 if(
pid
 < 0){

547 
	`³¼Ü
("test-lab-3-b: fork");

548 
	`ex™
(1);

550 if(
pid
 == 0){

551 
	`ü—‹n
(
d1
, "zz", 20, 
Œue
);

552 
	`ex™
(0);

554 
	`ü—‹n
(
d1
, "zz", 20, 
Œue
);

555 
	`¦“p
(2);

556 
	`dœcheck
(
d1
, 20);

557 
	`»­
(
pid
);

558 
	`checkn
(
d1
, "zz", 20);

559 
	`uÆškn
(
d1
, "zz", 20);

560 
	`´štf
("OK\n");

562 
	`´štf
("Concurrent writeso different…arts of same file: ");

563 
	`ü—‹1
(
d1
, "www", 
huge
);

564 
pid
 = 
	`fÜk
();

565 if(
pid
 < 0){

566 
	`³¼Ü
("test-lab-3-b: fork");

567 
	`ex™
(1);

569 if(
pid
 == 0){

570 
	`wr™e1
(
d2
, "www", 65536, 64, '2');

571 
	`ex™
(0);

573 
	`wr™e1
(
d1
, "www", 0, 64, '1');

574 
	`»­
(
pid
);

575 
	`check»ad
(
d1
, "www", 0, 64, '1');

576 
	`check»ad
(
d2
, "www", 0, 64, '1');

577 
	`check»ad
(
d1
, "www", 65536, 64, '2');

578 
	`check»ad
(
d2
, "www", 65536, 64, '2');

579 
	`´štf
("OK\n");

581 
	`´štf
("test-lab-3-b: Passed‡llests.\n");

583 
	`ex™
(0);

585 
	}
}

	@test-lab-3-c.c

10 
	~<¡dio.h
>

11 
	~<¡dlib.h
>

12 
	~<uni¡d.h
>

13 
	~<sys/time.h
>

14 
	~<sys/ty³s.h
>

15 
	~<sys/¡©.h
>

16 
	~<sys/wa™.h
>

17 
	~<dœ’t.h
>

18 
	~<¡ršg.h
>

19 
	~<fú.h
>

20 
	~<”ºo.h
>

22 
	gd1
[512], 
	gd2
[512];

23 
”ºo
;

26 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

28 
fd
;

29 
n
[512];

35 
	`¦“p
(1);

37 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

38 
fd
 = 
	`ü—t
(
n
, 0666);

39 if(
fd
 < 0){

40 
	`årštf
(
¡d”r
, "test-lab-3-c: create(%s): %s\n",

41 
n
, 
	`¡»¼Ü
(
”ºo
));

42 
	`ex™
(1);

44 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

45 
	`årštf
(
¡d”r
, "test-lab-3-c: write(%s): %s\n",

46 
n
, 
	`¡»¼Ü
(
”ºo
));

47 
	`ex™
(1);

49 if(
	`şo£
(
fd
) != 0){

50 
	`årštf
(
¡d”r
, "test-lab-3-c: close(%s): %s\n",

51 
n
, 
	`¡»¼Ü
(
”ºo
));

52 
	`ex™
(1);

54 
	}
}

57 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

59 
fd
, 
cc
;

60 
n
[512], 
buf
[512];

62 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

63 
fd
 = 
	`İ’
(
n
, 0);

64 if(
fd
 < 0){

65 
	`årštf
(
¡d”r
, "test-lab-3-c: open(%s): %s\n",

66 
n
, 
	`¡»¼Ü
(
”ºo
));

67 
	`ex™
(1);

69 
”ºo
 = 0;

70 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

71 if(
cc
 !ğ
	`¡¾’
(
š
)){

72 
	`årštf
(
¡d”r
, "test-lab-3-c:„ead(%s)„eturnedoo†ittle %d%s%s\n",

73 
n
,

74 
cc
,

75 
”ºo
 ? ": " : "",

76 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

77 
	`ex™
(1);

79 
	`şo£
(
fd
);

80 
buf
[
cc
] = '\0';

81 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(
n
)) != 0){

82 
	`årštf
(
¡d”r
, "test-lab-3-c:„ead(%s) got \"%s\",‚ot \"%s\"\n",

83 
n
, 
buf
, 
š
);

84 
	`ex™
(1);

86 
	}
}

89 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

91 
n
[512];

93 
	`¦“p
(1);

95 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

96 if(
	`uÆšk
(
n
) != 0){

97 
	`årštf
(
¡d”r
, "test-lab-3-c: unlink(%s): %s\n",

98 
n
, 
	`¡»¼Ü
(
”ºo
));

99 
	`ex™
(1);

101 
	}
}

104 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

106 
fd
;

107 
n
[512];

109 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

110 
fd
 = 
	`İ’
(
n
, 0);

111 if(
fd
 >= 0){

112 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-c: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

113 
	`ex™
(1);

115 
	}
}

118 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

120 
fd
;

121 
n
[512];

123 
	`¦“p
(1);

125 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

126 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

127 if(
fd
 < 0){

128 
	`årštf
(
¡d”r
, "test-lab-3-c:‡ppend open(%s): %s\n",

129 
n
, 
	`¡»¼Ü
(
”ºo
));

130 
	`ex™
(1);

132 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

133 
	`årštf
(
¡d”r
, "test-lab-3-c:‡ppend write(%s): %s\n",

134 
n
, 
	`¡»¼Ü
(
”ºo
));

135 
	`ex™
(1);

137 if(
	`şo£
(
fd
) != 0){

138 
	`årštf
(
¡d”r
, "test-lab-3-c:‡ppend close(%s): %s\n",

139 
n
, 
	`¡»¼Ü
(
”ºo
));

140 
	`ex™
(1);

142 
	}
}

145 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

147 
fd
, 
i
;

148 
n
[512];

154 
	`¦“p
(1);

156 
i
 = 0; i < 
nf
; i++){

157 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

158 
fd
 = 
	`ü—t
(
n
, 0666);

159 if(
fd
 < 0){

160 
	`årštf
(
¡d”r
, "test-lab-3-c: create(%s): %s\n",

161 
n
, 
	`¡»¼Ü
(
”ºo
));

162 
	`ex™
(1);

164 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

165 
	`årštf
(
¡d”r
, "test-lab-3-c: write(%s): %s\n",

166 
n
, 
	`¡»¼Ü
(
”ºo
));

167 
	`ex™
(1);

169 if(
	`şo£
(
fd
) != 0){

170 
	`årštf
(
¡d”r
, "test-lab-3-c: close(%s): %s\n",

171 
n
, 
	`¡»¼Ü
(
”ºo
));

172 
	`ex™
(1);

175 
	}
}

178 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

180 
fd
, 
i
, 
cc
, 
j
;

181 
n
[512];

183 
i
 = 0; i < 
nf
; i++){

184 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

185 
fd
 = 
	`İ’
(
n
, 0);

186 if(
fd
 < 0){

187 
	`årštf
(
¡d”r
, "test-lab-3-c: open(%s): %s\n",

188 
n
, 
	`¡»¼Ü
(
”ºo
));

189 
	`ex™
(1);

191 
j
 = -1;

192 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

193 if(
cc
 !ğ(
j
)){

194 
	`årštf
(
¡d”r
, "test-lab-3-c:„ead(%s)„eturnedoo†ittle %d%s%s\n",

195 
n
,

196 
cc
,

197 
”ºo
 ? ": " : "",

198 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

199 
	`ex™
(1);

201 if(
j
 !ğ
i
){

202 
	`årštf
(
¡d”r
, "test-lab-3-c: checkn %s contained %d‚ot %d\n",

203 
n
, 
j
, 
i
);

204 
	`ex™
(1);

206 
	`şo£
(
fd
);

208 
	}
}

211 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

213 
n
[512];

214 
i
;

216 
	`¦“p
(1);

218 
i
 = 0; i < 
nf
; i++){

219 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

220 if(
	`uÆšk
(
n
) != 0){

221 
	`årštf
(
¡d”r
, "test-lab-3-c: unlink(%s): %s\n",

222 
n
, 
	`¡»¼Ü
(
”ºo
));

223 
	`ex™
(1);

226 
	}
}

229 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

231 *
a
 = *(**)
xa
;

232 *
b
 = *(**)
xb
;

233  
	`¡rcmp
(
a
, 
b
);

234 
	}
}

237 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

239 
DIR
 *
dp
;

240 
dœ’t
 *
e
;

241 *
Çmes
[1000];

242 
Âames
 = 0, 
i
;

244 
dp
 = 
	`İ’dœ
(
d
);

245 if(
dp
 == 0){

246 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-c: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

247 
	`ex™
(1);

249 (
e
 = 
	`»addœ
(
dp
))){

250 if(
e
->
d_Çme
[0] != '.'){

251 if(
Âames
 >ğ(
Çmes
)/(names[0])){

252 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

254 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

255 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

256 
Âames
++;

259 
	`şo£dœ
(
dp
);

261 if(
nf
 !ğ
Âames
){

262 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-c: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

263 
	`ex™
(1);

267 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

268 
i
 = 0; i < 
Âames
-1; i++){

269 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

270 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-c: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

271 
	`ex™
(1);

275 
i
 = 0; i < 
Âames
; i++)

276 
	`ä“
(
Çmes
[
i
]);

277 
	}
}

280 
	$»­
 (
pid
)

282 
wpid
, 
¡©us
;

283 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

284 ià(
wpid
 < 0) {

285 
	`³¼Ü
("waitpid");

286 
	`ex™
(1);

288 ià(
wpid
 !ğ
pid
) {

289 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

290 
	`ex™
(1);

292 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

293 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

294 
	`ex™
(1);

296 
	}
}

299 
	$maš
(
¬gc
, *
¬gv
[])

301 
pid
;

303 if(
¬gc
 != 3){

304 
	`årštf
(
¡d”r
, "Usage:est-lab-3-c dir1 dir2\n");

305 
	`ex™
(1);

308 
	`¥rštf
(
d1
, "%s/da%d", 
¬gv
[1], 
	`g‘pid
());

309 if(
	`mkdœ
(
d1
, 0777) != 0){

310 
	`årštf
(
¡d”r
, "test-lab-3-c: failed: mkdir(%s): %s\n",

311 
d1
, 
	`¡»¼Ü
(
”ºo
));

312 
	`ex™
(1);

314 
	`¥rštf
(
d2
, "%s/db%d", 
¬gv
[2], 
	`g‘pid
());

315 if(
	`mkdœ
(
d2
, 0777) != 0){

316 
	`årštf
(
¡d”r
, "test-lab-3-c: failed: mkdir(%s): %s\n",

317 
d2
, 
	`¡»¼Ü
(
”ºo
));

318 
	`ex™
(1);

322 
dd
[512];

323 
	`¥rštf
(
dd
, "%s/da%d", 
¬gv
[2], 
	`g‘pid
());

324 if(
	`acûss
(
dd
, 0) != 0){

325 
	`årštf
(
¡d”r
, "test-lab-3-c: failed:‡ccess(%s)‡fter mkdir %s: %s\n",

326 
dd
, 
d1
, 
	`¡»¼Ü
(
”ºo
));

327 
	`ex™
(1);

331 
	`£tbuf
(
¡dout
, 0);

333 
	`´štf
("Create/delete in separate directories: ");

335 
pid
 = 
	`fÜk
();

336 if(
pid
 < 0){

337 
	`³¼Ü
("test-lab-3-c: fork");

338 
	`ex™
(1);

340 if(
pid
 == 0){

341 
	`ü—‹n
(
d2
, "xx", 100);

342 
	`uÆškn
(
d2
, "xx", 99);

343 
	`ex™
(0);

345 
	`ü—‹n
(
d1
, "yy", 100);

346 
	`uÆškn
(
d1
, "yy", 99);

347 
	`¦“p
(4);

348 
	`»­
(
pid
);

349 
	`dœcheck
(
d1
, 1);

350 
	`dœcheck
(
d2
, 1);

352 
	`´štf
("tests completed OK\n");

354 
	`ex™
(0);

356 
	}
}

	@test-lab-3-g.c

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<uni¡d.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty³s.h
>

14 
	~<sys/¡©.h
>

15 
	~<sys/wa™.h
>

16 
	~<dœ’t.h
>

17 
	~<¡ršg.h
>

18 
	~<fú.h
>

19 
	~<”ºo.h
>

21 
	gd1
[512], 
	gd2
[512];

22 
”ºo
;

24 
	gbig
[20001];

25 
	ghuge
[65536];

28 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

30 
fd
;

31 
n
[512];

37 
	`¦“p
(1);

39 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

40 
fd
 = 
	`ü—t
(
n
, 0666);

41 if(
fd
 < 0){

42 
	`årštf
(
¡d”r
, "test-lab-3-g: create(%s): %s\n",

43 
n
, 
	`¡»¼Ü
(
”ºo
));

44 
	`ex™
(1);

46 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

47 
	`årštf
(
¡d”r
, "test-lab-3-g: write(%s): %s\n",

48 
n
, 
	`¡»¼Ü
(
”ºo
));

49 
	`ex™
(1);

51 if(
	`şo£
(
fd
) != 0){

52 
	`årštf
(
¡d”r
, "test-lab-3-g: close(%s): %s\n",

53 
n
, 
	`¡»¼Ü
(
”ºo
));

54 
	`ex™
(1);

56 
	}
}

59 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

61 
fd
, 
cc
;

62 
n
[512], 
buf
[21000];

64 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

65 
fd
 = 
	`İ’
(
n
, 0);

66 if(
fd
 < 0){

67 
	`årštf
(
¡d”r
, "test-lab-3-g: open(%s): %s\n",

68 
n
, 
	`¡»¼Ü
(
”ºo
));

69 
	`ex™
(1);

71 
”ºo
 = 0;

72 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

73 if(
cc
 !ğ
	`¡¾’
(
š
)){

74 
	`årštf
(
¡d”r
, "test-lab-3-g:„ead(%s)„eturnedoo†ittle %d%s%s\n",

75 
n
,

76 
cc
,

77 
”ºo
 ? ": " : "",

78 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

79 
	`ex™
(1);

81 
	`şo£
(
fd
);

82 
buf
[
cc
] = '\0';

83 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(
n
)) != 0){

84 
	`årštf
(
¡d”r
, "test-lab-3-g:„ead(%s) got \"%s\",‚ot \"%s\"\n",

85 
n
, 
buf
, 
š
);

86 
	`ex™
(1);

88 
	}
}

91 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

93 
n
[512];

95 
	`¦“p
(1);

97 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

98 if(
	`uÆšk
(
n
) != 0){

99 
	`årštf
(
¡d”r
, "test-lab-3-g: unlink(%s): %s\n",

100 
n
, 
	`¡»¼Ü
(
”ºo
));

101 
	`ex™
(1);

103 
	}
}

106 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

108 
fd
;

109 
n
[512];

111 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

112 
fd
 = 
	`İ’
(
n
, 0);

113 if(
fd
 >= 0){

114 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-g: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

115 
	`ex™
(1);

117 
	}
}

120 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

122 
fd
;

123 
n
[512];

125 
	`¦“p
(1);

127 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

128 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

129 if(
fd
 < 0){

130 
	`årštf
(
¡d”r
, "test-lab-3-g:‡ppend open(%s): %s\n",

131 
n
, 
	`¡»¼Ü
(
”ºo
));

132 
	`ex™
(1);

134 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

135 
	`årštf
(
¡d”r
, "test-lab-3-g:‡ppend write(%s): %s\n",

136 
n
, 
	`¡»¼Ü
(
”ºo
));

137 
	`ex™
(1);

139 if(
	`şo£
(
fd
) != 0){

140 
	`årštf
(
¡d”r
, "test-lab-3-g:‡ppend close(%s): %s\n",

141 
n
, 
	`¡»¼Ü
(
”ºo
));

142 
	`ex™
(1);

144 
	}
}

149 
	$wr™e1
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

151 
fd
;

152 
Çme
[512];

154 
	`¦“p
(1);

156 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

157 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
|
O_CREAT
, 0666);

158 ià(
fd
 < 0 && 
”ºo
 =ğ
EEXIST
)

159 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
, 0666);

160 if(
fd
 < 0){

161 
	`årštf
(
¡d”r
, "test-lab-3-g: open(%s): %s\n",

162 
Çme
, 
	`¡»¼Ü
(
”ºo
));

163 
	`ex™
(1);

165 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

166 
	`årštf
(
¡d”r
, "test-lab-3-g:†seek(%s, %d): %s\n",

167 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

168 
	`ex™
(1);

170 
i
 = 0; i < 
n
; i++){

171 if(
	`wr™e
(
fd
, &
c
, 1) != 1){

172 
	`årštf
(
¡d”r
, "test-lab-3-g: write(%s): %s\n",

173 
Çme
, 
	`¡»¼Ü
(
”ºo
));

174 
	`ex™
(1);

176 if(
	`fsync
(
fd
) != 0){

177 
	`årštf
(
¡d”r
, "test-lab-3-g: fsync(%s): %s\n",

178 
Çme
, 
	`¡»¼Ü
(
”ºo
));

179 
	`ex™
(1);

182 if(
	`şo£
(
fd
) != 0){

183 
	`årštf
(
¡d”r
, "test-lab-3-g: close(%s): %s\n",

184 
Çme
, 
	`¡»¼Ü
(
”ºo
));

185 
	`ex™
(1);

187 
	}
}

191 
	$check»ad
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

193 
fd
;

194 
Çme
[512];

196 
	`¦“p
(1);

198 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

199 
fd
 = 
	`İ’
(
Çme
, 0);

200 if(
fd
 < 0){

201 
	`årštf
(
¡d”r
, "test-lab-3-g: open(%s): %s\n",

202 
Çme
, 
	`¡»¼Ü
(
”ºo
));

203 
	`ex™
(1);

205 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

206 
	`årštf
(
¡d”r
, "test-lab-3-g:†seek(%s, %d): %s\n",

207 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

208 
	`ex™
(1);

210 
i
 = 0; i < 
n
; i++){

211 
xc
;

212 if(
	`»ad
(
fd
, &
xc
, 1) != 1){

213 
	`årštf
(
¡d”r
, "test-lab-3-g:„ead(%s): %s\n",

214 
Çme
, 
	`¡»¼Ü
(
”ºo
));

215 
	`ex™
(1);

217 if(
xc
 !ğ
c
){

218 
	`årštf
(
¡d”r
, "test-lab-3-g: checkread off %d %02x != %02x\n",

219 
¡¬t
 + 
i
, 
xc
, 
c
);

220 
	`ex™
(1);

223 
	`şo£
(
fd
);

224 
	}
}

228 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
, 
boŞ
 
possibË_dup
)

230 
fd
, 
i
;

231 
n
[512];

237 
	`¦“p
(1);

239 
i
 = 0; i < 
nf
; i++){

240 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

241 
fd
 = 
	`ü—t
(
n
, 0666);

242 ià(
fd
 < 0 && 
possibË_dup
 && 
”ºo
 =ğ
EEXIST
)

244 if(
fd
 < 0){

245 
	`årštf
(
¡d”r
, "test-lab-3-g: create(%s): %s\n",

246 
n
, 
	`¡»¼Ü
(
”ºo
));

247 
	`ex™
(1);

249 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

250 
	`årštf
(
¡d”r
, "test-lab-3-g: write(%s): %s\n",

251 
n
, 
	`¡»¼Ü
(
”ºo
));

252 
	`ex™
(1);

254 if(
	`şo£
(
fd
) != 0){

255 
	`årštf
(
¡d”r
, "test-lab-3-g: close(%s): %s\n",

256 
n
, 
	`¡»¼Ü
(
”ºo
));

257 
	`ex™
(1);

260 
	}
}

263 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

265 
fd
, 
i
, 
cc
, 
j
;

266 
n
[512];

268 
i
 = 0; i < 
nf
; i++){

269 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

270 
fd
 = 
	`İ’
(
n
, 0);

271 if(
fd
 < 0){

272 
	`årštf
(
¡d”r
, "test-lab-3-g: open(%s): %s\n",

273 
n
, 
	`¡»¼Ü
(
”ºo
));

274 
	`ex™
(1);

276 
j
 = -1;

277 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

278 if(
cc
 !ğ(
j
)){

279 
	`årštf
(
¡d”r
, "test-lab-3-g:„ead(%s)„eturnedoo†ittle %d%s%s\n",

280 
n
,

281 
cc
,

282 
”ºo
 ? ": " : "",

283 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

284 
	`ex™
(1);

286 if(
j
 !ğ
i
){

287 
	`årštf
(
¡d”r
, "test-lab-3-g: checkn %s contained %d‚ot %d\n",

288 
n
, 
j
, 
i
);

289 
	`ex™
(1);

291 
	`şo£
(
fd
);

293 
	}
}

296 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

298 
n
[512];

299 
i
;

301 
	`¦“p
(1);

303 
i
 = 0; i < 
nf
; i++){

304 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

305 if(
	`uÆšk
(
n
) != 0){

306 
	`årštf
(
¡d”r
, "test-lab-3-g: unlink(%s): %s\n",

307 
n
, 
	`¡»¼Ü
(
”ºo
));

308 
	`ex™
(1);

311 
	}
}

314 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

316 *
a
 = *(**)
xa
;

317 *
b
 = *(**)
xb
;

318  
	`¡rcmp
(
a
, 
b
);

319 
	}
}

322 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

324 
DIR
 *
dp
;

325 
dœ’t
 *
e
;

326 *
Çmes
[1000];

327 
Âames
 = 0, 
i
;

329 
dp
 = 
	`İ’dœ
(
d
);

330 if(
dp
 == 0){

331 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-g: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

332 
	`ex™
(1);

334 (
e
 = 
	`»addœ
(
dp
))){

335 if(
e
->
d_Çme
[0] != '.'){

336 if(
Âames
 >ğ(
Çmes
)/(names[0])){

337 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

339 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

340 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

341 
Âames
++;

344 
	`şo£dœ
(
dp
);

346 if(
nf
 !ğ
Âames
){

347 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-g: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

348 
	`ex™
(1);

352 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

353 
i
 = 0; i < 
Âames
-1; i++){

354 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

355 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-g: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

356 
	`ex™
(1);

360 
i
 = 0; i < 
Âames
; i++)

361 
	`ä“
(
Çmes
[
i
]);

362 
	}
}

365 
	$»­
 (
pid
)

367 
wpid
, 
¡©us
;

368 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

369 ià(
wpid
 < 0) {

370 
	`³¼Ü
("waitpid");

371 
	`ex™
(1);

373 ià(
wpid
 !ğ
pid
) {

374 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

375 
	`ex™
(1);

377 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

378 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

379 
	`ex™
(1);

381 
	}
}

384 
	$maš
(
¬gc
, *
¬gv
[])

386 
pid
, 
i
;

388 if(
¬gc
 != 3){

389 
	`årštf
(
¡d”r
, "Usage:est-lab-3-g dir1 dir2\n");

390 
	`ex™
(1);

393 
	`¥rštf
(
d1
, "%s/d%d", 
¬gv
[1], 
	`g‘pid
());

394 if(
	`mkdœ
(
d1
, 0777) != 0){

395 
	`årštf
(
¡d”r
, "test-lab-3-g: failed: mkdir(%s): %s\n",

396 
d1
, 
	`¡»¼Ü
(
”ºo
));

397 
	`ex™
(1);

399 
	`¥rštf
(
d2
, "%s/d%d", 
¬gv
[2], 
	`g‘pid
());

400 if(
	`acûss
(
d2
, 0) != 0){

401 
	`årštf
(
¡d”r
, "test-lab-3-g: failed:‡ccess(%s)‡fter mkdir %s: %s\n",

402 
d2
, 
d1
, 
	`¡»¼Ü
(
”ºo
));

403 
	`ex™
(1);

406 
	`£tbuf
(
¡dout
, 0);

408 
i
 = 0; i < (
big
)-1; i++)

409 
big
[
i
] = 'x';

410 
i
 = 0; i < (
huge
)-1; i++)

411 
huge
[
i
] = '0';

413 
	`´štf
("Createhen„ead: ");

414 
	`ü—‹1
(
d1
, "f1", "aaa");

415 
	`check1
(
d2
, "f1", "aaa");

416 
	`check1
(
d1
, "f1", "aaa");

417 
	`´štf
("OK\n");

419 
	`´štf
("Unlink: ");

420 
	`uÆšk1
(
d2
, "f1");

421 
	`ü—‹1
(
d1
, "fx1", "fxx");

422 
	`uÆšk1
(
d1
, "fx1");

423 
	`checknÙ
(
d1
, "f1");

424 
	`checknÙ
(
d2
, "f1");

425 
	`ü—‹1
(
d1
, "f2", "222");

426 
	`uÆšk1
(
d2
, "f2");

427 
	`checknÙ
(
d1
, "f2");

428 
	`checknÙ
(
d2
, "f2");

429 
	`ü—‹1
(
d1
, "f3", "333");

430 
	`check1
(
d2
, "f3", "333");

431 
	`check1
(
d1
, "f3", "333");

432 
	`uÆšk1
(
d1
, "f3");

433 
	`ü—‹1
(
d2
, "fx2", "22");

434 
	`uÆšk1
(
d2
, "fx2");

435 
	`checknÙ
(
d2
, "f3");

436 
	`checknÙ
(
d1
, "f3");

437 
	`´štf
("OK\n");

439 
	`´štf
("Append: ");

440 
	`ü—‹1
(
d2
, "f1", "aaa");

441 
	`­³nd1
(
d1
, "f1", "bbb");

442 
	`­³nd1
(
d2
, "f1", "ccc");

443 
	`check1
(
d1
, "f1", "aaabbbccc");

444 
	`check1
(
d2
, "f1", "aaabbbccc");

445 
	`´štf
("OK\n");

447 
	`´štf
("Readdir: ");

448 
	`dœcheck
(
d1
, 1);

449 
	`dœcheck
(
d2
, 1);

450 
	`uÆšk1
(
d1
, "f1");

451 
	`dœcheck
(
d1
, 0);

452 
	`dœcheck
(
d2
, 0);

453 
	`ü—‹1
(
d2
, "f2", "aaa");

454 
	`ü—‹1
(
d1
, "f3", "aaa");

455 
	`dœcheck
(
d1
, 2);

456 
	`dœcheck
(
d2
, 2);

457 
	`uÆšk1
(
d2
, "f2");

458 
	`dœcheck
(
d2
, 1);

459 
	`dœcheck
(
d1
, 1);

460 
	`uÆšk1
(
d2
, "f3");

461 
	`dœcheck
(
d1
, 0);

462 
	`dœcheck
(
d2
, 0);

463 
	`´štf
("OK\n");

465 
	`´štf
("Many sequential creates: ");

466 
	`ü—‹n
(
d1
, "¯", 10, 
çl£
);

467 
	`ü—‹n
(
d2
, "bb", 10, 
çl£
);

468 
	`dœcheck
(
d2
, 20);

469 
	`checkn
(
d2
, "bb", 10);

470 
	`checkn
(
d2
, "aa", 10);

471 
	`checkn
(
d1
, "aa", 10);

472 
	`checkn
(
d1
, "bb", 10);

473 
	`uÆškn
(
d1
, "aa", 10);

474 
	`uÆškn
(
d2
, "bb", 10);

475 
	`´štf
("OK\n");

477 
	`´štf
("Write 20000 bytes: ");

478 
	`ü—‹1
(
d1
, "bf", 
big
);

479 
	`check1
(
d1
, "bf", 
big
);

480 
	`check1
(
d2
, "bf", 
big
);

481 
	`uÆšk1
(
d1
, "bf");

482 
	`´štf
("OK\n");

484 
	`´štf
("test-lab-3-g: Passed‡llests.\n");

486 
	`ex™
(0);

488 
	}
}

	@test-lab-4-a.c

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<uni¡d.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty³s.h
>

14 
	~<sys/¡©.h
>

15 
	~<sys/wa™.h
>

16 
	~<dœ’t.h
>

17 
	~<¡ršg.h
>

18 
	~<fú.h
>

19 
	~<”ºo.h
>

21 
	gd1
[512], 
	gd2
[512];

22 
”ºo
;

24 
	gbig
[20001];

25 
	ghuge
[65536];

28 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

30 
fd
;

31 
n
[512];

37 
	`¦“p
(1);

39 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

40 
fd
 = 
	`ü—t
(
n
, 0666);

41 if(
fd
 < 0){

42 
	`årštf
(
¡d”r
, "test-lab-4-a: create(%s): %s\n",

43 
n
, 
	`¡»¼Ü
(
”ºo
));

44 
	`ex™
(1);

46 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

47 
	`årštf
(
¡d”r
, "test-lab-4-a: write(%s): %s\n",

48 
n
, 
	`¡»¼Ü
(
”ºo
));

49 
	`ex™
(1);

51 if(
	`şo£
(
fd
) != 0){

52 
	`årštf
(
¡d”r
, "test-lab-4-a: close(%s): %s\n",

53 
n
, 
	`¡»¼Ü
(
”ºo
));

54 
	`ex™
(1);

56 
	}
}

59 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

61 
fd
, 
cc
;

62 
n
[512], 
buf
[21000];

64 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

65 
fd
 = 
	`İ’
(
n
, 0);

66 if(
fd
 < 0){

67 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

68 
n
, 
	`¡»¼Ü
(
”ºo
));

69 
	`ex™
(1);

71 
”ºo
 = 0;

72 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

73 if(
cc
 !ğ
	`¡¾’
(
š
)){

74 
	`årštf
(
¡d”r
, "test-lab-4-a:„ead(%s)„eturnedoo†ittle %d%s%s\n",

75 
n
,

76 
cc
,

77 
”ºo
 ? ": " : "",

78 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

79 
	`ex™
(1);

81 
	`şo£
(
fd
);

82 
buf
[
cc
] = '\0';

83 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(
n
)) != 0){

84 
	`årštf
(
¡d”r
, "test-lab-4-a:„ead(%s) got \"%s\",‚ot \"%s\"\n",

85 
n
, 
buf
, 
š
);

86 
	`ex™
(1);

88 
	}
}

91 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

93 
n
[512];

95 
	`¦“p
(1);

97 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

98 if(
	`uÆšk
(
n
) != 0){

99 
	`årštf
(
¡d”r
, "test-lab-4-a: unlink(%s): %s\n",

100 
n
, 
	`¡»¼Ü
(
”ºo
));

101 
	`ex™
(1);

103 
	}
}

106 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

108 
fd
;

109 
n
[512];

111 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

112 
fd
 = 
	`İ’
(
n
, 0);

113 if(
fd
 >= 0){

114 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

115 
	`ex™
(1);

117 
	}
}

120 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

122 
fd
;

123 
n
[512];

125 
	`¦“p
(1);

127 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

128 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

129 if(
fd
 < 0){

130 
	`årštf
(
¡d”r
, "test-lab-4-a:‡ppend open(%s): %s\n",

131 
n
, 
	`¡»¼Ü
(
”ºo
));

132 
	`ex™
(1);

134 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

135 
	`årštf
(
¡d”r
, "test-lab-4-a:‡ppend write(%s): %s\n",

136 
n
, 
	`¡»¼Ü
(
”ºo
));

137 
	`ex™
(1);

139 if(
	`şo£
(
fd
) != 0){

140 
	`årštf
(
¡d”r
, "test-lab-4-a:‡ppend close(%s): %s\n",

141 
n
, 
	`¡»¼Ü
(
”ºo
));

142 
	`ex™
(1);

144 
	}
}

149 
	$wr™e1
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

151 
fd
;

152 
Çme
[512];

154 
	`¦“p
(1);

156 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

157 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
|
O_CREAT
, 0666);

158 ià(
fd
 < 0 && 
”ºo
 =ğ
EEXIST
)

159 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
, 0666);

160 if(
fd
 < 0){

161 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

162 
Çme
, 
	`¡»¼Ü
(
”ºo
));

163 
	`ex™
(1);

165 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

166 
	`årštf
(
¡d”r
, "test-lab-4-a:†seek(%s, %d): %s\n",

167 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

168 
	`ex™
(1);

170 
i
 = 0; i < 
n
; i++){

171 if(
	`wr™e
(
fd
, &
c
, 1) != 1){

172 
	`årštf
(
¡d”r
, "test-lab-4-a: write(%s): %s\n",

173 
Çme
, 
	`¡»¼Ü
(
”ºo
));

174 
	`ex™
(1);

176 if(
	`fsync
(
fd
) != 0){

177 
	`årštf
(
¡d”r
, "test-lab-4-a: fsync(%s): %s\n",

178 
Çme
, 
	`¡»¼Ü
(
”ºo
));

179 
	`ex™
(1);

182 if(
	`şo£
(
fd
) != 0){

183 
	`årštf
(
¡d”r
, "test-lab-4-a: close(%s): %s\n",

184 
Çme
, 
	`¡»¼Ü
(
”ºo
));

185 
	`ex™
(1);

187 
	}
}

191 
	$check»ad
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

193 
fd
;

194 
Çme
[512];

196 
	`¦“p
(1);

198 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

199 
fd
 = 
	`İ’
(
Çme
, 0);

200 if(
fd
 < 0){

201 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

202 
Çme
, 
	`¡»¼Ü
(
”ºo
));

203 
	`ex™
(1);

205 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

206 
	`årštf
(
¡d”r
, "test-lab-4-a:†seek(%s, %d): %s\n",

207 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

208 
	`ex™
(1);

210 
i
 = 0; i < 
n
; i++){

211 
xc
;

212 if(
	`»ad
(
fd
, &
xc
, 1) != 1){

213 
	`årštf
(
¡d”r
, "test-lab-4-a:„ead(%s): %s\n",

214 
Çme
, 
	`¡»¼Ü
(
”ºo
));

215 
	`ex™
(1);

217 if(
xc
 !ğ
c
){

218 
	`årštf
(
¡d”r
, "test-lab-4-a: checkread off %d %02x != %02x\n",

219 
¡¬t
 + 
i
, 
xc
, 
c
);

220 
	`ex™
(1);

223 
	`şo£
(
fd
);

224 
	}
}

228 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
, 
boŞ
 
possibË_dup
)

230 
fd
, 
i
;

231 
n
[512];

237 
	`¦“p
(1);

239 
i
 = 0; i < 
nf
; i++){

240 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

241 
fd
 = 
	`ü—t
(
n
, 0666);

242 ià(
fd
 < 0 && 
possibË_dup
 && 
”ºo
 =ğ
EEXIST
)

244 if(
fd
 < 0){

245 
	`årštf
(
¡d”r
, "test-lab-4-a: create(%s): %s\n",

246 
n
, 
	`¡»¼Ü
(
”ºo
));

247 
	`ex™
(1);

249 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

250 
	`årštf
(
¡d”r
, "test-lab-4-a: write(%s): %s\n",

251 
n
, 
	`¡»¼Ü
(
”ºo
));

252 
	`ex™
(1);

254 if(
	`şo£
(
fd
) != 0){

255 
	`årštf
(
¡d”r
, "test-lab-4-a: close(%s): %s\n",

256 
n
, 
	`¡»¼Ü
(
”ºo
));

257 
	`ex™
(1);

260 
	}
}

263 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

265 
fd
, 
i
, 
cc
, 
j
;

266 
n
[512];

268 
i
 = 0; i < 
nf
; i++){

269 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

270 
fd
 = 
	`İ’
(
n
, 0);

271 if(
fd
 < 0){

272 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

273 
n
, 
	`¡»¼Ü
(
”ºo
));

274 
	`ex™
(1);

276 
j
 = -1;

277 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

278 if(
cc
 !ğ(
j
)){

279 
	`årštf
(
¡d”r
, "test-lab-4-a:„ead(%s)„eturnedoo†ittle %d%s%s\n",

280 
n
,

281 
cc
,

282 
”ºo
 ? ": " : "",

283 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

284 
	`ex™
(1);

286 if(
j
 !ğ
i
){

287 
	`årštf
(
¡d”r
, "test-lab-4-a: checkn %s contained %d‚ot %d\n",

288 
n
, 
j
, 
i
);

289 
	`ex™
(1);

291 
	`şo£
(
fd
);

293 
	}
}

296 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

298 
n
[512];

299 
i
;

301 
	`¦“p
(1);

303 
i
 = 0; i < 
nf
; i++){

304 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

305 if(
	`uÆšk
(
n
) != 0){

306 
	`årštf
(
¡d”r
, "test-lab-4-a: unlink(%s): %s\n",

307 
n
, 
	`¡»¼Ü
(
”ºo
));

308 
	`ex™
(1);

311 
	}
}

314 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

316 *
a
 = *(**)
xa
;

317 *
b
 = *(**)
xb
;

318  
	`¡rcmp
(
a
, 
b
);

319 
	}
}

322 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

324 
DIR
 *
dp
;

325 
dœ’t
 *
e
;

326 *
Çmes
[1000];

327 
Âames
 = 0, 
i
;

329 
dp
 = 
	`İ’dœ
(
d
);

330 if(
dp
 == 0){

331 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

332 
	`ex™
(1);

334 (
e
 = 
	`»addœ
(
dp
))){

335 if(
e
->
d_Çme
[0] != '.'){

336 if(
Âames
 >ğ(
Çmes
)/(names[0])){

337 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

339 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

340 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

341 
Âames
++;

344 
	`şo£dœ
(
dp
);

346 if(
nf
 !ğ
Âames
){

347 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

348 
	`ex™
(1);

352 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

353 
i
 = 0; i < 
Âames
-1; i++){

354 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

355 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

356 
	`ex™
(1);

360 
i
 = 0; i < 
Âames
; i++)

361 
	`ä“
(
Çmes
[
i
]);

362 
	}
}

365 
	$»­
 (
pid
)

367 
wpid
, 
¡©us
;

368 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

369 ià(
wpid
 < 0) {

370 
	`³¼Ü
("waitpid");

371 
	`ex™
(1);

373 ià(
wpid
 !ğ
pid
) {

374 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

375 
	`ex™
(1);

377 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

378 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

379 
	`ex™
(1);

381 
	}
}

384 
	$maš
(
¬gc
, *
¬gv
[])

386 
pid
, 
i
;

388 if(
¬gc
 != 3){

389 
	`årštf
(
¡d”r
, "Usage:est-lab-4-a dir1 dir2\n");

390 
	`ex™
(1);

393 
	`¥rštf
(
d1
, "%s/d%d", 
¬gv
[1], 
	`g‘pid
());

394 if(
	`mkdœ
(
d1
, 0777) != 0){

395 
	`årštf
(
¡d”r
, "test-lab-4-a: failed: mkdir(%s): %s\n",

396 
d1
, 
	`¡»¼Ü
(
”ºo
));

397 
	`ex™
(1);

399 
	`¥rštf
(
d2
, "%s/d%d", 
¬gv
[2], 
	`g‘pid
());

400 if(
	`acûss
(
d2
, 0) != 0){

401 
	`årštf
(
¡d”r
, "test-lab-4-a: failed:‡ccess(%s)‡fter mkdir %s: %s\n",

402 
d2
, 
d1
, 
	`¡»¼Ü
(
”ºo
));

403 
	`ex™
(1);

406 
	`£tbuf
(
¡dout
, 0);

408 
i
 = 0; i < (
big
)-1; i++)

409 
big
[
i
] = 'x';

410 
i
 = 0; i < (
huge
)-1; i++)

411 
huge
[
i
] = '0';

413 
	`´štf
("Createhen„ead: ");

414 
	`ü—‹1
(
d1
, "f1", "aaa");

415 
	`check1
(
d2
, "f1", "aaa");

416 
	`check1
(
d1
, "f1", "aaa");

417 
	`´štf
("OK\n");

419 
	`´štf
("Unlink: ");

420 
	`uÆšk1
(
d2
, "f1");

421 
	`ü—‹1
(
d1
, "fx1", "fxx");

422 
	`uÆšk1
(
d1
, "fx1");

423 
	`checknÙ
(
d1
, "f1");

424 
	`checknÙ
(
d2
, "f1");

425 
	`ü—‹1
(
d1
, "f2", "222");

426 
	`uÆšk1
(
d2
, "f2");

427 
	`checknÙ
(
d1
, "f2");

428 
	`checknÙ
(
d2
, "f2");

429 
	`ü—‹1
(
d1
, "f3", "333");

430 
	`check1
(
d2
, "f3", "333");

431 
	`check1
(
d1
, "f3", "333");

432 
	`uÆšk1
(
d1
, "f3");

433 
	`ü—‹1
(
d2
, "fx2", "22");

434 
	`uÆšk1
(
d2
, "fx2");

435 
	`checknÙ
(
d2
, "f3");

436 
	`checknÙ
(
d1
, "f3");

437 
	`´štf
("OK\n");

439 
	`´štf
("Append: ");

440 
	`ü—‹1
(
d2
, "f1", "aaa");

441 
	`­³nd1
(
d1
, "f1", "bbb");

442 
	`­³nd1
(
d2
, "f1", "ccc");

443 
	`check1
(
d1
, "f1", "aaabbbccc");

444 
	`check1
(
d2
, "f1", "aaabbbccc");

445 
	`´štf
("OK\n");

447 
	`´štf
("Readdir: ");

448 
	`dœcheck
(
d1
, 1);

449 
	`dœcheck
(
d2
, 1);

450 
	`uÆšk1
(
d1
, "f1");

451 
	`dœcheck
(
d1
, 0);

452 
	`dœcheck
(
d2
, 0);

453 
	`ü—‹1
(
d2
, "f2", "aaa");

454 
	`ü—‹1
(
d1
, "f3", "aaa");

455 
	`dœcheck
(
d1
, 2);

456 
	`dœcheck
(
d2
, 2);

457 
	`uÆšk1
(
d2
, "f2");

458 
	`dœcheck
(
d2
, 1);

459 
	`dœcheck
(
d1
, 1);

460 
	`uÆšk1
(
d2
, "f3");

461 
	`dœcheck
(
d1
, 0);

462 
	`dœcheck
(
d2
, 0);

463 
	`´štf
("OK\n");

465 
	`´štf
("Many sequential creates: ");

466 
	`ü—‹n
(
d1
, "¯", 10, 
çl£
);

467 
	`ü—‹n
(
d2
, "bb", 10, 
çl£
);

468 
	`dœcheck
(
d2
, 20);

469 
	`checkn
(
d2
, "bb", 10);

470 
	`checkn
(
d2
, "aa", 10);

471 
	`checkn
(
d1
, "aa", 10);

472 
	`checkn
(
d1
, "bb", 10);

473 
	`uÆškn
(
d1
, "aa", 10);

474 
	`uÆškn
(
d2
, "bb", 10);

475 
	`´štf
("OK\n");

477 
	`´štf
("Write 20000 bytes: ");

478 
	`ü—‹1
(
d1
, "bf", 
big
);

479 
	`check1
(
d1
, "bf", 
big
);

480 
	`check1
(
d2
, "bf", 
big
);

481 
	`uÆšk1
(
d1
, "bf");

482 
	`´štf
("OK\n");

484 
	`´štf
("Concurrent creates: ");

485 
pid
 = 
	`fÜk
();

486 if(
pid
 < 0){

487 
	`³¼Ü
("test-lab-4-a: fork");

488 
	`ex™
(1);

490 if(
pid
 == 0){

491 
	`ü—‹n
(
d2
, "xx", 10, 
çl£
);

492 
	`ex™
(0);

494 
	`ü—‹n
(
d1
, "yy", 10, 
çl£
);

495 
	`¦“p
(4);

496 
	`»­
(
pid
);

497 
	`dœcheck
(
d1
, 20);

498 
	`checkn
(
d1
, "xx", 10);

499 
	`checkn
(
d2
, "yy", 10);

500 
	`uÆškn
(
d1
, "xx", 10);

501 
	`uÆškn
(
d1
, "yy", 10);

502 
	`´štf
("OK\n");

504 
	`´štf
("Concurrent creates ofhe same file: ");

505 
pid
 = 
	`fÜk
();

506 if(
pid
 < 0){

507 
	`³¼Ü
("test-lab-4-a: fork");

508 
	`ex™
(1);

510 if(
pid
 == 0){

511 
	`ü—‹n
(
d2
, "zz", 10, 
Œue
);

512 
	`ex™
(0);

514 
	`ü—‹n
(
d1
, "zz", 10, 
Œue
);

515 
	`¦“p
(4);

516 
	`dœcheck
(
d1
, 10);

517 
	`»­
(
pid
);

518 
	`checkn
(
d1
, "zz", 10);

519 
	`checkn
(
d2
, "zz", 10);

520 
	`uÆškn
(
d1
, "zz", 10);

521 
	`´štf
("OK\n");

523 
	`´štf
("Concurrent create/delete: ");

524 
	`ü—‹n
(
d1
, "x1", 5, 
çl£
);

525 
	`ü—‹n
(
d2
, "x2", 5, 
çl£
);

526 
pid
 = 
	`fÜk
();

527 if(
pid
 < 0){

528 
	`³¼Ü
("test-lab-4-a: fork");

529 
	`ex™
(1);

531 if(
pid
 == 0){

532 
	`uÆškn
(
d2
, "x1", 5);

533 
	`ü—‹n
(
d1
, "x3", 5, 
çl£
);

534 
	`ex™
(0);

536 
	`ü—‹n
(
d1
, "x4", 5, 
çl£
);

537 
	`»­
(
pid
);

538 
	`uÆškn
(
d2
, "x2", 5);

539 
	`uÆškn
(
d2
, "x4", 5);

540 
	`uÆškn
(
d2
, "x3", 5);

541 
	`dœcheck
(
d1
, 0);

542 
	`´štf
("OK\n");

544 
	`´štf
("Concurrent creates, same file, same server: ");

545 
pid
 = 
	`fÜk
();

546 if(
pid
 < 0){

547 
	`³¼Ü
("test-lab-4-a: fork");

548 
	`ex™
(1);

550 if(
pid
 == 0){

551 
	`ü—‹n
(
d1
, "zz", 10, 
Œue
);

552 
	`ex™
(0);

554 
	`ü—‹n
(
d1
, "zz", 10, 
Œue
);

555 
	`¦“p
(2);

556 
	`dœcheck
(
d1
, 10);

557 
	`»­
(
pid
);

558 
	`checkn
(
d1
, "zz", 10);

559 
	`uÆškn
(
d1
, "zz", 10);

560 
	`´štf
("OK\n");

562 
	`´štf
("Concurrent writeso different…arts of same file: ");

563 
	`ü—‹1
(
d1
, "www", 
huge
);

564 
pid
 = 
	`fÜk
();

565 if(
pid
 < 0){

566 
	`³¼Ü
("test-lab-4-a: fork");

567 
	`ex™
(1);

569 if(
pid
 == 0){

570 
	`wr™e1
(
d2
, "www", 10000, 64, '2');

571 
	`ex™
(0);

573 
	`wr™e1
(
d1
, "www", 0, 64, '1');

574 
	`»­
(
pid
);

575 
	`check»ad
(
d1
, "www", 0, 64, '1');

576 
	`check»ad
(
d2
, "www", 0, 64, '1');

577 
	`check»ad
(
d1
, "www", 10000, 64, '2');

578 
	`check»ad
(
d2
, "www", 10000, 64, '2');

579 
	`´štf
("OK\n");

581 
	`´štf
("test-lab-4-a: Passed‡llests.\n");

583 
	`ex™
(0);

585 
	}
}

	@test-lab-4-b.c

10 
	~<¡dio.h
>

11 
	~<¡dlib.h
>

12 
	~<uni¡d.h
>

13 
	~<sys/time.h
>

14 
	~<sys/ty³s.h
>

15 
	~<sys/¡©.h
>

16 
	~<sys/wa™.h
>

17 
	~<dœ’t.h
>

18 
	~<¡ršg.h
>

19 
	~<fú.h
>

20 
	~<”ºo.h
>

22 
	gd1
[512], 
	gd2
[512];

23 
”ºo
;

26 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

28 
fd
;

29 
n
[512];

35 
	`¦“p
(1);

37 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

38 
fd
 = 
	`ü—t
(
n
, 0666);

39 if(
fd
 < 0){

40 
	`årštf
(
¡d”r
, "test-lab-4-b: create(%s): %s\n",

41 
n
, 
	`¡»¼Ü
(
”ºo
));

42 
	`ex™
(1);

44 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

45 
	`årštf
(
¡d”r
, "test-lab-4-b: write(%s): %s\n",

46 
n
, 
	`¡»¼Ü
(
”ºo
));

47 
	`ex™
(1);

49 if(
	`şo£
(
fd
) != 0){

50 
	`årštf
(
¡d”r
, "test-lab-4-b: close(%s): %s\n",

51 
n
, 
	`¡»¼Ü
(
”ºo
));

52 
	`ex™
(1);

54 
	}
}

57 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

59 
fd
, 
cc
;

60 
n
[512], 
buf
[512];

62 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

63 
fd
 = 
	`İ’
(
n
, 0);

64 if(
fd
 < 0){

65 
	`årštf
(
¡d”r
, "test-lab-4-b: open(%s): %s\n",

66 
n
, 
	`¡»¼Ü
(
”ºo
));

67 
	`ex™
(1);

69 
”ºo
 = 0;

70 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

71 if(
cc
 !ğ
	`¡¾’
(
š
)){

72 
	`årštf
(
¡d”r
, "test-lab-4-b:„ead(%s)„eturnedoo†ittle %d%s%s\n",

73 
n
,

74 
cc
,

75 
”ºo
 ? ": " : "",

76 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

77 
	`ex™
(1);

79 
	`şo£
(
fd
);

80 
buf
[
cc
] = '\0';

81 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(
n
)) != 0){

82 
	`årštf
(
¡d”r
, "test-lab-4-b:„ead(%s) got \"%s\",‚ot \"%s\"\n",

83 
n
, 
buf
, 
š
);

84 
	`ex™
(1);

86 
	}
}

89 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

91 
n
[512];

93 
	`¦“p
(1);

95 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

96 if(
	`uÆšk
(
n
) != 0){

97 
	`årštf
(
¡d”r
, "test-lab-4-b: unlink(%s): %s\n",

98 
n
, 
	`¡»¼Ü
(
”ºo
));

99 
	`ex™
(1);

101 
	}
}

104 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

106 
fd
;

107 
n
[512];

109 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

110 
fd
 = 
	`İ’
(
n
, 0);

111 if(
fd
 >= 0){

112 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-b: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

113 
	`ex™
(1);

115 
	}
}

118 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

120 
fd
;

121 
n
[512];

123 
	`¦“p
(1);

125 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

126 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

127 if(
fd
 < 0){

128 
	`årštf
(
¡d”r
, "test-lab-4-b:‡ppend open(%s): %s\n",

129 
n
, 
	`¡»¼Ü
(
”ºo
));

130 
	`ex™
(1);

132 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

133 
	`årštf
(
¡d”r
, "test-lab-4-b:‡ppend write(%s): %s\n",

134 
n
, 
	`¡»¼Ü
(
”ºo
));

135 
	`ex™
(1);

137 if(
	`şo£
(
fd
) != 0){

138 
	`årštf
(
¡d”r
, "test-lab-4-b:‡ppend close(%s): %s\n",

139 
n
, 
	`¡»¼Ü
(
”ºo
));

140 
	`ex™
(1);

142 
	}
}

145 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

147 
fd
, 
i
;

148 
n
[512];

154 
	`¦“p
(1);

156 
i
 = 0; i < 
nf
; i++){

157 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

158 
fd
 = 
	`ü—t
(
n
, 0666);

159 if(
fd
 < 0){

160 
	`årštf
(
¡d”r
, "test-lab-4-b: create(%s): %s\n",

161 
n
, 
	`¡»¼Ü
(
”ºo
));

162 
	`ex™
(1);

164 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

165 
	`årštf
(
¡d”r
, "test-lab-4-b: write(%s): %s\n",

166 
n
, 
	`¡»¼Ü
(
”ºo
));

167 
	`ex™
(1);

169 if(
	`şo£
(
fd
) != 0){

170 
	`årštf
(
¡d”r
, "test-lab-4-b: close(%s): %s\n",

171 
n
, 
	`¡»¼Ü
(
”ºo
));

172 
	`ex™
(1);

175 
	}
}

178 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

180 
fd
, 
i
, 
cc
, 
j
;

181 
n
[512];

183 
i
 = 0; i < 
nf
; i++){

184 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

185 
fd
 = 
	`İ’
(
n
, 0);

186 if(
fd
 < 0){

187 
	`årštf
(
¡d”r
, "test-lab-4-b: open(%s): %s\n",

188 
n
, 
	`¡»¼Ü
(
”ºo
));

189 
	`ex™
(1);

191 
j
 = -1;

192 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

193 if(
cc
 !ğ(
j
)){

194 
	`årštf
(
¡d”r
, "test-lab-4-b:„ead(%s)„eturnedoo†ittle %d%s%s\n",

195 
n
,

196 
cc
,

197 
”ºo
 ? ": " : "",

198 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

199 
	`ex™
(1);

201 if(
j
 !ğ
i
){

202 
	`årštf
(
¡d”r
, "test-lab-4-b: checkn %s contained %d‚ot %d\n",

203 
n
, 
j
, 
i
);

204 
	`ex™
(1);

206 
	`şo£
(
fd
);

208 
	}
}

211 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

213 
n
[512];

214 
i
;

216 
	`¦“p
(1);

218 
i
 = 0; i < 
nf
; i++){

219 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

220 if(
	`uÆšk
(
n
) != 0){

221 
	`årštf
(
¡d”r
, "test-lab-4-b: unlink(%s): %s\n",

222 
n
, 
	`¡»¼Ü
(
”ºo
));

223 
	`ex™
(1);

226 
	}
}

229 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

231 *
a
 = *(**)
xa
;

232 *
b
 = *(**)
xb
;

233  
	`¡rcmp
(
a
, 
b
);

234 
	}
}

237 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

239 
DIR
 *
dp
;

240 
dœ’t
 *
e
;

241 *
Çmes
[1000];

242 
Âames
 = 0, 
i
;

244 
dp
 = 
	`İ’dœ
(
d
);

245 if(
dp
 == 0){

246 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-b: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

247 
	`ex™
(1);

249 (
e
 = 
	`»addœ
(
dp
))){

250 if(
e
->
d_Çme
[0] != '.'){

251 if(
Âames
 >ğ(
Çmes
)/(names[0])){

252 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

254 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

255 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

256 
Âames
++;

259 
	`şo£dœ
(
dp
);

261 if(
nf
 !ğ
Âames
){

262 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-b: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

263 
	`ex™
(1);

267 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

268 
i
 = 0; i < 
Âames
-1; i++){

269 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

270 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-b: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

271 
	`ex™
(1);

275 
i
 = 0; i < 
Âames
; i++)

276 
	`ä“
(
Çmes
[
i
]);

277 
	}
}

280 
	$»­
 (
pid
)

282 
wpid
, 
¡©us
;

283 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

284 ià(
wpid
 < 0) {

285 
	`³¼Ü
("waitpid");

286 
	`ex™
(1);

288 ià(
wpid
 !ğ
pid
) {

289 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

290 
	`ex™
(1);

292 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

293 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

294 
	`ex™
(1);

296 
	}
}

299 
	$maš
(
¬gc
, *
¬gv
[])

301 
pid
;

303 if(
¬gc
 != 3){

304 
	`årštf
(
¡d”r
, "Usage:est-lab-4-b dir1 dir2\n");

305 
	`ex™
(1);

308 
	`¥rštf
(
d1
, "%s/da%d", 
¬gv
[1], 
	`g‘pid
());

309 if(
	`mkdœ
(
d1
, 0777) != 0){

310 
	`årštf
(
¡d”r
, "test-lab-4-b: failed: mkdir(%s): %s\n",

311 
d1
, 
	`¡»¼Ü
(
”ºo
));

312 
	`ex™
(1);

314 
	`¥rštf
(
d2
, "%s/db%d", 
¬gv
[2], 
	`g‘pid
());

315 if(
	`mkdœ
(
d2
, 0777) != 0){

316 
	`årštf
(
¡d”r
, "test-lab-4-b: failed: mkdir(%s): %s\n",

317 
d2
, 
	`¡»¼Ü
(
”ºo
));

318 
	`ex™
(1);

322 
dd
[512];

323 
	`¥rštf
(
dd
, "%s/da%d", 
¬gv
[2], 
	`g‘pid
());

324 if(
	`acûss
(
dd
, 0) != 0){

325 
	`årštf
(
¡d”r
, "test-lab-4-b: failed:‡ccess(%s)‡fter mkdir %s: %s\n",

326 
dd
, 
d1
, 
	`¡»¼Ü
(
”ºo
));

327 
	`ex™
(1);

331 
	`£tbuf
(
¡dout
, 0);

333 
	`´štf
("Create/delete in separate directories: ");

335 
pid
 = 
	`fÜk
();

336 if(
pid
 < 0){

337 
	`³¼Ü
("test-lab-4-b: fork");

338 
	`ex™
(1);

340 if(
pid
 == 0){

341 
	`ü—‹n
(
d2
, "xx", 10);

342 
	`uÆškn
(
d2
, "xx", 9);

343 
	`ex™
(0);

345 
	`ü—‹n
(
d1
, "yy", 10);

346 
	`uÆškn
(
d1
, "yy", 9);

347 
	`¦“p
(4);

348 
	`»­
(
pid
);

349 
	`dœcheck
(
d1
, 1);

350 
	`dœcheck
(
d2
, 1);

352 
	`´štf
("tests completed OK\n");

354 
	`ex™
(0);

356 
	}
}

	@test-lab-5.c

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<uni¡d.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty³s.h
>

14 
	~<sys/¡©.h
>

15 
	~<sys/wa™.h
>

16 
	~<dœ’t.h
>

17 
	~<¡ršg.h
>

18 
	~<fú.h
>

19 
	~<”ºo.h
>

21 
	gd1
[512], 
	gd2
[512];

22 
”ºo
;

24 
	gbig
[20001];

25 
	ghuge
[65536];

28 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

30 
fd
;

31 
n
[512];

37 
	`¦“p
(1);

39 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

40 
fd
 = 
	`ü—t
(
n
, 0666);

41 if(
fd
 < 0){

42 
	`årštf
(
¡d”r
, "test-lab-3-a: create(%s): %s\n",

43 
n
, 
	`¡»¼Ü
(
”ºo
));

44 
	`ex™
(1);

46 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

47 
	`årštf
(
¡d”r
, "test-lab-3-a: write(%s): %s\n",

48 
n
, 
	`¡»¼Ü
(
”ºo
));

49 
	`ex™
(1);

51 if(
	`şo£
(
fd
) != 0){

52 
	`årštf
(
¡d”r
, "test-lab-3-a: close(%s): %s\n",

53 
n
, 
	`¡»¼Ü
(
”ºo
));

54 
	`ex™
(1);

56 
	}
}

59 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

61 
fd
, 
cc
;

62 
n
[512], 
buf
[21000];

64 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

65 
fd
 = 
	`İ’
(
n
, 0);

66 if(
fd
 < 0){

67 
	`årštf
(
¡d”r
, "test-lab-3-a: open(%s): %s\n",

68 
n
, 
	`¡»¼Ü
(
”ºo
));

69 
	`ex™
(1);

71 
”ºo
 = 0;

72 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

73 if(
cc
 !ğ
	`¡¾’
(
š
)){

74 
	`årštf
(
¡d”r
, "test-lab-3-a:„ead(%s)„eturnedoo†ittle %d%s%s\n",

75 
n
,

76 
cc
,

77 
”ºo
 ? ": " : "",

78 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

79 
	`ex™
(1);

81 
	`şo£
(
fd
);

82 
buf
[
cc
] = '\0';

83 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(
n
)) != 0){

84 
	`årštf
(
¡d”r
, "test-lab-3-a:„ead(%s) got \"%s\",‚ot \"%s\"\n",

85 
n
, 
buf
, 
š
);

86 
	`ex™
(1);

88 
	}
}

91 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

93 
n
[512];

95 
	`¦“p
(1);

97 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

98 if(
	`uÆšk
(
n
) != 0){

99 
	`årštf
(
¡d”r
, "test-lab-3-a: unlink(%s): %s\n",

100 
n
, 
	`¡»¼Ü
(
”ºo
));

101 
	`ex™
(1);

103 
	}
}

106 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

108 
fd
;

109 
n
[512];

111 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

112 
fd
 = 
	`İ’
(
n
, 0);

113 if(
fd
 >= 0){

114 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-a: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

115 
	`ex™
(1);

117 
	}
}

120 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

122 
fd
;

123 
n
[512];

125 
	`¦“p
(1);

127 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

128 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

129 if(
fd
 < 0){

130 
	`årštf
(
¡d”r
, "test-lab-3-a:‡ppend open(%s): %s\n",

131 
n
, 
	`¡»¼Ü
(
”ºo
));

132 
	`ex™
(1);

134 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

135 
	`årštf
(
¡d”r
, "test-lab-3-a:‡ppend write(%s): %s\n",

136 
n
, 
	`¡»¼Ü
(
”ºo
));

137 
	`ex™
(1);

139 if(
	`şo£
(
fd
) != 0){

140 
	`årštf
(
¡d”r
, "test-lab-3-a:‡ppend close(%s): %s\n",

141 
n
, 
	`¡»¼Ü
(
”ºo
));

142 
	`ex™
(1);

144 
	}
}

149 
	$wr™e1
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

151 
fd
;

152 
Çme
[512];

154 
	`¦“p
(1);

156 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

157 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
|
O_CREAT
, 0666);

158 ià(
fd
 < 0 && 
”ºo
 =ğ
EEXIST
)

159 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
, 0666);

160 if(
fd
 < 0){

161 
	`årštf
(
¡d”r
, "test-lab-3-a: open(%s): %s\n",

162 
Çme
, 
	`¡»¼Ü
(
”ºo
));

163 
	`ex™
(1);

165 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

166 
	`årštf
(
¡d”r
, "test-lab-3-a:†seek(%s, %d): %s\n",

167 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

168 
	`ex™
(1);

170 
i
 = 0; i < 
n
; i++){

171 if(
	`wr™e
(
fd
, &
c
, 1) != 1){

172 
	`årštf
(
¡d”r
, "test-lab-3-a: write(%s): %s\n",

173 
Çme
, 
	`¡»¼Ü
(
”ºo
));

174 
	`ex™
(1);

176 if(
	`fsync
(
fd
) != 0){

177 
	`årštf
(
¡d”r
, "test-lab-3-a: fsync(%s): %s\n",

178 
Çme
, 
	`¡»¼Ü
(
”ºo
));

179 
	`ex™
(1);

182 if(
	`şo£
(
fd
) != 0){

183 
	`årštf
(
¡d”r
, "test-lab-3-a: close(%s): %s\n",

184 
Çme
, 
	`¡»¼Ü
(
”ºo
));

185 
	`ex™
(1);

187 
	}
}

191 
	$check»ad
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

193 
fd
;

194 
Çme
[512];

196 
	`¦“p
(1);

198 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

199 
fd
 = 
	`İ’
(
Çme
, 0);

200 if(
fd
 < 0){

201 
	`årštf
(
¡d”r
, "test-lab-3-a: open(%s): %s\n",

202 
Çme
, 
	`¡»¼Ü
(
”ºo
));

203 
	`ex™
(1);

205 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

206 
	`årštf
(
¡d”r
, "test-lab-3-a:†seek(%s, %d): %s\n",

207 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

208 
	`ex™
(1);

210 
i
 = 0; i < 
n
; i++){

211 
xc
;

212 if(
	`»ad
(
fd
, &
xc
, 1) != 1){

213 
	`årštf
(
¡d”r
, "test-lab-3-a:„ead(%s): %s\n",

214 
Çme
, 
	`¡»¼Ü
(
”ºo
));

215 
	`ex™
(1);

217 if(
xc
 !ğ
c
){

218 
	`årštf
(
¡d”r
, "test-lab-3-a: checkread off %d %02x != %02x\n",

219 
¡¬t
 + 
i
, 
xc
, 
c
);

220 
	`ex™
(1);

223 
	`şo£
(
fd
);

224 
	}
}

228 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
, 
boŞ
 
possibË_dup
)

230 
fd
, 
i
;

231 
n
[512];

237 
	`¦“p
(1);

239 
i
 = 0; i < 
nf
; i++){

240 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

241 
fd
 = 
	`ü—t
(
n
, 0666);

242 ià(
fd
 < 0 && 
possibË_dup
 && 
”ºo
 =ğ
EEXIST
)

244 if(
fd
 < 0){

245 
	`årštf
(
¡d”r
, "test-lab-3-a: create(%s): %s\n",

246 
n
, 
	`¡»¼Ü
(
”ºo
));

247 
	`ex™
(1);

249 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

250 
	`årštf
(
¡d”r
, "test-lab-3-a: write(%s): %s\n",

251 
n
, 
	`¡»¼Ü
(
”ºo
));

252 
	`ex™
(1);

254 if(
	`şo£
(
fd
) != 0){

255 
	`årštf
(
¡d”r
, "test-lab-3-a: close(%s): %s\n",

256 
n
, 
	`¡»¼Ü
(
”ºo
));

257 
	`ex™
(1);

260 
	}
}

263 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

265 
fd
, 
i
, 
cc
, 
j
;

266 
n
[512];

268 
i
 = 0; i < 
nf
; i++){

269 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

270 
fd
 = 
	`İ’
(
n
, 0);

271 if(
fd
 < 0){

272 
	`årštf
(
¡d”r
, "test-lab-3-a: open(%s): %s\n",

273 
n
, 
	`¡»¼Ü
(
”ºo
));

274 
	`ex™
(1);

276 
j
 = -1;

277 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

278 if(
cc
 !ğ(
j
)){

279 
	`årštf
(
¡d”r
, "test-lab-3-a:„ead(%s)„eturnedoo†ittle %d%s%s\n",

280 
n
,

281 
cc
,

282 
”ºo
 ? ": " : "",

283 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

284 
	`ex™
(1);

286 if(
j
 !ğ
i
){

287 
	`årštf
(
¡d”r
, "test-lab-3-a: checkn %s contained %d‚ot %d\n",

288 
n
, 
j
, 
i
);

289 
	`ex™
(1);

291 
	`şo£
(
fd
);

293 
	}
}

296 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

298 
n
[512];

299 
i
;

301 
	`¦“p
(1);

303 
i
 = 0; i < 
nf
; i++){

304 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

305 if(
	`uÆšk
(
n
) != 0){

306 
	`årštf
(
¡d”r
, "test-lab-3-a: unlink(%s): %s\n",

307 
n
, 
	`¡»¼Ü
(
”ºo
));

308 
	`ex™
(1);

311 
	}
}

314 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

316 *
a
 = *(**)
xa
;

317 *
b
 = *(**)
xb
;

318  
	`¡rcmp
(
a
, 
b
);

319 
	}
}

322 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

324 
DIR
 *
dp
;

325 
dœ’t
 *
e
;

326 *
Çmes
[1000];

327 
Âames
 = 0, 
i
;

329 
dp
 = 
	`İ’dœ
(
d
);

330 if(
dp
 == 0){

331 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-a: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

332 
	`ex™
(1);

334 (
e
 = 
	`»addœ
(
dp
))){

335 if(
e
->
d_Çme
[0] != '.'){

336 if(
Âames
 >ğ(
Çmes
)/(names[0])){

337 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

339 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

340 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

341 
Âames
++;

344 
	`şo£dœ
(
dp
);

346 if(
nf
 !ğ
Âames
){

347 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-a: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

348 
	`ex™
(1);

352 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

353 
i
 = 0; i < 
Âames
-1; i++){

354 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

355 
	`årštf
(
¡d”r
, "‹¡-Ïb-3-a: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

356 
	`ex™
(1);

360 
i
 = 0; i < 
Âames
; i++)

361 
	`ä“
(
Çmes
[
i
]);

362 
	}
}

365 
	$»­
 (
pid
)

367 
wpid
, 
¡©us
;

368 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

369 ià(
wpid
 < 0) {

370 
	`³¼Ü
("waitpid");

371 
	`ex™
(1);

373 ià(
wpid
 !ğ
pid
) {

374 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

375 
	`ex™
(1);

377 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

378 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

379 
	`ex™
(1);

381 
	}
}

383 
	gv”
 = 0;

384 
	$comm™
()

386 
	`sy¡em
("./yfs-version -c");

387 
	`´štf
("comm™, cu¼’ˆv”siÚ %d\n", 
v”
++);

388 
	}
}

390 
	$´e
()

392 
	`sy¡em
("./yfs-version -p");

393 
	`´štf
("undo, cu¼’ˆv”siÚ %d\n", --
v”
);

394 
	}
}

396 
	$Ãxt
()

398 
	`sy¡em
("./yfs-version -n");

399 
	`´štf
("»do, cu¼’ˆv”siÚ %d\n", ++
v”
);

400 
	}
}

403 
	$maš
(
¬gc
, *
¬gv
[])

405 
pid
, 
i
;

407 if(
¬gc
 != 2){

408 
	`årštf
(
¡d”r
, "Usage:est-lab-3-a dir1 dir2\n");

409 
	`ex™
(1);

412 
	`¥rštf
(
d1
, "%s/d%d", 
¬gv
[1], 
	`g‘pid
());

413 if(
	`mkdœ
(
d1
, 0777) != 0){

414 
	`årštf
(
¡d”r
, "test-lab-3-a: failed: mkdir(%s): %s\n",

415 
d1
, 
	`¡»¼Ü
(
”ºo
));

416 
	`ex™
(1);

425 
	`£tbuf
(
¡dout
, 0);

427 
i
 = 0; i < (
big
)-1; i++)

428 
big
[
i
] = 'x';

429 
i
 = 0; i < (
huge
)-1; i++)

430 
huge
[
i
] = '0';

432 
	`´štf
("===Initialize: \n");

433 
	`´štf
("Createhen„ead... ");

434 
	`ü—‹1
(
d1
, "f1", "aaa");

435 
	`comm™
();

436 
	`check1
(
d1
, "f1", "aaa");

438 
	`´štf
("Unlink... ");

440 
	`uÆšk1
(
d1
, "f1");

441 
	`ü—‹1
(
d1
, "fx1", "fxx");

442 
	`uÆšk1
(
d1
, "fx1");

443 
	`ü—‹1
(
d1
, "f2", "222");

444 
	`uÆšk1
(
d1
, "f2");

445 
	`ü—‹1
(
d1
, "f3", "333");

446 
	`check1
(
d1
, "f3", "333");

447 
	`uÆšk1
(
d1
, "f3");

448 
	`comm™
();

449 
	`checknÙ
(
d1
, "f1");

450 
	`checknÙ
(
d1
, "f2");

451 
	`checknÙ
(
d1
, "f3");

453 
	`´štf
("Append... ");

454 
	`ü—‹1
(
d1
, "f1", "aaa");

455 
	`­³nd1
(
d1
, "f1", "bbb");

456 
	`­³nd1
(
d1
, "f1", "ccc");

457 
	`comm™
();

458 
	`check1
(
d1
, "f1", "aaabbbccc");

459 
	`dœcheck
(
d1
, 1);

461 
	`´štf
("Readdir... ");

462 
	`uÆšk1
(
d1
, "f1");

463 
	`comm™
();

464 
	`dœcheck
(
d1
, 0);

466 
	`´štf
("Many sequential creates... ");

467 
	`ü—‹n
(
d1
, "¯", 10, 
çl£
);

468 
	`ü—‹n
(
d1
, "bb", 10, 
çl£
);

469 
	`comm™
();

470 
	`dœcheck
(
d1
, 20);

471 
	`checkn
(
d1
, "aa", 10);

472 
	`checkn
(
d1
, "bb", 10);

473 
	`uÆškn
(
d1
, "aa", 10);

475 
	`´štf
("Write 20000 bytes... ");

476 
	`ü—‹1
(
d1
, "bf", 
big
);

477 
	`comm™
();

478 
	`check1
(
d1
, "bf", 
big
);

479 
	`uÆšk1
(
d1
, "bf");

482 
	`´štf
("===Undoest:\n");

483 
	`´e
();

484 
	`check1
(
d1
, "bf", 
big
);

486 
	`´e
();

487 
	`dœcheck
(
d1
, 20);

488 
	`checkn
(
d1
, "aa", 10);

489 
	`checkn
(
d1
, "bb", 10);

491 
	`´e
();

492 
	`dœcheck
(
d1
, 0);

494 
	`´e
();

495 
	`check1
(
d1
, "f1", "aaabbbccc");

496 
	`dœcheck
(
d1
, 1);

498 
	`´e
();

499 
	`checknÙ
(
d1
, "f1");

500 
	`checknÙ
(
d1
, "f2");

501 
	`checknÙ
(
d1
, "f3");

503 
	`´e
();

504 
	`check1
(
d1
, "f1", "aaa");

505 
	`´štf
("Pass Undo Test\n");

507 
	`´štf
("===Redoest:\n");

509 
	`Ãxt
();

510 
	`checknÙ
(
d1
, "f1");

511 
	`checknÙ
(
d1
, "f2");

512 
	`checknÙ
(
d1
, "f3");

514 
	`Ãxt
();

515 
	`check1
(
d1
, "f1", "aaabbbccc");

516 
	`dœcheck
(
d1
, 1);

518 
	`Ãxt
();

519 
	`dœcheck
(
d1
, 0);

521 
	`Ãxt
();

522 
	`dœcheck
(
d1
, 20);

523 
	`checkn
(
d1
, "aa", 10);

524 
	`checkn
(
d1
, "bb", 10);

526 
	`Ãxt
();

527 
	`check1
(
d1
, "bf", 
big
);

528 
	`´štf
("Pass Redo Test\n");

531 
	}
}

	@test_lab_7.cc

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<uni¡d.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty³s.h
>

14 
	~<sys/¡©.h
>

15 
	~<sys/wa™.h
>

16 
	~<dœ’t.h
>

17 
	~<¡ršg.h
>

18 
	~<fú.h
>

19 
	~<”ºo.h
>

20 
	~<time.h
>

22 
	~<sys/shm.h
>

23 
	~<sys/c.h
>

25 
	~"yfs_ş›Á.h
"

27 
	gd1
[512], 
	gd2
[512];

28 
	gd0
[512], 
	gd3
[512];

29 
”ºo
;

31 
	gnÜm®
[1000];

32 
	gbig
[20001];

33 
	ghuge
[65536];

35 
	#LAB_ERR
(
fmt
, 
¬gs
...è
	`årštf
(
¡d”r
,"‹¡-Ïb-6:" fmt, ##¬gs)

	)

38 
	$chmod1
(* 
d
, cÚ¡ * 
f
, 
mode
)

40 
Çme
[512];

41 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

42 
”ºo
 = 0;

43 ià(
	`chmod
(
Çme
, 
mode
) != 0) {

44  
”ºo
;

47 
	}
}

49 
	$chown1
(* 
d
, cÚ¡ * 
f
, 
u_id
, 
g_id
)

51 
Çme
[512];

52 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

53 
”ºo
 = 0;

54 ià(
	`chown
(
Çme
, 
u_id
, 
g_id
) != 0) {

55  
”ºo
;

58 
	}
}

60 
	$mkdœm
(cÚ¡ *
d
, cÚ¡ *
f
, 
mode
)

62 
fd
;

63 
n
[512];

64 
	`¦“p
(1);

65 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

66 
fd
 = 
	`mkdœ
(
n
,
mode
);

67 ià(
fd
 < 0) {

68 
	`LAB_ERR
("create(%s):%s\n",

69 
n
, 
	`¡»¼Ü
(
”ºo
));

70 
	`ex™
(1);

72 
	`şo£
(
fd
);

73 
	}
}

75 
	$ü—‹m
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
, 
mode
)

77 
fd
;

78 
n
[512];

84 
	`¦“p
(1);

86 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

87 
fd
 = 
	`ü—t
(
n
, 
mode
);

88 if(
fd
 < 0){

89 
	`LAB_ERR
("create(%s): %s\n",

90 
n
, 
	`¡»¼Ü
(
”ºo
));

91 
	`ex™
(1);

94 
	`şo£
(
fd
);

95 
	}
}

98 
	$ü—‹1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

100 
fd
;

101 
n
[512];

107 
	`¦“p
(1);

109 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

110 
fd
 = 
	`ü—t
(
n
, 0666);

111 if(
fd
 < 0){

112 
	`årštf
(
¡d”r
, "test-lab-6: create(%s): %s\n",

113 
n
, 
	`¡»¼Ü
(
”ºo
));

114 
	`ex™
(1);

116 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

117 
	`årštf
(
¡d”r
, "test-lab-6: write(%s): %s\n",

118 
n
, 
	`¡»¼Ü
(
”ºo
));

119 
	`ex™
(1);

121 if(
	`şo£
(
fd
) != 0){

122 
	`årštf
(
¡d”r
, "test-lab-6: close(%s): %s\n",

123 
n
, 
	`¡»¼Ü
(
”ºo
));

124 
	`ex™
(1);

126 
	}
}

129 
	$check1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

131 
fd
, 
cc
;

132 
n
[512], 
buf
[21000];

134 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

135 
fd
 = 
	`İ’
(
n
, 0);

136 if(
fd
 < 0){

137 
	`årštf
(
¡d”r
, "test-lab-5: open(%s): %s\n",

138 
n
, 
	`¡»¼Ü
(
”ºo
));

139 
	`ex™
(1);

141 
”ºo
 = 0;

142 
cc
 = 
	`»ad
(
fd
, 
buf
, (buf) - 1);

143 if(
cc
 !ğ
	`¡¾’
(
š
)){

144 
	`årštf
(
¡d”r
, "test-lab-5:„ead(%s)„eturnedoo†ittle %d%s%s\n",

145 
n
,

146 
cc
,

147 
”ºo
 ? ": " : "",

148 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

149 
	`ex™
(1);

151 
	`şo£
(
fd
);

152 
buf
[
cc
] = '\0';

154 if(
	`¡ºcmp
(
buf
, 
š
, 
	`¡¾’
(in)) != 0){

155 
	`årštf
(
¡d”r
, "test-lab-5:„ead(%s) got \"%s\",‚ot \"%s\"\n",

156 
n
, 
buf
, 
š
);

157 
	`ex™
(1);

159 
	}
}

162 
	$uÆšk1
(cÚ¡ *
d
, cÚ¡ *
f
)

164 
n
[512];

166 
	`¦“p
(1);

168 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

169 if(
	`uÆšk
(
n
) != 0){

170 
	`årštf
(
¡d”r
, "test-lab-5: unlink(%s): %s\n",

171 
n
, 
	`¡»¼Ü
(
”ºo
));

172 
	`ex™
(1);

174 
	}
}

177 
	$checknÙ
(cÚ¡ *
d
, cÚ¡ *
f
)

179 
fd
;

180 
n
[512];

182 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

183 
fd
 = 
	`İ’
(
n
, 0);

184 if(
fd
 >= 0){

185 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: o³n(%sèsucûeded fÜ d–‘ed fe\n", 
n
);

186 
	`ex™
(1);

188 
	}
}

191 
	$­³nd1
(cÚ¡ *
d
, cÚ¡ *
f
, cÚ¡ *
š
)

193 
fd
;

194 
n
[512];

196 
	`¦“p
(1);

198 
	`¥rštf
(
n
, "%s/%s", 
d
, 
f
);

199 
fd
 = 
	`İ’
(
n
, 
O_WRONLY
|
O_APPEND
);

200 if(
fd
 < 0){

201 
	`årštf
(
¡d”r
, "test-lab-4-a:‡ppend open(%s): %s\n",

202 
n
, 
	`¡»¼Ü
(
”ºo
));

203 
	`ex™
(1);

205 if(
	`wr™e
(
fd
, 
š
, 
	`¡¾’
(in)) != strlen(in)){

206 
	`årštf
(
¡d”r
, "test-lab-4-a:‡ppend write(%s): %s\n",

207 
n
, 
	`¡»¼Ü
(
”ºo
));

208 
	`ex™
(1);

210 if(
	`şo£
(
fd
) != 0){

211 
	`årštf
(
¡d”r
, "test-lab-4-a:‡ppend close(%s): %s\n",

212 
n
, 
	`¡»¼Ü
(
”ºo
));

213 
	`ex™
(1);

215 
	}
}

220 
	$wr™e1
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

222 
fd
;

223 
Çme
[512];

225 
	`¦“p
(1);

227 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

228 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
|
O_CREAT
, 0666);

229 ià(
fd
 < 0 && 
”ºo
 =ğ
EEXIST
)

230 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
, 0666);

231 if(
fd
 < 0){

232 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

233 
Çme
, 
	`¡»¼Ü
(
”ºo
));

234 
	`ex™
(1);

236 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

237 
	`årštf
(
¡d”r
, "test-lab-4-a:†seek(%s, %d): %s\n",

238 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

239 
	`ex™
(1);

241 
i
 = 0; i < 
n
; i++){

242 if(
	`wr™e
(
fd
, &
c
, 1) != 1){

243 
	`årštf
(
¡d”r
, "test-lab-4-a: write(%s): %s\n",

244 
Çme
, 
	`¡»¼Ü
(
”ºo
));

245 
	`ex™
(1);

247 if(
	`fsync
(
fd
) != 0){

248 
	`årštf
(
¡d”r
, "test-lab-4-a: fsync(%s): %s\n",

249 
Çme
, 
	`¡»¼Ü
(
”ºo
));

250 
	`ex™
(1);

253 if(
	`şo£
(
fd
) != 0){

254 
	`årštf
(
¡d”r
, "test-lab-4-a: close(%s): %s\n",

255 
Çme
, 
	`¡»¼Ü
(
”ºo
));

256 
	`ex™
(1);

258 
	}
}

262 
	$check»ad
(cÚ¡ *
d
, cÚ¡ *
f
, 
¡¬t
, 
n
, 
c
)

264 
fd
;

265 
Çme
[512];

267 
	`¦“p
(1);

269 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

270 
fd
 = 
	`İ’
(
Çme
, 0);

271 if(
fd
 < 0){

272 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

273 
Çme
, 
	`¡»¼Ü
(
”ºo
));

274 
	`ex™
(1);

276 if(
	`l£ek
(
fd
, 
¡¬t
, 0è!ğ(
off_t
) start){

277 
	`årštf
(
¡d”r
, "test-lab-4-a:†seek(%s, %d): %s\n",

278 
Çme
, 
¡¬t
, 
	`¡»¼Ü
(
”ºo
));

279 
	`ex™
(1);

281 
i
 = 0; i < 
n
; i++){

282 
xc
;

283 if(
	`»ad
(
fd
, &
xc
, 1) != 1){

284 
	`årštf
(
¡d”r
, "test-lab-4-a:„ead(%s): %s\n",

285 
Çme
, 
	`¡»¼Ü
(
”ºo
));

286 
	`ex™
(1);

288 if(
xc
 !ğ
c
){

289 
	`årštf
(
¡d”r
, "test-lab-4-a: checkread off %d %02x != %02x\n",

290 
¡¬t
 + 
i
, 
xc
, 
c
);

291 
	`ex™
(1);

294 
	`şo£
(
fd
);

295 
	}
}

299 
	$ü—‹n
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
, 
boŞ
 
possibË_dup
)

301 
fd
, 
i
;

302 
n
[512];

308 
	`¦“p
(1);

310 
i
 = 0; i < 
nf
; i++){

311 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

312 
fd
 = 
	`ü—t
(
n
, 0666);

313 ià(
fd
 < 0 && 
possibË_dup
 && 
”ºo
 =ğ
EEXIST
)

315 if(
fd
 < 0){

316 
	`årštf
(
¡d”r
, "test-lab-4-a: create(%s): %s\n",

317 
n
, 
	`¡»¼Ü
(
”ºo
));

318 
	`ex™
(1);

320 if(
	`wr™e
(
fd
, &
i
, (i)) != (i)){

321 
	`årštf
(
¡d”r
, "test-lab-4-a: write(%s): %s\n",

322 
n
, 
	`¡»¼Ü
(
”ºo
));

323 
	`ex™
(1);

325 if(
	`şo£
(
fd
) != 0){

326 
	`årštf
(
¡d”r
, "test-lab-4-a: close(%s): %s\n",

327 
n
, 
	`¡»¼Ü
(
”ºo
));

328 
	`ex™
(1);

331 
	}
}

334 
	$checkn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

336 
fd
, 
i
, 
cc
, 
j
;

337 
n
[512];

339 
i
 = 0; i < 
nf
; i++){

340 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

341 
fd
 = 
	`İ’
(
n
, 0);

342 if(
fd
 < 0){

343 
	`årštf
(
¡d”r
, "test-lab-4-a: open(%s): %s\n",

344 
n
, 
	`¡»¼Ü
(
”ºo
));

345 
	`ex™
(1);

347 
j
 = -1;

348 
cc
 = 
	`»ad
(
fd
, &
j
, (j));

349 if(
cc
 !ğ(
j
)){

350 
	`årštf
(
¡d”r
, "test-lab-4-a:„ead(%s)„eturnedoo†ittle %d%s%s\n",

351 
n
,

352 
cc
,

353 
”ºo
 ? ": " : "",

354 
”ºo
 ? 
	`¡»¼Ü
(errno) : "");

355 
	`ex™
(1);

357 if(
j
 !ğ
i
){

358 
	`årštf
(
¡d”r
, "test-lab-4-a: checkn %s contained %d‚ot %d\n",

359 
n
, 
j
, 
i
);

360 
	`ex™
(1);

362 
	`şo£
(
fd
);

364 
	}
}

367 
	$uÆškn
(cÚ¡ *
d
, cÚ¡ *
´efix
, 
nf
)

369 
n
[512];

370 
i
;

372 
	`¦“p
(1);

374 
i
 = 0; i < 
nf
; i++){

375 
	`¥rštf
(
n
, "%s/%s-%d", 
d
, 
´efix
, 
i
);

376 if(
	`uÆšk
(
n
) != 0){

377 
	`årštf
(
¡d”r
, "test-lab-4-a: unlink(%s): %s\n",

378 
n
, 
	`¡»¼Ü
(
”ºo
));

379 
	`ex™
(1);

382 
	}
}

385 
	$com·r
(cÚ¡ *
xa
, cÚ¡ *
xb
)

387 *
a
 = *(**)
xa
;

388 *
b
 = *(**)
xb
;

389  
	`¡rcmp
(
a
, 
b
);

390 
	}
}

393 
	$dœcheck
(cÚ¡ *
d
, 
nf
)

395 
DIR
 *
dp
;

396 
dœ’t
 *
e
;

397 *
Çmes
[1000];

398 
Âames
 = 0, 
i
;

400 
dp
 = 
	`İ’dœ
(
d
);

401 if(
dp
 == 0){

402 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: o³ndœ(%s): %s\n", 
d
, 
	`¡»¼Ü
(
”ºo
));

403 
	`ex™
(1);

405 (
e
 = 
	`»addœ
(
dp
))){

406 if(
e
->
d_Çme
[0] != '.'){

407 if(
Âames
 >ğ(
Çmes
)/(names[0])){

408 
	`årštf
(
¡d”r
, "w¬nšg:oØmªy fe š %s\n", 
d
);

410 
Çmes
[
Âames
] = (*è
	`m®loc
(
	`¡¾’
(
e
->
d_Çme
) + 1);

411 
	`¡rıy
(
Çmes
[
Âames
], 
e
->
d_Çme
);

412 
Âames
++;

415 
	`şo£dœ
(
dp
);

417 if(
nf
 !ğ
Âames
){

418 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: wª‹d %d dœƒÁr›s, gÙ %d\n", 
nf
, 
Âames
);

419 
	`ex™
(1);

423 
	`qsÜt
(
Çmes
, 
Âames
, Òames[0]), 
com·r
);

424 
i
 = 0; i < 
Âames
-1; i++){

425 if(
	`¡rcmp
(
Çmes
[
i
],‚ames[i+1]) == 0){

426 
	`årštf
(
¡d”r
, "‹¡-Ïb-4-a: du¶iÿ‹ dœeùÜyƒÁry fÜ %s\n", 
Çmes
[
i
]);

427 
	`ex™
(1);

431 
i
 = 0; i < 
Âames
; i++)

432 
	`ä“
(
Çmes
[
i
]);

433 
	}
}

436 
	$»­
 (
pid
)

438 
wpid
, 
¡©us
;

439 
wpid
 = 
	`wa™pid
 (
pid
, &
¡©us
, 0);

440 ià(
wpid
 < 0) {

441 
	`³¼Ü
("waitpid");

442 
	`ex™
(1);

444 ià(
wpid
 !ğ
pid
) {

445 
	`årštf
(
¡d”r
, "uÃx³ùed…id„—³d: %d\n", 
wpid
);

446 
	`ex™
(1);

448 if(!
	`WIFEXITED
(
¡©us
è|| 
	`WEXITSTATUS
(status) != 0) {

449 
	`årštf
(
¡d”r
, "childƒxited unhappily\n");

450 
	`ex™
(1);

452 
	}
}

454 
	#PATH
 "/tmp"

	)

455 
	#BUFFER_SIZE
 16

	)

456 
	#ID
 1

	)

459 
	$cİyfe
(cÚ¡ * 
¤c
, * 
de¡
)

461 
ch
;

462 
FILE
 *
p¤c
, *
pde¡
;

464 
p¤c
 = 
	`fİ’
(
¤c
, "r");

465 ià(
p¤c
 =ğ
NULL
) {

466 
	`´štf
("İ’ % ”rÜ\n", 
¤c
);

470 
pde¡
 = 
	`fİ’
(
de¡
, "w");

471 ià(
pde¡
 =ğ
NULL
) {

472 
	`´štf
("İ’ % ”rÜ\n", 
de¡
);

476 (
ch
=
	`g‘c
(
p¤c
)è!ğ
EOF
) {

477 
	`åutc
(
ch
, 
pde¡
);

479 
	`fşo£
(
p¤c
);

480 
	`fşo£
(
pde¡
);

482 
	}
}

483 
yfs_ş›Á
 *
	g‹¡
;

485 
	gyfs_ş›Á
::
¡©us


486 
	$v”ify
(cÚ¡ * 
Çme
, *
id
)

488 
yfs_ş›Á
::
¡©us
 
¡
;

489 
»t
;

492 
»t
 = 
	`cİyfe
(
Çme
, "test.pem");

493 ià(
»t
!=0) {

494 
	`´štf
("cİy % ”rÜ\n", 
Çme
);

497 
¡
 = 
‹¡
->
	`v”ify
("‹¡.³m", 
id
);

499  
¡
;

500 
	}
}

503 
	$»adm
(*
d
, cÚ¡ *
f
)

505 
fd
;

506 
Çme
[512];

507 
c
;

509 
	`¦“p
(1);

511 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

512 
”ºo
 = 0;

514 
fd
 = 
	`İ’
(
Çme
, 0);

515 ià(
fd
 < 0) {

516  
”ºo
;

519 ià(
	`»ad
(
fd
, &
c
, 1) != 1) {

520  
”ºo
;

523 
	`şo£
(
fd
);

527 
	}
}

528 
	$»addœm
(*
d
, cÚ¡ *
d1
)

530 
n
[512];

531 
DIR
 *
dp
;

532 
dœ’t
 *
’Œy
;

533 
	`¥rštf
(
n
, "%s/%s", 
d
, 
d1
);

535 ià((
dp
=
	`İ’dœ
(
n
)è=ğ
NULL
) {

536  
”ºo
;

538 ià((
’Œy
=
	`»addœ
(
dp
)è=ğ
NULL
) {

539  
”ºo
;

542 
	}
}

544 
	$wr™edœm
(*
d
, cÚ¡ * 
d1
, cÚ¡ * 
fe
, cÚ¡ * 
dœ
)

546 
n1
[512], 
n2
[512];

547 
	`¥rštf
(
n1
, "%s/%s/%s", 
d
, 
d1
, 
fe
);

548 
	`¥rštf
(
n2
, "%s/%s/%s", 
d
, 
d1
, 
dœ
);

549 ià(
	`ü—t
(
n1
, 0666) < 0) {

550  
”ºo
;

552 ià(
	`mkdœ
(
n2
, 0777) < 0) {

553  
”ºo
;

556 
	}
}

558 
	$wr™em
(*
d
, cÚ¡ *
f
, 
n
, 
c
)

560 
fd
;

561 
Çme
[512];

563 
	`¦“p
(1);

565 
	`¥rštf
(
Çme
, "%s/%s", 
d
, 
f
);

566 
”ºo
 = 0;

567 
fd
 = 
	`İ’
(
Çme
, 
O_WRONLY
);

568 ià(
fd
 < 0) {

569  
”ºo
;

572 
i
=0; i<
n
; i++) {

573 ià(
	`wr™e
(
fd
, &
c
, 1) != 1) {

574  
”ºo
;

578 ià(
	`şo£
(
fd
) != 0) {

579  
”ºo
;

583 
	}
}

586 
	$maš
(
¬gc
, *
¬gv
[])

588 
pid
, 
i
;

590 *
shmAddr
;

591 
key_t
 
key
;

592 
shmid
;

594 
tmaúame
[16];

595 
ba£Çme
[5];

596 
tmaúum
;

599 
uid
;

600 
»t
;

601 
û¹num
, 
f’um
, 
dœnum
;

602 
û¹num
 = 0;

603 
f’um
 = 0;

604 
dœnum
 = 0;

605 
yfs_ş›Á
::
¡©us
 
¡
;

607 
key
 = 
	`áok
(
PATH
, 
ID
);

608 
shmid
 = 
	`shmg‘
(
key
, 
BUFFER_SIZE
, 0666|
IPC_CREAT
);

609 if(
shmid
 == -1)

611 
	`´štf
("FILE %s†ine %d:share memory get %s\n",

612 
__FILE__
, 
__LINE__
, 
	`¡»¼Ü
(
”ºo
));

613 
	`ex™
(1);

617 
‹¡
 = 
Ãw
 
	`yfs_ş›Á
();

619 
	`´štf
("Certificate verification:\n");

621 
	`´štf
("Legal certificate:");

622 
¡
 = 
	`v”ify
("./û¹/roÙ.³m", &
uid
);

623 ià(
¡
 !ğ
yfs_ş›Á
::
OK
 || 
uid
 != 0) {

624 
	`´štf
("ERROR\n");

626 
¡
 = 
	`v”ify
("./û¹/u£r1.³m", &
uid
);

627 ià(
¡
 !ğ
yfs_ş›Á
::
OK
 || 
uid
 != 1003) {

628 
	`´štf
("ERROR\n");

630 
	`´štf
("OK\n");

631 
û¹num
++;

636 
	`´štf
("Wrong Format:");

637 
¡
 = 
	`v”ify
("./û¹/”rÜ.³m", &
uid
);

638 ià(
¡
 !ğ
yfs_ş›Á
::
ERRPEM
) {

639 
	`´štf
("ERROR\n");

641 
	`´štf
("OK\n");

642 
û¹num
++;

645 
	`´štf
("Ilegal CA:");

646 
¡
 = 
	`v”ify
("./û¹/çke_roÙ.³m", &
uid
);

647 ià(
¡
 !ğ
yfs_ş›Á
::
EINVA
) {

648 
	`´štf
("ERROR\n");

650 
	`´štf
("OK\n");

651 
û¹num
++;

654 
	`´štf
("Expired:");

655 
¡
 = 
	`v”ify
("./û¹/time.³m", &
uid
);

656 ià(
¡
 !ğ
yfs_ş›Á
::
ECTIM
) {

657 
	`´štf
("ERROR\n");

659 
	`´štf
("OK\n");

660 
û¹num
++;

663 
	`´štf
("ScÜe: %d/40\n\n", 
û¹num
*10);

668 
	`¥rštf
(
d0
, "%s/d%d", "./yfs0", 
	`g‘pid
());

669 
	`¥rštf
(
d1
, "%s/d%d", "./yfs1", 
	`g‘pid
());

670 
	`¥rštf
(
d2
, "%s/d%d", "./yfs2", 
	`g‘pid
());

671 
	`¥rštf
(
d3
, "%s/d%d", "./yfs3", 
	`g‘pid
());

672 ià(
	`mkdœ
(
d1
, 0777) != 0) {

673 
	`LAB_ERR
("failed: mkdir(%s):%s\n",

674 
d1
, 
	`¡»¼Ü
(
”ºo
));

675 
	`ex™
(1);

678 
	`´štf
("Test File Permission:\n");

680 
	`ü—‹m
(
d1
, "a", "", 0666);

681 
	`ü—‹m
(
d1
, "r", "", 0666);

682 
	`ü—‹m
(
d1
, "w", "", 0666);

683 
	`ü—‹m
(
d1
, "n", "", 0666);

684 
	`ü—‹m
(
d1
, "gr", "", 0666);

685 
	`ü—‹m
(
d1
, "gw", "", 0666);

686 
	`ü—‹m
(
d1
, "gn", "", 0666);

687 
	`ü—‹m
(
d1
, "or", "", 0666);

688 
	`ü—‹m
(
d1
, "ow", "", 0666);

689 
	`ü—‹m
(
d1
, "on", "", 0666);

690 
	`mkdœm
(
d1
, "da", 0777);

691 
	`mkdœm
(
d1
, "dr", 0777);

692 
	`mkdœm
(
d1
, "dw", 0777);

693 
	`mkdœm
(
d1
, "dga", 0777);

694 
	`mkdœm
(
d1
, "dgr", 0777);

695 
	`mkdœm
(
d1
, "dgw", 0777);

696 
	`mkdœm
(
d1
, "doa", 0777);

697 
	`mkdœm
(
d1
, "dor", 0777);

698 
	`mkdœm
(
d1
, "dow", 0777);

700 iàĞ(
»t
 = 
	`wr™em
(
d1
, "a", 64, '1')) != 0) {

701 
wr™e_”rÜ
;

705 iàĞ(
»t
 = 
	`wr™em
(
d1
, "w", 64, '1')) != 0) {

706 
wr™e_”rÜ
;

708 
	`´štf
(" owner write PASSED\n");

709 
f’um
 ++;

710 
wr™e_ok
;

711 
wr™e_”rÜ
:

712 
	`´štf
(" owner write ERROR\n");

713 
wr™e_ok
:

715 iàĞ(
»t
 = 
	`»adm
(
d1
, "a")) != 0) {

716 
»ad_”rÜ
;

718 iàĞ(
»t
 = 
	`»adm
(
d1
, "r")) != 0) {

719 
»ad_”rÜ
;

722 
	`´štf
(" owner„ead PASSED\n");

723 
f’um
 ++;

724 
»ad_ok
;

726 
»ad_”rÜ
:

727 
	`´štf
(" owner„ead ERROR\n");

728 
»ad_ok
:

730 iàĞ(
»t
 = 
	`wr™em
(
d2
, "a", 64, '1')) != 0) {

731 
wr™eg_”rÜ
;

735 iàĞ(
»t
 = 
	`wr™em
(
d2
, "gw", 64, '1')) != 0) {

736 
wr™eg_”rÜ
;

738 
	`´štf
(" group write PASSED\n");

739 
f’um
 ++;

740 
wr™eg_ok
;

741 
wr™eg_”rÜ
:

742 
	`´štf
(" group write ERROR\n");

743 
wr™eg_ok
:

745 iàĞ(
»t
 = 
	`»adm
(
d2
, "a")) != 0) {

746 
»adg_”rÜ
;

748 iàĞ(
»t
 = 
	`»adm
(
d2
, "gr")) != 0) {

749 
»adg_”rÜ
;

752 
	`´štf
(" group„ead PASSED\n");

753 
f’um
 ++;

754 
»adg_ok
;

755 
»adg_”rÜ
:

756 
	`´štf
(" group„ead ERROR\n");

757 
»adg_ok
:

759 iàĞ(
»t
 = 
	`wr™em
(
d3
, "a", 64, '1')) != 0) {

760 
wr™eo_”rÜ
;

764 iàĞ(
»t
 = 
	`wr™em
(
d3
, "ow", 64, '1')) != 0) {

765 
wr™eo_”rÜ
;

767 
	`´štf
(" other write PASSED\n");

768 
f’um
 ++;

769 
wr™eo_ok
;

771 
wr™eo_”rÜ
:

772 
	`´štf
(" other write ERROR\n");

773 
wr™eo_ok
:

775 iàĞ(
»t
 = 
	`»adm
(
d3
, "a")) != 0) {

776 
»ado_”rÜ
;

778 iàĞ(
»t
 = 
	`»adm
(
d3
, "or")) != 0) {

779 
»ado_”rÜ
;

782 
	`´štf
(" other„ead PASSED\n");

783 
f’um
 ++;

784 
»ado_ok
;

785 
»ado_”rÜ
:

786 
	`´štf
(" other„ead ERROR\n");

787 
»ado_ok
:

789 
	`ü—‹m
(
d1
, "ch", "", 0666);

790 ià(
	`»adm
(
d1
, "ch") != 0) {

791 
chmod_”rÜ
;

793 ià(
	`wr™em
(
d1
, "ch", 64, '1') != 0) {

794 
chmod_”rÜ
;

796 ià((
»t
 = 
	`chmod1
(
d1
, "ch", 0420)) != 0) {

797 
chmod_”rÜ
;

800 ià((
»t
=
	`wr™em
(
d1
, "ch", 64, '1')è!ğ
EACCES
) {

801 
chmod_”rÜ
;

803 ià((
»t
=
	`»adm
(
d2
, "ch")è!ğ
EACCES
) {

804 
chmod_”rÜ
;

806 ià((
»t
=
	`»adm
(
d3
, "ch")è!ğ
EACCES
) {

807 
chmod_”rÜ
;

809 ià((
»t
=
	`wr™em
(
d3
, "ch", 64, '1')è!ğ
EACCES
) {

810 
chmod_”rÜ
;

812 
	`´štf
(" owner chmod PASSED\n");

813 
f’um
 ++;

814 
chmod_ok
;

815 
chmod_”rÜ
:

816 
	`´štf
(" owner chmod ERROR\n");

817 
chmod_ok
:

819 ià(
	`chmod1
(
d2
, "ch", 0666è!ğ
EACCES
) {

820 
chmodo_”rÜ
;

823 ià(
	`chmod1
(
d3
, "ch", 0666è!ğ
EACCES
) {

824 
chmodo_”rÜ
;

826 ià((
»t
=
	`wr™em
(
d1
, "ch", 64, '1')è!ğ
EACCES
) {

827 
chmodo_”rÜ
;

829 ià((
»t
=
	`»adm
(
d2
, "ch")è!ğ
EACCES
) {

830 
chmodo_”rÜ
;

832 ià((
»t
=
	`»adm
(
d3
, "ch")è!ğ
EACCES
) {

833 
chmodo_”rÜ
;

835 ià((
»t
=
	`wr™em
(
d3
, "ch", 64, '1')è!ğ
EACCES
) {

836 
chmodo_”rÜ
;

838 
	`´štf
(" other chmod PASSED\n");

839 
f’um
++;

840 
chmodo_ok
;

842 
chmodo_”rÜ
:

843 
	`´štf
(" other chmod ERROR\n");

844 
chmodo_ok
:

845 
	`ü—‹m
(
d1
, "co", "", 0642);

847 ià(
	`chown1
(
d0
, "co", 1004,1005) != 0) {

848 
chown_”rÜ
;

850 ià((
»t
=
	`wr™em
(
d2
, "co", 64, '1')) != 0){

851 
chown_”rÜ
;

853 ià((
»t
=
	`wr™em
(
d3
, "co", 64, '1')è!ğ
EACCES
) {

854 
chown_”rÜ
;

856 ià((
»t
=
	`»adm
(
d1
, "co")è!ğ
EPERM
) {

857 
chown_”rÜ
;

859 
	`´štf
("„oot chown PASSED\n");

860 
f’um
++;

861 
chown_ok
;

863 
chown_”rÜ
:

864 
	`´štf
("„oot chown ERROR\n");

865 
chown_ok
:

867 ià(
	`chown1
(
d1
, "co", 1003, 1003è!ğ
EACCES
) {

868 
chowÂ_’d
;

870 ià(
	`chown1
(
d2
, "co", 1003, 1003è!ğ
EACCES
) {

871 
chowÂ_’d
;

873 ià(
	`chown1
(
d3
, "co", 1003, 1003è!ğ
EACCES
) {

874 
chowÂ_’d
;

876 
	`´štf
("‚on-root chown PASSED\n");

877 
f’um
++;

878 
chowÂ_ok
;

880 
chowÂ_’d
:

881 
	`´štf
("‚on-root chown ERROR\n");

882 
chowÂ_ok
:

884 
	`´štf
("ScÜe: %d/100\n\n", 
f’um
*10);

886 
	`´štf
("Test Dirtectory Permission\n");

888 ià(
	`wr™edœm
(
d1
, "da", "file1", "dir1") != 0) {

889 
wr™ed_”rÜ
;

891 ià(
	`wr™edœm
(
d1
, "dr", "fe2", "dœ2"è!ğ
EACCES
) {

892 
wr™ed_”rÜ
;

894 ià(
	`wr™edœm
(
d1
, "dw", "file3", "dir3") != 0) {

895 
wr™ed_”rÜ
;

897 
	`´štf
(" owner write PASSED\n");

898 
dœnum
 ++;

899 
wr™ed_ok
;

900 
wr™ed_”rÜ
:

901 
	`´štf
(" owner write ERROR\n");

902 
wr™ed_ok
:

904 ià(
	`»addœm
(
d1
, "da") != 0) {

905 
»add_”rÜ
;

907 ià(
	`»addœm
(
d1
, "dr") != 0) {

908 
»add_”rÜ
;

910 ià(
	`»addœm
(
d1
, "dw"è!ğ
EACCES
) {

911 
»add_”rÜ
;

913 
	`´štf
(" owner„ead PASSED\n");

914 
dœnum
 ++;

915 
»add_ok
;

916 
»add_”rÜ
:

917 
	`´štf
(" owner„ead OK\n");

918 
»add_ok
:

921 ià(
	`wr™edœm
(
d2
, "dga", "file4", "dir4") != 0) {

922 
wr™edg_”rÜ
;

924 ià(
	`wr™edœm
(
d2
, "dgw", "file6", "dir6") != 0) {

925 
wr™edg_”rÜ
;

927 
	`´štf
(" group write PASSED\n");

928 
dœnum
 ++;

929 
wr™edg_ok
;

930 
wr™edg_”rÜ
:

931 
	`´štf
(" group write ERROR\n");

932 
wr™edg_ok
:

934 ià(
	`»addœm
(
d2
, "dga") != 0) {

935 
»addg_”rÜ
;

937 ià(
	`»addœm
(
d2
, "dgr") != 0) {

938 
»addg_”rÜ
;

940 
	`´štf
(" group„ead PASSED\n");

941 
dœnum
 ++;

942 
»addg_ok
;

943 
»addg_”rÜ
:

944 
	`´štf
(" group„ead OK\n");

945 
»addg_ok
:

948 ià(
	`wr™edœm
(
d1
, "doa", "file7", "dir7") != 0) {

949 
wr™edo_”rÜ
;

951 ià(
	`wr™edœm
(
d1
, "dow", "file9", "dir9") != 0) {

952 
wr™edo_”rÜ
;

954 
	`´štf
(" other write PASSED\n");

955 
dœnum
 ++;

956 
wr™edo_ok
;

957 
wr™edo_”rÜ
:

958 
	`´štf
(" other write ERROR\n");

959 
wr™edo_ok
:

961 ià(
	`»addœm
(
d1
, "doa") != 0) {

962 
»addo_”rÜ
;

964 ià(
	`»addœm
(
d1
, "dor") != 0) {

965 
»addo_”rÜ
;

967 ià(
	`»addœm
(
d1
, "dow"è!ğ
EACCES
) {

968 
»addo_”rÜ
;

970 
	`´štf
(" other„ead PASSED\n");

971 
dœnum
 ++;

972 
»addo_ok
;

973 
»addo_”rÜ
:

974 
	`´štf
(" other„ead OK\n");

975 
»addo_ok
:

977 
	`´štf
("ScÜe: %d/60\n",
dœnum
 * 10);

1318 
	}
}

	@tprintf.h

1 #iâdeà
TPRINTF_H


2 
	#TPRINTF_H


	)

4 
	#rštf
(
¬gs
...) do { \

5 
timev®
 
tv
; \

6 
	`g‘timeofday
(&
tv
, 0); \

7 
	`´štf
("%lu:\t", 
tv
.
tv_£c
 * 1000 +v.
tv_u£c
 / 1000);\

8 
	`´štf
(
¬gs
); \

9 } 0);

	)

	@yfs_client.cc

2 
	~"yfs_ş›Á.h
"

3 
	~"ex‹Á_ş›Á.h
"

4 
	~<s¡»am
>

5 
	~<io¡»am
>

6 
	~<f¡»am
>

7 
	~<¡dio.h
>

8 
	~<uni¡d.h
>

9 
	~<sys/ty³s.h
>

10 
	~<sys/¡©.h
>

11 
	~<fú.h
>

13 
	gyfs_ş›Á
::
	$yfs_ş›Á
()

15 
ec
 = 
NULL
;

16 
lc
 = 
NULL
;

17 
	}
}

19 
	gyfs_ş›Á
::
	$yfs_ş›Á
(
¡d
::
¡ršg
 
ex‹Á_d¡
, std::¡ršg 
lock_d¡
, cÚ¡ * 
û¹_fe
)

21 
ec
 = 
Ãw
 
	`ex‹Á_ş›Á
(
ex‹Á_d¡
);

22 
lc
 = 
Ãw
 
	`lock_ş›Á
(
lock_d¡
);

23 
cur_v”siÚ
 = 0;

24 
»cov”šg
 = 0;

25 
lc
->
	`acquœe
(1);

26 ià(
ec
->
	`put
(1, ""è!ğ
ex‹Á_´ÙocŞ
::
OK
)

27 
	`´štf
("error init„oot dir\n");

28 
lc
->
	`»Ëa£
(1);

29 
	}
}

32 
	gyfs_ş›Á
::
	$v”ify
(cÚ¡ * 
Çme
, *
uid
)

34 
»t
 = 
OK
;

36  
»t
;

37 
	}
}

40 
	gyfs_ş›Á
::
šum


41 
yfs_ş›Á
::
	$n2i
(
¡d
::
¡ršg
 
n
)

43 
¡d
::
i¡ršg¡»am
 
	`i¡
(
n
);

44 
fšum
;

45 
i¡
 >> 
fšum
;

46  
fšum
;

47 
	}
}

49 
	g¡d
::
¡ršg


50 
yfs_ş›Á
::
	$f’ame
(
šum
 inum)

52 
¡d
::
o¡ršg¡»am
 
o¡
;

53 
o¡
 << 
šum
;

54  
o¡
.
	`¡r
();

55 
	}
}

57 
boŞ


58 
	gyfs_ş›Á
::
	$isfe
(
šum
 inum)

60 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

62 
lc
->
	`acquœe
(
šum
);

63 ià(
ec
->
	`g‘©Œ
(
šum
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

64 
	`´štf
("error getting‡ttr\n");

65 
lc
->
	`»Ëa£
(
šum
);

66  
çl£
;

68 
lc
->
	`»Ëa£
(
šum
);

70 ià(
a
.
ty³
 =ğ
ex‹Á_´ÙocŞ
::
T_FILE
) {

71 
	`´štf
("isfe: %Îd i ¨fe\n", 
šum
);

72  
Œue
;

74 
	`´štf
("isfe: %Îd i ¨dœ\n", 
šum
);

75  
çl£
;

76 
	}
}

85 
	gyfs_ş›Á
::
DœTabË
::
	$DœTabË
(
¡d
::
¡ršg
 
s
)

87 
size_t
 
pos™iÚ
 = 0;

88 
size_t
 
Ãxt
;

90 
pos™iÚ
 < 
s
.
	`size
()){

91 
Ãxt
 = 
s
.
	`fšd
("/", 
pos™iÚ
);

92 
¡d
::
¡ršg
 
fe_Çme
 = 
s
.
	`sub¡r
(
pos™iÚ
, 
Ãxt
-position);

93 
pos™iÚ
 = 
Ãxt
 + 1;

95 
Ãxt
 = 
s
.
	`fšd
("/", 
pos™iÚ
);

96 
šum
 
id
 = 
	`n2i
(
s
.
	`sub¡r
(
pos™iÚ
, 
Ãxt
-position));

97 
pos™iÚ
 = 
Ãxt
 + 1;

99 
li¡
.
	`š£¹
(
¡d
::
·œ
<¡d::
¡ršg
, 
šum
>(
fe_Çme
, 
id
));

101 
	}
}

105 
	g¡d
::
¡ršg


106 
yfs_ş›Á
::
DœTabË
::
	$dump2¡r
()

108 
¡d
::
¡ršg
 
»suÉ
 = "";

109 
¡d
::
m­
<¡d::
¡ršg
, 
šum
>::
™”©Ü
 
™
 = 
li¡
.
	`begš
();

110 
™
 !ğ
li¡
.
	`’d
()){

111 
»suÉ
 =„esuÉ + 
™
->
fœ¡
 + "/";

112 
»suÉ
 =„esuÉ + 
	`f’ame
(
™
->
£cÚd
) + "/";

114 
™
++;

117  
»suÉ
;

118 
	}
}

122 
boŞ


123 
	gyfs_ş›Á
::
DœTabË
::
	$lookup
(
¡d
::
¡ršg
 
Çme
, 
šum
& 
»suÉ
)

125 
¡d
::
m­
<¡d::
¡ršg
, 
šum
>::
™”©Ü
 
™
 = 
li¡
.
	`fšd
(
Çme
);

126 if(
™
 !ğ
li¡
.
	`’d
()){

127 
»suÉ
 = 
™
->
£cÚd
;

128  
Œue
;

130  
çl£
;

133 
	}
}

137 
	gyfs_ş›Á
::
DœTabË
::
	$š£¹
(
¡d
::
¡ršg
 
Çme
, 
šum
 
id
)

139 
li¡
.
	`š£¹
(
¡d
::
·œ
<¡d::
¡ršg
, 
šum
>(
Çme
, 
id
));

140 
	}
}

144 
	gyfs_ş›Á
::
DœTabË
::
dump2li¡
(
¡d
::
li¡
<
dœ’t
>& 
rg‘_li¡
)

146 
¡d
::
m­
<¡d::
¡ršg
, 
	gšum
>::
™”©Ü
 
™
 = 
li¡
.
begš
();

147 
	g™
 !ğ
li¡
.
’d
()){

148 
dœ’t
 
’Œy
;

149 
	g’Œy
.
	gÇme
 = 
™
->
fœ¡
;

150 
	g’Œy
.
	gšum
 = 
™
->
£cÚd
;

151 
	grg‘_li¡
.
push_back
(
’Œy
);

153 
	g™
++;

160 
	gyfs_ş›Á
::
DœTabË
::
	$”a£
(
¡d
::
¡ršg
 
Çme
)

162 
li¡
.
	`”a£
(
Çme
);

163 
	}
}

169 
boŞ


170 
	gyfs_ş›Á
::
	$isdœ
(
šum
 inum)

176 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

179 
lc
->
	`acquœe
(
šum
);

180 if(
ec
->
	`g‘©Œ
(
šum
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
){

181 
	`´štf
("error getting‡ttr\n");

182 
lc
->
	`»Ëa£
(
šum
);

183  
çl£
;

185 
lc
->
	`»Ëa£
(
šum
);

187 if(
a
.
ty³
 =ğ
ex‹Á_´ÙocŞ
::
T_DIR
){

188 
	`´štf
("isdœ: %Îd i ¨dœeùÜy\n", 
šum
);

189  
Œue
;

192 
	`´štf
("isdœ: %Îd i nÙ‡ dœ‘Üy\n", 
šum
);

193  
çl£
;

195 
	}
}

198 
	gyfs_ş›Á
::
	$g‘fe
(
šum
 inum, 
fešfo
 &
fš
)

200 
r
 = 
OK
;

202 
	`´štf
("g‘f%016Îx\n", 
šum
);

203 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

205 
lc
->
	`acquœe
(
šum
);

206 ià(
ec
->
	`g‘©Œ
(
šum
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

207 
r
 = 
IOERR
;

208 
»Ëa£
;

210 
fš
.
©ime
 = 
a
.atime;

211 
fš
.
mtime
 = 
a
.mtime;

212 
fš
.
ùime
 = 
a
.ctime;

213 
fš
.
size
 = 
a
.size;

214 
	`´štf
("g‘f%016Îx -> sz %Îu\n", 
šum
, 
fš
.
size
);

216 
»Ëa£
:

217 
lc
->
	`»Ëa£
(
šum
);

218  
r
;

219 
	}
}

222 
	gyfs_ş›Á
::
	$g‘dœ
(
šum
 inum, 
dœšfo
 &
dš
)

224 
r
 = 
OK
;

226 
	`´štf
("g‘dœ %016Îx\n", 
šum
);

227 
ex‹Á_´ÙocŞ
::
©Œ
 
a
;

229 
lc
->
	`acquœe
(
šum
);

230 ià(
ec
->
	`g‘©Œ
(
šum
, 
a
è!ğ
ex‹Á_´ÙocŞ
::
OK
) {

231 
r
 = 
IOERR
;

232 
»Ëa£
;

234 
dš
.
©ime
 = 
a
.atime;

235 
dš
.
mtime
 = 
a
.mtime;

236 
dš
.
ùime
 = 
a
.ctime;

238 
»Ëa£
:

239 
lc
->
	`»Ëa£
(
šum
);

240  
r
;

241 
	}
}

244 
	#EXT_RPC
(
xx
) do { \

245 ià((
xx
è!ğ
ex‹Á_´ÙocŞ
::
OK
) { \

246 
	`´štf
("EXT_RPC E¼Ü: %s:%d \n", 
__FILE__
, 
__LINE__
); \

247 
r
 = 
IOERR
; \

248 
»Ëa£
; \

250 } 0)

	)

254 
	gyfs_ş›Á
::
	$£‰r
(
šum
 
šo
, 
fe¡©
 
¡
, 
to£t
)

256 
r
 = 
OK
;

263 
lc
->
	`acquœe
(
šo
);

266 
	`log_£‰r
(
šo
, 
¡
.
size
);

268 
¡d
::
¡ršg
 
buf
;

269 
r
 = 
ec
->
	`g‘
(
šo
, 
buf
);

270 if(
r
 !ğ
OK
){

271 
	`´štf
("setattr: file do‚otƒxist\n");

272 
lc
->
	`»Ëa£
(
šo
);

273  
r
;

277 
buf
.
	`»size
(
¡
.
size
);

279 
r
 = 
ec
->
	`put
(
šo
, 
buf
);

281 
lc
->
	`»Ëa£
(
šo
);

283 if(
r
 !ğ
OK
){

284 
	`´štf
("setattr: update file failure\n");

285  
r
;

288  
r
;

289 
	}
}

294 
	gyfs_ş›Á
::
	$ü—‹
(
šum
 
·»Á
, cÚ¡ *
Çme
, 
mode_t
 
mode
, inum &
šo_out
)

296 
r
 = 
OK
;

303 
lc
->
	`acquœe
(
·»Á
);

306 
	`log_ü—‹
(
·»Á
, 
Çme
, 
mode
);

308 
¡d
::
¡ršg
 
buf
;

309 
r
 = 
ec
->
	`g‘
(
·»Á
, 
buf
);

311 if(
r
 !ğ
OK
){

312 
	`´štf
("create:…arent directory do‚otƒxist\n");

313 
lc
->
	`»Ëa£
(
·»Á
);

314  
r
;

318 
šum
 
id
;

319 
DœTabË
 
	`·»Á_dœ
(
buf
);

320 if(
·»Á_dœ
.
	`lookup
(
¡d
::
	`¡ršg
(
Çme
), 
id
)){

321 
	`´štf
("create:‚ame‡lreadyƒxist\n");

322 
lc
->
	`»Ëa£
(
·»Á
);

323  
EXIST
;

327 
r
 = 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_FILE
, 
šo_out
);

328 if(
r
 !ğ
OK
){

329 
	`´štf
("create: create file failure\n");

330 
lc
->
	`»Ëa£
(
·»Á
);

331  
r
;

335 
·»Á_dœ
.
	`š£¹
(
¡d
::
	`¡ršg
(
Çme
), 
šo_out
);

336 
r
 = 
ec
->
	`put
(
·»Á
, 
·»Á_dœ
.
	`dump2¡r
());

338 
lc
->
	`»Ëa£
(
·»Á
);

340 if(
r
 !ğ
OK
){

341 
	`´štf
("create: update…arent directory failure\n");

342  
r
;

345  
r
;

346 
	}
}

349 
	gyfs_ş›Á
::
	$mkdœ
(
šum
 
·»Á
, cÚ¡ *
Çme
, 
mode_t
 
mode
, inum &
šo_out
)

351 
r
 = 
OK
;

359 
¡d
::
¡ršg
 
buf
;

361 
lc
->
	`acquœe
(
·»Á
);

364 
	`log_mkdœ
(
·»Á
, 
Çme
, 
mode
);

366 
r
 = 
ec
->
	`g‘
(
·»Á
, 
buf
);

367 if(
r
 !ğ
OK
){

368 
	`´štf
("mkdir:…arent directory do‚otƒxist\n");

369 
lc
->
	`»Ëa£
(
·»Á
);

370  
r
;

374 
šum
 
id
;

375 
DœTabË
 
	`·»Á_dœ
(
buf
);

376 if(
·»Á_dœ
.
	`lookup
(
¡d
::
	`¡ršg
(
Çme
), 
id
)){

377 
	`´štf
("mkdir:‚ame‡lreadyƒxist\n");

378 
lc
->
	`»Ëa£
(
·»Á
);

379  
EXIST
;

383 
r
 = 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_DIR
, 
šo_out
);

384 if(
r
 !ğ
OK
){

385 
	`´štf
("mkdir: create file failure\n");

386 
lc
->
	`»Ëa£
(
·»Á
);

387  
r
;

391 
·»Á_dœ
.
	`š£¹
(
¡d
::
	`¡ršg
(
Çme
), 
šo_out
);

392 
r
 = 
ec
->
	`put
(
·»Á
, 
·»Á_dœ
.
	`dump2¡r
());

394 
lc
->
	`»Ëa£
(
·»Á
);

396 if(
r
 !ğ
OK
){

397 
	`´štf
("mkdir: update…arent directory failure\n");

398  
r
;

401  
r
;

402 
	}
}

405 
	gyfs_ş›Á
::
	$lookup
(
šum
 
·»Á
, cÚ¡ *
Çme
, 
boŞ
 &
found
, inum &
šo_out
)

407 
r
 = 
OK
;

414 
¡d
::
¡ršg
 
buf
;

415 
lc
->
	`acquœe
(
·»Á
);

416 
r
 = 
ec
->
	`g‘
(
·»Á
, 
buf
);

417 
lc
->
	`»Ëa£
(
·»Á
);

418 if(
r
 !ğ
OK
){

419 
	`´štf
("lookup:…arent directory do‚otƒxist\n");

420 
lc
->
	`»Ëa£
(
·»Á
);

421  
r
;

424 
DœTabË
 
	`·»Á_dœ
(
buf
);

425 
found
 = 
·»Á_dœ
.
	`lookup
(
¡d
::
	`¡ršg
(
Çme
), 
šo_out
);

427  
r
;

428 
	}
}

431 
	gyfs_ş›Á
::
»addœ
(
šum
 
dœ
, 
¡d
::
li¡
<
dœ’t
> &list)

433 
r
 = 
OK
;

440 
	g¡d
::
¡ršg
 
buf
;

441 
	glc
->
acquœe
(
dœ
);

442 
	gr
 = 
ec
->
g‘
(
dœ
, 
buf
);

443 
	glc
->
»Ëa£
(
dœ
);

444 if(
	gr
 !ğ
OK
){

445 
´štf
("readdir: directory do‚otƒxist\n");

446  
	gr
;

449 
DœTabË
 
·»Á_dœ
(
buf
);

450 
	g·»Á_dœ
.
dump2li¡
(
li¡
);

452  
	gr
;

456 
	gyfs_ş›Á
::
	$»ad
(
šum
 
šo
, 
size_t
 
size
, 
off_t
 
off
, 
¡d
::
¡ršg
 &
d©a
)

458 
r
 = 
OK
;

464 
¡d
::
¡ršg
 
buf
;

465 
lc
->
	`acquœe
(
šo
);

466 
r
 = 
ec
->
	`g‘
(
šo
, 
buf
);

467 
lc
->
	`»Ëa£
(
šo
);

468 if(
r
 !ğ
OK
){

469 
	`´štf
("read: file do‚otƒxist\n");

470  
r
;

472 
Üigš_size
 = (è
buf
.
	`size
();

474 if(
off
 < 
Üigš_size
){

475 if((
off
 + 
size
è<ğ
Üigš_size
){

476 
d©a
 = 
buf
.
	`sub¡r
(
off
, 
size
);

478 
d©a
 = 
buf
.
	`sub¡r
(
off
, 
Üigš_size
-off);

483 
d©a
 = "";

486  
r
;

487 
	}
}

490 
	gyfs_ş›Á
::
	$wr™e
(
šum
 
šo
, 
size_t
 
size
, 
off_t
 
off
, cÚ¡ *
d©a
,

491 
size_t
 &
by‹s_wr™‹n
)

493 
r
 = 
OK
;

500 
¡d
::
¡ršg
 
buf
;

502 
lc
->
	`acquœe
(
šo
);

505 
	`log_wr™e
(
šo
, 
size
, 
off
, 
d©a
);

507 
r
 = 
ec
->
	`g‘
(
šo
, 
buf
);

508 if(
r
 !ğ
OK
){

509 
	`´štf
("write: file do‚otƒxist\n");

510 
lc
->
	`»Ëa£
(
šo
);

511  
r
;

515 if((
size_t
)(
off
 + 
size
è> 
buf
.
	`Ëngth
()){

516 
buf
.
	`»size
(
off
+
size
, '\0');

519 
i
 = 0; i < 
size
; i++){

520 
buf
[
off
+
i
] = 
d©a
[i];

523 
r
 = 
ec
->
	`put
(
šo
, 
buf
);

524 
lc
->
	`»Ëa£
(
šo
);

526 if(
r
 !ğ
OK
){

527 
	`´štf
("write: updata file failure\n");

528  
r
;

530 
by‹s_wr™‹n
 = 
size
;

532  
r
;

533 
	}
}

536 
	gyfs_ş›Á
::
	$uÆšk
(
šum
 
·»Á
,cÚ¡ *
Çme
)

538 
r
 = 
OK
;

545 
¡d
::
¡ršg
 
buf
;

546 
lc
->
	`acquœe
(
·»Á
);

549 
	`log_uÆšk
(
·»Á
, 
Çme
);

551 
r
 = 
ec
->
	`g‘
(
·»Á
, 
buf
);

552 if(
r
 !ğ
OK
){

553 
	`´štf
("unlink:…arent directory do‚otƒxist\n");

554 
lc
->
	`»Ëa£
(
·»Á
);

555  
r
;

558 
šum
 
fe_id
;

559 
DœTabË
 
	`·»Á_dœ
(
buf
);

560 if(!
·»Á_dœ
.
	`lookup
((
¡d
::
¡ršg
)
Çme
, 
fe_id
)){

561 
	`´štf
("unlink: file do‚otƒxist\n");

562 
lc
->
	`»Ëa£
(
·»Á
);

563  
NOENT
;

567 
r
 = 
ec
->
	`»move
(
fe_id
);

568 if(
r
 !ğ
OK
){

569 
	`´štf
("unlink:„emove failure\n");

570 
lc
->
	`»Ëa£
(
·»Á
);

571  
r
;

575 
·»Á_dœ
.
	`”a£
(
¡d
::
	`¡ršg
(
Çme
));

576 
r
 = 
ec
->
	`put
(
·»Á
, 
·»Á_dœ
.
	`dump2¡r
());

577 
lc
->
	`»Ëa£
(
·»Á
);

579 if(
r
 !ğ
OK
){

580 
	`´štf
("unlink:„emove failure\n");

581  
r
;

585  
r
;

586 
	}
}

589 
	gyfs_ş›Á
::
	$symlšk
(
šum
 
·»Á
, cÚ¡ *
Çme
,

590 cÚ¡ *
·th
, 
šum
 &
šo_out
)

592 
r
 = 
OK
;

594 
¡d
::
¡ršg
 
buf
;

595 
lc
->
	`acquœe
(
·»Á
);

598 
	`log_symlšk
(
·»Á
, 
Çme
, 
·th
);

600 
r
 = 
ec
->
	`g‘
(
·»Á
, 
buf
);

601 if(
r
 !ğ
OK
){

602 
	`´štf
("symlink:…arent directory do‚otƒxist\n");

603 
lc
->
	`»Ëa£
(
·»Á
);

604  
r
;

608 
DœTabË
 
	`·»Á_dœ
(
buf
);

609 
šum
 
id
;

610 if(
·»Á_dœ
.
	`lookup
(
¡d
::
	`¡ršg
(
Çme
), 
id
)){

611 
	`´štf
("symlink:‚ame‡lreadyƒxist\n");

612 
lc
->
	`»Ëa£
(
·»Á
);

613  
EXIST
;

618 
r
 = 
ec
->
	`ü—‹
(
ex‹Á_´ÙocŞ
::
T_SYMLINK
, 
šo_out
);

619 if(
r
 !ğ
OK
){

620 
	`´štf
("symlink: create file failure\n");

621 
lc
->
	`»Ëa£
(
·»Á
);

622  
r
;

626 
r
 = 
ec
->
	`put
(
šo_out
, 
¡d
::
	`¡ršg
(
·th
));

627 if(
r
 !ğ
OK
){

628 
	`´štf
("symlink: write…ath failure\n");

629 
lc
->
	`»Ëa£
(
·»Á
);

630  
r
;

634 
·»Á_dœ
.
	`š£¹
(
¡d
::
	`¡ršg
(
Çme
), 
šo_out
);

635 
r
 = 
ec
->
	`put
(
·»Á
, 
·»Á_dœ
.
	`dump2¡r
());

637 
lc
->
	`»Ëa£
(
·»Á
);

639 if(
r
 !ğ
OK
){

640 
	`´štf
("symlink: update…arent directory failure\n");

641  
r
;

644  
r
;

646 
	}
}

649 
	gyfs_ş›Á
::
	$»adlšk
(
šum
 
šo
, 
¡d
::
¡ršg
 &
·th_out
)

651 
r
 = 
OK
;

653 
¡d
::
¡ršg
 
buf
;

654 
lc
->
	`acquœe
(
šo
);

655 
r
 = 
ec
->
	`g‘
(
šo
, 
buf
);

656 
lc
->
	`»Ëa£
(
šo
);

657 if(
r
 !ğ
OK
){

658 
	`´štf
("readlink: file do‚otƒxist\n");

659  
r
;

662 
·th_out
 = 
buf
;

663  
r
;

665 
	}
}

677 
	g¡d
::
¡ršg


678 
yfs_ş›Á
::
	$i2n
(
yfs_ş›Á
::
šum
 inum)

680 
¡d
::
¡ršg¡»am
 
¡
;

681 
¡d
::
¡ršg
 
»suÉ
;

682 
¡
 << 
šum
;

683 
¡
 >> 
»suÉ
;

684  
»suÉ
;

685 
	}
}

688 
	gyfs_ş›Á
::
	$v”siÚ_comm™
()

690 
lc
->
	`acquœe
(0);

691 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

692 if(!
ofs
){

693 
	`´štf
("Open†og fileƒrror!\n");

697 
¡d
::
¡ršg
 
buf
;

698 
buf
 += "version ";

699 
buf
 +ğ
	`i2n
(
cur_v”siÚ
);

700 
cur_v”siÚ
 ++;

701 
buf
 += "\n";

702 
ofs
 << 
buf
;

703 
ofs
.
	`şo£
();

704 
lc
->
	`»Ëa£
(0);

705 
	}
}

708 
	gyfs_ş›Á
::
	$´ev_v”siÚ
()

711 if(
cur_v”siÚ
 == 0){

712 
	`´štf
("no moreƒarlier version");

715 
¡d
::
if¡»am
 
	`ifs
("vclog");

716 if(!
ifs
){

717 
	`´štf
("Open†og fileƒrror!\n");

721 
gÙo_v”siÚ
 = 
cur_v”siÚ
 - 1;

722 
’d_of_v”siÚ
 = 0;

723 
lše
 = 1;

724 !
ifs
.
	`eof
()){

725 
¡d
::
¡ršg
 
İ”
;

726 
ifs
>>
İ”
;

727 if(
İ”
 == "version"){

728 
v”siÚ
;

729 
ifs
 >> 
v”siÚ
;

730 if(
v”siÚ
 =ğ
gÙo_v”siÚ
){

731 
’d_of_v”siÚ
 = 
lše
;

736 if(
İ”
 =="setattr"){

737 
šum
 
šode
;

738 
ifs
>>
šode
;

739 
size
;

740 
ifs
>>
size
;

742 if(
İ”
 =="write"){

743 
šum
 
šode
;

744 
size_t
 
size
;

745 
off_t
 
off
;

746 
size_t
 
size_out
;

747 
ifs
>>
šode
;

748 
ifs
>>
size
;

749 
ifs
>>
off
;

750 
¥aû
;

751 
¡d
::
¡ršg
 
d©a
;

752 
ifs
.
	`g‘
(
¥aû
);

753 
size_t
 
i
=0;i<
size
;i++){

754 
ifs
.
	`g‘
(
¥aû
);

755 
d©a
+=
¥aû
;

758 if(
İ”
 =="create"){

759 
šum
 
·»Á
,
šo_out
;

760 
size_t
 
size
;

761 
mode
;

762 
¥aû
;

763 
¡d
::
¡ršg
 
Çme
;

764 
ifs
>>
·»Á
;

765 
ifs
>>
size
;

766 
ifs
.
	`g‘
(
¥aû
);

767 
size_t
 
i
=0;i<
size
;i++){

768 
ifs
.
	`g‘
(
¥aû
);

769 
Çme
+=
¥aû
;

771 
ifs
>>
mode
;

773 if(
İ”
 =="unlink"){

774 
šum
 
·»Á
;

775 
size_t
 
size
;

776 
¡d
::
¡ršg
 
Çme
;

777 
¥aû
;

778 
ifs
>>
·»Á
;

779 
ifs
>>
size
;

780 
ifs
.
	`g‘
(
¥aû
);

781 
size_t
 
i
=0;i<
size
;i++){

782 
ifs
.
	`g‘
(
¥aû
);

783 
Çme
+=
¥aû
;

786 if(
İ”
 =="symlink"){

787 
šum
 
·»Á
,
šo_out
;

788 
size_t
 
size
;

789 
¡d
::
¡ršg
 
lšk
,
Çme
;

790 
¥aû
;

791 
ifs
>>
size
;

792 
size_t
 
i
=0;i<
size
;i++){

793 
ifs
.
	`g‘
(
¥aû
);

794 
lšk
+=
¥aû
;

796 
ifs
.
	`g‘
(
¥aû
);

797 
ifs
>>
·»Á
;

798 
ifs
>>
size
;

799 
size_t
 
i
=0;i<
size
;i++){

800 
ifs
.
	`g‘
(
¥aû
);

801 
Çme
+=
¥aû
;

804 if(
İ”
 =="mkdir"){

805 
šum
 
·»Á
,
šo_out
;

806 
size_t
 
size
;

807 
mode
;

808 
¥aû
;

809 
¡d
::
¡ršg
 
Çme
;

810 
ifs
>>
·»Á
;

811 
ifs
>>
size
;

812 
ifs
.
	`g‘
(
¥aû
);

813 
size_t
 
i
=0;i<
size
;i++){

814 
ifs
.
	`g‘
(
¥aû
);

815 
Çme
+=
¥aû
;

817 
ifs
>>
mode
;

821 
lše
 ++;

824 
ifs
.
	`şo£
();

826 if(
’d_of_v”siÚ
 == 0){

830 
	`´štf
("\n\Ä‘uºØv”siÚ %d", 
cur_v”siÚ
 - 1);

831 
	`´štf
("recovring...\n");

833 
lc
->
	`acquœe
(0);

834 
	`»cov”y
(
’d_of_v”siÚ
);

835 
	`´štf
("done");

836 
cur_v”siÚ
 --;

837 
lc
->
	`»Ëa£
(0);

839 
	}
}

842 
	gyfs_ş›Á
::
	$Ãxt_v”siÚ
()

845 
¡d
::
if¡»am
 
	`ifs
("vclog");

846 if(!
ifs
){

847 
	`´štf
("Open†og fileƒrror!\n");

851 
gÙo_v”siÚ
 = 
cur_v”siÚ
 + 1;

852 
’d_of_v”siÚ
 = 0;

853 
lše
 = 1;

854 !
ifs
.
	`eof
()){

855 
¡d
::
¡ršg
 
İ”
;

856 
ifs
>>
İ”
;

857 if(
İ”
 == "version"){

858 
v”siÚ
;

859 
ifs
 >> 
v”siÚ
;

860 if(
v”siÚ
 =ğ
gÙo_v”siÚ
){

861 
’d_of_v”siÚ
 = 
lše
;

866 if(
İ”
 =="setattr"){

867 
šum
 
šode
;

868 
ifs
>>
šode
;

869 
size
;

870 
ifs
>>
size
;

872 if(
İ”
 =="write"){

873 
šum
 
šode
;

874 
size_t
 
size
;

875 
off_t
 
off
;

876 
size_t
 
size_out
;

877 
ifs
>>
šode
;

878 
ifs
>>
size
;

879 
ifs
>>
off
;

880 
¥aû
;

881 
¡d
::
¡ršg
 
d©a
;

882 
ifs
.
	`g‘
(
¥aû
);

883 
size_t
 
i
=0;i<
size
;i++){

884 
ifs
.
	`g‘
(
¥aû
);

885 
d©a
+=
¥aû
;

888 if(
İ”
 =="create"){

889 
šum
 
·»Á
,
šo_out
;

890 
size_t
 
size
;

891 
mode
;

892 
¥aû
;

893 
¡d
::
¡ršg
 
Çme
;

894 
ifs
>>
·»Á
;

895 
ifs
>>
size
;

896 
ifs
.
	`g‘
(
¥aû
);

897 
size_t
 
i
=0;i<
size
;i++){

898 
ifs
.
	`g‘
(
¥aû
);

899 
Çme
+=
¥aû
;

901 
ifs
>>
mode
;

903 if(
İ”
 =="unlink"){

904 
šum
 
·»Á
;

905 
size_t
 
size
;

906 
¡d
::
¡ršg
 
Çme
;

907 
¥aû
;

908 
ifs
>>
·»Á
;

909 
ifs
>>
size
;

910 
ifs
.
	`g‘
(
¥aû
);

911 
size_t
 
i
=0;i<
size
;i++){

912 
ifs
.
	`g‘
(
¥aû
);

913 
Çme
+=
¥aû
;

916 if(
İ”
 =="symlink"){

917 
šum
 
·»Á
,
šo_out
;

918 
size_t
 
size
;

919 
¡d
::
¡ršg
 
lšk
,
Çme
;

920 
¥aû
;

921 
ifs
>>
size
;

922 
size_t
 
i
=0;i<
size
;i++){

923 
ifs
.
	`g‘
(
¥aû
);

924 
lšk
+=
¥aû
;

926 
ifs
.
	`g‘
(
¥aû
);

927 
ifs
>>
·»Á
;

928 
ifs
>>
size
;

929 
size_t
 
i
=0;i<
size
;i++){

930 
ifs
.
	`g‘
(
¥aû
);

931 
Çme
+=
¥aû
;

934 if(
İ”
 =="mkdir"){

935 
šum
 
·»Á
,
šo_out
;

936 
size_t
 
size
;

937 
mode
;

938 
¥aû
;

939 
¡d
::
¡ršg
 
Çme
;

940 
ifs
>>
·»Á
;

941 
ifs
>>
size
;

942 
ifs
.
	`g‘
(
¥aû
);

943 
size_t
 
i
=0;i<
size
;i++){

944 
ifs
.
	`g‘
(
¥aû
);

945 
Çme
+=
¥aû
;

947 
ifs
>>
mode
;

950 
lše
 ++;

953 
ifs
.
	`şo£
();

955 if(
’d_of_v”siÚ
 == 0){

956 
	`´štf
("no more further version\n");

960 
	`´štf
("\n\nfow¬dØv”siÚ %d", 
cur_v”siÚ
 + 1);

961 
	`´štf
("recovring...\n");

963 
lc
->
	`acquœe
(0);

964 
	`»cov”y
(
’d_of_v”siÚ
);

965 
	`´štf
("done\n\n");

966 
cur_v”siÚ
 ++;

967 
lc
->
	`»Ëa£
(0);

969 
	}
}

972 
	gyfs_ş›Á
::
	$»cov”y
(
’d_lše
)

974 
»cov”šg
 = 1;

975 
¡d
::
if¡»am
 
	`ifs
("vclog");

976 if(!
ifs
){

977 
	`´štf
("Open†og fileƒrror!\n");

978 
»cov”šg
 = 0;

982 
ec
->
	`ş—rfs
(0);

983 
cur_lše
 = 1;

984 !
ifs
.
	`eof
())

987 if(
cur_lše
 =ğ
’d_lše
)

991 
¡d
::
¡ršg
 
buf
;

992 
ifs
 >> 
buf
;

994 if(
buf
 == "setattr"){

995 
šum
 
šo
;

996 
ifs
 >> 
šo
;

997 
size_t
 
size
;

998 
ifs
 >> 
size
;

999 
fe¡©
 
¡
;

1000 
¡
.
size
 = size;

1002 
to£t
;

1003 
	`£‰r
(
šo
, 
¡
, 
to£t
);

1006 if(
buf
 == "create"){

1007 
šum
 
·»Á
;

1008 
ifs
 >> 
·»Á
;

1009 
Çme_Ën
;

1010 
ifs
 >> 
Çme_Ën
;

1011 
buf
;

1012 
¡d
::
¡ršg
 
Çme
;

1013 
ifs
.
	`g‘
(
buf
);

1014 
i
 = 0; i < 
Çme_Ën
; i++){

1015 
ifs
.
	`g‘
(
buf
);

1016 
Çme
 +ğ
buf
;

1019 
mode
;

1020 
ifs
 >> 
mode
;

1021 
šum
 
šo_out
;

1022 
	`ü—‹
(
·»Á
, 
Çme
.
	`c_¡r
(), 
mode
, 
šo_out
);

1026 if(
buf
 == "write"){

1027 
šum
 
šo
;

1028 
ifs
 >> 
šo
;

1029 
size_t
 
size
;

1030 
ifs
 >> 
size
;

1031 
off_t
 
off
;

1032 
ifs
 >> 
off
;

1033 
¡d
::
¡ršg
 
d©a
;

1034 
buf
;

1035 
ifs
.
	`g‘
(
buf
);

1036 
size_t
 
i
 = 0; i < 
size
; i++){

1037 
ifs
.
	`g‘
(
buf
);

1038 
d©a
 +ğ
buf
;

1041 
size_t
 
by‹s_wr™‹n
;

1042 
	`wr™e
(
šo
, 
size
, 
off
, 
d©a
.
	`c_¡r
(), 
by‹s_wr™‹n
);

1045 if(
buf
 == "unlink"){

1046 
šum
 
·»Á
;

1047 
ifs
 >> 
·»Á
;

1048 
Çme_Ën
;

1049 
ifs
 >> 
Çme_Ën
;

1050 
buf
;

1051 
¡d
::
¡ršg
 
Çme
;

1052 
ifs
.
	`g‘
(
buf
);

1053 
i
 = 0; i < 
Çme_Ën
; i++){

1054 
ifs
.
	`g‘
(
buf
);

1055 
Çme
 +ğ
buf
;

1058 
	`uÆšk
(
·»Á
, 
Çme
.
	`c_¡r
());

1061 if(
buf
 == "mkdir"){

1062 
šum
 
·»Á
;

1063 
ifs
 >> 
·»Á
;

1064 
Çme_Ën
;

1065 
ifs
 >> 
Çme_Ën
;

1066 
buf
;

1067 
¡d
::
¡ršg
 
Çme
;

1068 
ifs
.
	`g‘
(
buf
);

1069 
i
 = 0; i < 
Çme_Ën
; i++){

1070 
ifs
.
	`g‘
(
buf
);

1071 
Çme
 +ğ
buf
;

1074 
mode_t
 
mode
;

1075 
ifs
 >> 
mode
;

1076 
šum
 
šo_out
;

1078 
	`mkdœ
(
·»Á
, 
Çme
.
	`c_¡r
(), 
mode
, 
šo_out
);

1081 if(
buf
 == "symlink"){

1082 
šum
 
·»Á
;

1083 
ifs
 >> 
·»Á
;

1084 
Çme_Ën
;

1085 
ifs
 >> 
Çme_Ën
;

1086 
buf
;

1087 
¡d
::
¡ršg
 
Çme
;

1088 
¡d
::
¡ršg
 
·th
;

1089 
ifs
.
	`g‘
(
buf
);

1090 
i
 = 0; i < 
Çme_Ën
; i++){

1091 
ifs
.
	`g‘
(
buf
);

1092 
Çme
 +ğ
buf
;

1094 
·th_Ën
;

1095 
ifs
 >> 
·th_Ën
;

1096 
ifs
.
	`g‘
(
buf
);

1097 
i
 = 0; i < 
·th_Ën
; i++){

1098 
ifs
.
	`g‘
(
buf
);

1099 
·th
 +ğ
buf
;

1101 
šum
 
šo_out
;

1103 
	`symlšk
(
·»Á
, 
Çme
.
	`c_¡r
(), 
·th
.c_¡r(), 
šo_out
);

1106 if(
buf
 == "version"){

1107 
v”siÚ
;

1108 
ifs
 >> 
v”siÚ
;

1111 
cur_lše
 ++;

1114 
»cov”šg
 = 0;

1115 
	}
}

1118 
	gyfs_ş›Á
::
	$log_£‰r
(
šum
 
šo
, 
size_t
 
size
)

1122 if(
»cov”šg
)

1125 
lc
->
	`acquœe
(0);

1126 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

1127 if(!
ofs
){

1128 
	`´štf
("Open†og fileƒrror!\n");

1132 
¡d
::
¡ršg
 
buf
;

1133 
buf
 += "setattr ";

1134 
buf
 +ğ
	`i2n
(
šo
);

1135 
buf
 += " ";

1136 
buf
 +ğ
	`i2n
(
size
);

1137 
buf
 += "\n";

1138 
ofs
 << 
buf
;

1139 
ofs
.
	`şo£
();

1140 
lc
->
	`»Ëa£
(0);

1141 
	}
}

1144 
	gyfs_ş›Á
::
	$log_ü—‹
(
šum
 
·»Á
, cÚ¡ *
Çme
, 
mode_t
 
mode
)

1149 if(
»cov”šg
)

1152 
lc
->
	`acquœe
(0);

1153 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

1154 if(!
ofs
){

1155 
	`´štf
("Open†og fileƒrror!\n");

1159 
Çme_Ën
 = 
	`¡¾’
(
Çme
);

1160 
¡d
::
¡ršg
 
Çme_¡r
 = std::
	`¡ršg
(
Çme
);

1162 
¡d
::
¡ršg
 
buf
;

1163 
buf
 += "create ";

1164 
buf
 +ğ
	`i2n
(
·»Á
);

1165 
buf
 += " ";

1166 
buf
 +ğ
	`i2n
(
Çme_Ën
);

1167 
buf
 += " ";

1168 
buf
 +ğ
Çme_¡r
;

1169 
buf
 += " ";

1170 
buf
 +ğ
	`i2n
(
mode
);

1171 
buf
 += "\n";

1172 
ofs
 << 
buf
;

1173 
ofs
.
	`şo£
();

1174 
lc
->
	`»Ëa£
(0);

1175 
	}
}

1178 
	gyfs_ş›Á
::
	$log_wr™e
(
šum
 
šo
, 
size_t
 
size
, 
off_t
 
off
, cÚ¡ *
d©a
)

1182 if(
»cov”šg
)

1185 
lc
->
	`acquœe
(0);

1186 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

1187 if(!
ofs
){

1188 
	`´štf
("Open†og fileƒrror!\n");

1192 
¡d
::
¡ršg
 
buf
;

1193 
buf
 += "write ";

1194 
buf
 +ğ
	`i2n
(
šo
);

1195 
buf
 += " ";

1196 
buf
 +ğ
	`i2n
(
size
);

1197 
buf
 += " ";

1198 
buf
 +ğ
	`i2n
(
off
);

1199 
buf
 += " ";

1200 
size_t
 
i
 = 0; i < 
size
; i++){

1201 
buf
 +ğ
d©a
[
i
];

1203 
buf
 += "\n";

1204 
ofs
 << 
buf
;

1205 
ofs
.
	`şo£
();

1206 
lc
->
	`»Ëa£
(0);

1208 
	}
}

1211 
	gyfs_ş›Á
::
	$log_uÆšk
(
šum
 
·»Á
, cÚ¡ *
Çme
)

1215 if(
»cov”šg
)

1218 
lc
->
	`acquœe
(0);

1219 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

1220 if(!
ofs
){

1221 
	`´štf
("Open†og fileƒrror!\n");

1225 
Çme_Ën
 = 
	`¡¾’
(
Çme
);

1226 
¡d
::
¡ršg
 
Çme_¡r
 = std::
	`¡ršg
(
Çme
);

1228 
¡d
::
¡ršg
 
buf
;

1229 
buf
 += "unlink ";

1230 
buf
 +ğ
	`i2n
(
·»Á
);

1231 
buf
 += " ";

1232 
buf
 +ğ
	`i2n
(
Çme_Ën
);

1233 
buf
 += " ";

1234 
buf
 +ğ
Çme_¡r
;

1235 
buf
 += "\n";

1236 
ofs
 << 
buf
;

1237 
ofs
.
	`şo£
();

1238 
lc
->
	`»Ëa£
(0);

1240 
	}
}

1243 
	gyfs_ş›Á
::
	$log_mkdœ
(
šum
 
·»Á
, cÚ¡ *
Çme
, 
mode_t
 
mode
)

1247 if(
»cov”šg
)

1250 
lc
->
	`acquœe
(0);

1251 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

1252 if(!
ofs
){

1253 
	`´štf
("Open†og fileƒrror!\n");

1257 
Çme_Ën
 = 
	`¡¾’
(
Çme
);

1258 
¡d
::
¡ršg
 
Çme_¡r
 = std::
	`¡ršg
(
Çme
);

1260 
¡d
::
¡ršg
 
buf
;

1261 
buf
 += "mkdir ";

1262 
buf
 +ğ
	`i2n
(
·»Á
);

1263 
buf
 += " ";

1264 
buf
 +ğ
	`i2n
(
Çme_Ën
);

1265 
buf
 += " ";

1266 
buf
 +ğ
Çme_¡r
;

1267 
buf
 += " ";

1268 
buf
 +ğ
	`i2n
(
mode
);

1269 
buf
 += "\n";

1270 
ofs
 << 
buf
;

1271 
ofs
.
	`şo£
();

1272 
lc
->
	`»Ëa£
(0);

1274 
	}
}

1277 
	gyfs_ş›Á
::
	$log_symlšk
(
šum
 
·»Á
, cÚ¡ *
Çme
, cÚ¡ *
·th
)

1281 if(
»cov”šg
)

1284 
lc
->
	`acquœe
(0);

1285 
¡d
::
of¡»am
 
	`ofs
("vşog", std::
ios
::
­p
);

1286 if(!
ofs
){

1287 
	`´štf
("Open†og fileƒrror!\n");

1291 
Çme_Ën
 = 
	`¡¾’
(
Çme
);

1292 
·th_Ën
 = 
	`¡¾’
(
·th
);

1293 
¡d
::
¡ršg
 
Çme_¡r
 = std::
	`¡ršg
(
Çme
);

1294 
¡d
::
¡ršg
 
·th_¡r
 = std::
	`¡ršg
(
·th
);

1296 
¡d
::
¡ršg
 
buf
;

1297 
buf
 += "symlink ";

1298 
buf
 +ğ
	`i2n
(
·»Á
);

1299 
buf
 += " ";

1300 
buf
 +ğ
	`i2n
(
Çme_Ën
);

1301 
buf
 += " ";

1302 
buf
 +ğ
Çme_¡r
;

1303 
buf
 += " ";

1304 
buf
 +ğ
	`i2n
(
·th_Ën
);

1305 
buf
 += " ";

1306 
buf
 +ğ
·th_¡r
;

1307 
buf
 += "\n";

1308 
ofs
 << 
buf
;

1309 
ofs
.
	`şo£
();

1310 
lc
->
	`»Ëa£
(0);

1312 
	}
}

	@yfs_client.h

1 #iâdeà
yfs_ş›Á_h


2 
	#yfs_ş›Á_h


	)

4 
	~<¡ršg
>

5 
	~"lock_´ÙocŞ.h
"

6 
	~"lock_ş›Á.h
"

9 
	~"ex‹Á_ş›Á.h
"

10 
	~<veùÜ
>

13 
	#CA_FILE
 "./cert/ca.pem:

14 
	#USERFILE
 "./‘c/·sswd"

	)

15 
	#GROUPFILE
 "./‘c/group"

	)

18 şas 
	cyfs_ş›Á
 {

19 
ex‹Á_ş›Á
 *
	mec
;

20 
lock_ş›Á
 *
	mlc
;

21 
	mpublic
:

23 
	tšum
;

24 
	exx¡©us
 { 
	mOK
, 
	mRPCERR
, 
	mNOENT
, 
	mIOERR
, 
	mEXIST
,

25 
	mNOPEM
, 
	mERRPEM
, 
	mEINVA
, 
	mECTIM
, 
	mENUSE
 };

27 
	t¡©us
;

30 
	sfe¡©
 {

31 
	gsize
;

32 
	gmode
;

33 
	guid
;

34 
	ggid
;

37 
	sfešfo
 {

38 
	gsize
;

39 
	g©ime
;

40 
	gmtime
;

41 
	gùime
;

42 
	gmode
;

43 
	guid
;

44 
	ggid
;

46 
	sdœšfo
 {

47 
	g©ime
;

48 
	gmtime
;

49 
	gùime
;

50 
	gmode
;

51 
	guid
;

52 
	ggid
;

55 
	sdœ’t
 {

56 
	g¡d
::
¡ršg
 
Çme
;

57 
	gyfs_ş›Á
::
šum
 inum;

60 
	g´iv©e
:

61 
cur_v”siÚ
;

62 
	g»cov”šg
;

63 
	g¡d
::
¡ršg
 
f’ame
(
šum
);

64 
šum
 
n2i
(
¡d
::
¡ršg
);

66 şas 
	cDœTabË


68 
	g´iv©e
:

69 
¡d
::
m­
<¡d::
¡ršg
, 
	gšum
> 
	gli¡
;

70 
	gpublic
:

71 
DœTabË
(
¡d
::
¡ršg
);

72 
	g¡d
::
¡ršg
 
dump2¡r
();

73 
boŞ
 
lookup
(
¡d
::
¡ršg
, 
šum
&);

74 
š£¹
(
¡d
::
¡ršg
, 
šum
);

75 
dump2li¡
(
¡d
::
li¡
<
dœ’t
>&);

76 
”a£
(
¡d
::
¡ršg
);

80 
	gpublic
:

81 
yfs_ş›Á
();

82 
yfs_ş›Á
(
¡d
::
¡ršg
, std::string, const *);

87 
boŞ
 
isfe
(
šum
);

88 
boŞ
 
isdœ
(
šum
);

90 
g‘fe
(
šum
, 
fešfo
 &);

91 
g‘dœ
(
šum
, 
dœšfo
 &);

93 
£‰r
(
šum
, 
fe¡©
, );

94 
lookup
(
šum
, cÚ¡ *, 
boŞ
 &, inum &);

95 
ü—‹
(
šum
, cÚ¡ *, 
mode_t
, inum &);

96 
»addœ
(
šum
, 
¡d
::
li¡
<
dœ’t
> &);

97 
wr™e
(
šum
, 
size_t
, 
off_t
, const *, size_t &);

98 
»ad
(
šum
, 
size_t
, 
off_t
, 
¡d
::
¡ršg
 &);

99 
uÆšk
(
šum
,const *);

100 
mkdœ
(
šum
 , cÚ¡ *, 
mode_t
 , inum &);

102 
v”ify
(cÚ¡ * 
û¹_fe
, *);

105 
symlšk
(
šum
, const *, const *, inum &);

106 
»adlšk
(
šum
, 
¡d
::
¡ršg
 &);

109 
	g¡d
::
¡ršg
 
i2n
(
šum
);

111 
v”siÚ_comm™
();

112 
´ev_v”siÚ
();

113 
Ãxt_v”siÚ
();

114 
»cov”y
();

115 
log_£‰r
(
šum
, 
size_t
);

116 
log_ü—‹
(
šum
, cÚ¡ *, 
mode_t
);

117 
log_wr™e
(
šum
, 
size_t
, 
off_t
, const *);

118 
log_uÆšk
(
šum
, const *);

119 
log_mkdœ
(
šum
, cÚ¡ *, 
mode_t
);

120 
log_symlšk
(
šum
, const *, const *);

	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


119 #undeà
¡©ic_as£¹


120 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià
defšed
 
__USE_MISC
 && !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_MISC


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ifdeà
__USE_POSIX


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3));

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

195 
	#»addœ_r
 
»addœ64_r


	)

199 #ifdeà
__USE_LARGEFILE64


200 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

201 
dœ’t64
 *
__»¡riù
 
__’Œy
,

202 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

203 
	`__nÚnuÎ
 ((1, 2, 3));

208 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

210 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


211 
	~<b™s/ty³s.h
>

214 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

217 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

220 #ifdeà
__USE_XOPEN2K8


223 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


226 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

229 #ifdeà
__USE_MISC


230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__Ãed_size_t


	)

244 
	~<¡ddef.h
>

253 #iâdeà
__USE_FILE_OFFSET64


254 
	$sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

255 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

256 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

257 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

258 cÚ¡ 
dœ’t
 **))

259 
	`__nÚnuÎ
 ((1, 2));

261 #ifdeà
__REDIRECT


262 
	`__REDIRECT
 (
sÿndœ
,

263 (cÚ¡ *
__»¡riù
 
__dœ
,

264 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

265 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

266 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

267 cÚ¡ 
dœ’t
 **)),

268 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

270 
	#sÿndœ
 
sÿndœ64


	)

274 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


277 
	$sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

278 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

279 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

280 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

281 cÚ¡ 
dœ’t64
 **))

282 
	`__nÚnuÎ
 ((1, 2));

285 #ifdeà
__USE_GNU


291 #iâdeà
__USE_FILE_OFFSET64


292 
	$sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

293 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

294 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

295 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

296 cÚ¡ 
dœ’t
 **))

297 
	`__nÚnuÎ
 ((2, 3));

299 #ifdeà
__REDIRECT


300 
	`__REDIRECT
 (
sÿndœ©
,

301 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

302 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

303 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

304 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

305 cÚ¡ 
dœ’t
 **)),

306 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

308 
	#sÿndœ©
 
sÿndœ©64


	)

314 
	$sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

315 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

316 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

317 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

318 cÚ¡ 
dœ’t64
 **))

319 
	`__nÚnuÎ
 ((2, 3));

323 #iâdeà
__USE_FILE_OFFSET64


324 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

325 cÚ¡ 
dœ’t
 **
__e2
)

326 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

328 #ifdeà
__REDIRECT


329 
	`__REDIRECT_NTH
 (
®phasÜt
,

330 (cÚ¡ 
dœ’t
 **
__e1
,

331 cÚ¡ 
dœ’t
 **
__e2
),

332 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

334 
	#®phasÜt
 
®phasÜt64


	)

338 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


339 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

340 cÚ¡ 
dœ’t64
 **
__e2
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 #ifdeà
__USE_MISC


351 #iâdeà
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

353 
size_t
 
__nby‹s
,

354 
__off_t
 *
__»¡riù
 
__ba£p
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

357 #ifdeà
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

359 (
__fd
, *
__»¡riù
 
__buf
,

360 
size_t
 
__nby‹s
,

361 
__off64_t
 *
__»¡riù
 
__ba£p
),

362 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

364 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

368 #ifdeà
__USE_LARGEFILE64


369 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

370 
size_t
 
__nby‹s
,

371 
__off64_t
 *
__»¡riù
 
__ba£p
)

372 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

376 #ifdeà
__USE_GNU


378 #iâdeà
__USE_FILE_OFFSET64


379 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

380 cÚ¡ 
dœ’t
 **
__e2
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

383 #ifdeà
__REDIRECT


384 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

385 (cÚ¡ 
dœ’t
 **
__e1
,

386 cÚ¡ 
dœ’t
 **
__e2
),

387 
v”siÚsÜt64
)

388 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

390 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

394 #ifdeà
__USE_LARGEFILE64


395 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

396 cÚ¡ 
dœ’t64
 **
__e2
)

397 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

39 #ifdeà
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oæag
) \

41 (((
oæag
è& 
O_CREAT
è!ğ0 || ((oæagè& 
__O_TMPFILE
è=ğ__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oæag
è(((oæagè& 
O_CREAT
è!ğ0)

	)

49 #iâdeà
__mode_t_defšed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_defšed


	)

54 #iâdeà
__off_t_defšed


55 #iâdeà
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

68 #iâdeà
__pid_t_defšed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_defšed


	)

74 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


75 
	#__Ãed_time¥ec


	)

76 
	~<time.h
>

77 
	~<b™s/¡©.h
>

79 
	#S_IFMT
 
__S_IFMT


	)

80 
	#S_IFDIR
 
__S_IFDIR


	)

81 
	#S_IFCHR
 
__S_IFCHR


	)

82 
	#S_IFBLK
 
__S_IFBLK


	)

83 
	#S_IFREG
 
__S_IFREG


	)

84 #ifdeà
__S_IFIFO


85 
	#S_IFIFO
 
__S_IFIFO


	)

87 #ifdeà
__S_IFLNK


88 
	#S_IFLNK
 
__S_IFLNK


	)

90 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


91 
	#S_IFSOCK
 
__S_IFSOCK


	)

96 
	#S_ISUID
 
__S_ISUID


	)

97 
	#S_ISGID
 
__S_ISGID


	)

99 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


101 
	#S_ISVTX
 
__S_ISVTX


	)

104 
	#S_IRUSR
 
__S_IREAD


	)

105 
	#S_IWUSR
 
__S_IWRITE


	)

106 
	#S_IXUSR
 
__S_IEXEC


	)

108 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

110 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

111 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

112 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

114 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

116 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

117 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

118 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

120 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

123 #ifdef 
__USE_MISC


124 #iâdeà
R_OK


127 
	#R_OK
 4

	)

128 
	#W_OK
 2

	)

129 
	#X_OK
 1

	)

130 
	#F_OK
 0

	)

135 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


136 
	#SEEK_SET
 0

	)

137 
	#SEEK_CUR
 1

	)

138 
	#SEEK_END
 2

	)

146 
fú
 (
__fd
, 
__cmd
, ...);

155 #iâdeà
__USE_FILE_OFFSET64


156 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

158 #ifdeà
__REDIRECT


159 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

160 
	`__nÚnuÎ
 ((1));

162 
	#İ’
 
İ’64


	)

165 #ifdeà
__USE_LARGEFILE64


166 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

169 #ifdeà
__USE_ATFILE


179 #iâdeà
__USE_FILE_OFFSET64


180 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

181 
	`__nÚnuÎ
 ((2));

183 #ifdeà
__REDIRECT


184 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

185 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

187 
	#İ’©
 
İ’©64


	)

190 #ifdeà
__USE_LARGEFILE64


191 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

192 
	`__nÚnuÎ
 ((2));

201 #iâdeà
__USE_FILE_OFFSET64


202 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

204 #ifdeà
__REDIRECT


205 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

206 
ü—t64
è
	`__nÚnuÎ
 ((1));

208 
	#ü—t
 
ü—t64


	)

211 #ifdeà
__USE_LARGEFILE64


212 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

215 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

216 && !
defšed
 
__USE_POSIX
))

225 
	#F_ULOCK
 0

	)

226 
	#F_LOCK
 1

	)

227 
	#F_TLOCK
 2

	)

228 
	#F_TEST
 3

	)

230 #iâdeà
__USE_FILE_OFFSET64


231 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

233 #ifdeà
__REDIRECT


234 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

236 
	#lockf
 
lockf64


	)

239 #ifdeà
__USE_LARGEFILE64


240 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

244 #ifdeà
__USE_XOPEN2K


247 #iâdeà
__USE_FILE_OFFSET64


248 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

249 
__advi£
è
__THROW
;

251 #ifdeà
__REDIRECT_NTH


252 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

253 
__off64_t
 
__Ën
, 
__advi£
),

254 
posix_çdvi£64
);

256 
	#posix_çdvi£
 
posix_çdvi£64


	)

259 #ifdeà
__USE_LARGEFILE64


260 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

261 
__advi£
è
__THROW
;

269 #iâdeà
__USE_FILE_OFFSET64


270 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

272 #ifdeà
__REDIRECT


273 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

274 
__off64_t
 
__Ën
),

275 
posix_çÎoÿ‹64
);

277 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

280 #ifdeà
__USE_LARGEFILE64


281 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

287 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

288 && 
defšed
 
__va_¬g_·ck_Ën


289 
	~<b™s/fú2.h
>

292 
__END_DECLS


	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<¡dšt.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	#__Ãed_sigev’t_t


	)

37 
	~<b™s/sigšfo.h
>

38 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 
	~<b™s/Ãtdb.h
>

45 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

46 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

47 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

49 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

50 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

53 
	g__BEGIN_DECLS


55 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ifdeà
__USE_MISC


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifdeà
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifdeà
__USE_MISC


92 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

95 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

100 
	sho¡’t


102 *
h_Çme
;

103 **
h_®Ÿ£s
;

104 
h_add¹y³
;

105 
h_Ëngth
;

106 **
h_addr_li¡
;

107 #ifdeà
__USE_MISC


108 
	#h_addr
 
h_addr_li¡
[0]

	)

117 
	`£tho¡’t
 (
__¡ay_İ’
);

123 
	`’dho¡’t
 ();

130 
ho¡’t
 *
	`g‘ho¡’t
 ();

137 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

138 
__ty³
);

144 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

146 #ifdeà
__USE_MISC


155 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

167 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

168 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

169 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

170 *
__»¡riù
 
__h_”ºİ
);

172 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

173 
__ty³
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

185 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

186 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

187 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

188 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

189 *
__»¡riù
 
__h_”ºİ
);

198 
	`£Š‘’t
 (
__¡ay_İ’
);

204 
	`’dÃ‹Á
 ();

211 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

218 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

224 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

226 #ifdef 
__USE_MISC


237 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

248 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

249 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

250 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

251 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

252 *
__»¡riù
 
__h_”ºİ
);

257 
	s£rv’t


259 *
s_Çme
;

260 **
s_®Ÿ£s
;

261 
s_pÜt
;

262 *
s_´Ùo
;

270 
	`£t£rv’t
 (
__¡ay_İ’
);

276 
	`’d£rv’t
 ();

283 
£rv’t
 *
	`g‘£rv’t
 ();

290 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

297 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

300 #ifdef 
__USE_MISC


308 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

309 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

310 
£rv’t
 **
__»¡riù
 
__»suÉ
);

312 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

313 cÚ¡ *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

318 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

319 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

320 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

321 
£rv’t
 **
__»¡riù
 
__»suÉ
);

326 
	s´ÙÛÁ


328 *
p_Çme
;

329 **
p_®Ÿ£s
;

330 
p_´Ùo
;

338 
	`£rÙÛÁ
 (
__¡ay_İ’
);

344 
	`’d´ÙÛÁ
 ();

351 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

357 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

363 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

366 #ifdef 
__USE_MISC


374 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

383 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

384 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

385 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

386 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

395 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

403 
	`’dÃtg»Á
 ();

412 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

413 **
__»¡riù
 
__u£½
,

414 **
__»¡riù
 
__domašp
);

423 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

424 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

432 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

433 **
__»¡riù
 
__u£½
,

434 **
__»¡riù
 
__domašp
,

435 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

439 #ifdeà
__USE_MISC


451 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

452 cÚ¡ *
__»¡riù
 
__locu£r
,

453 cÚ¡ *
__»¡riù
 
__»mu£r
,

454 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

463 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

464 cÚ¡ *
__»¡riù
 
__locu£r
,

465 cÚ¡ *
__»¡riù
 
__»mu£r
,

466 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

467 
§_çmy_t
 
__af
);

479 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

480 cÚ¡ *
__»¡riù
 
__Çme
,

481 cÚ¡ *
__»¡riù
 
__·ss
,

482 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

491 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

492 cÚ¡ *
__»¡riù
 
__Çme
,

493 cÚ¡ *
__»¡riù
 
__·ss
,

494 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

495 
§_çmy_t
 
__af
);

505 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

506 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

515 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

516 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

517 
§_çmy_t
 
__af
);

528 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

529 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

539 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

540 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

541 
§_çmy_t
 
__af
);

551 
	`¼esvpÜt
 (*
__®pÜt
);

560 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

565 #ifdeà
__USE_XOPEN2K


567 
	saddršfo


569 
ai_æags
;

570 
ai_çmy
;

571 
ai_sockty³
;

572 
ai_´ÙocŞ
;

573 
sockËn_t
 
ai_add¾’
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ÿnÚÇme
;

576 
addršfo
 *
ai_Ãxt
;

579 #ifdeà
__USE_GNU


581 
	sgaicb


583 cÚ¡ *
¬_Çme
;

584 cÚ¡ *
¬_£rviû
;

585 cÚ¡ 
addršfo
 *
¬_»que¡
;

586 
addršfo
 *
¬_»suÉ
;

588 
__»tuº
;

589 
__glibc_»£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifdeà
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifdeà
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifdeà
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifdeà
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

663 cÚ¡ *
__»¡riù
 
__£rviû
,

664 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

665 
addršfo
 **
__»¡riù
 
__·i
);

668 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

671 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

677 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

678 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

679 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

680 
sockËn_t
 
__£rvËn
, 
__æags
);

683 #ifdeà
__USE_GNU


692 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

693 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

703 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

704 cÚ¡ 
time¥ec
 *
__timeout
);

707 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

710 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<¡dšt.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #iâdeà
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ušt16_t
 
	tš_pÜt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

186 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

190 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

194 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #iâdeà
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

209 #iâdeà
__USE_KERNEL_IPV6_DEFS


211 
	sš6_addr


215 
ušt8_t
 
	m__u6_addr8
[16];

216 #ifdeà
__USE_MISC


217 
ušt16_t
 
	m__u6_addr16
[8];

218 
ušt32_t
 
	m__u6_addr32
[4];

220 } 
	m__š6_u
;

221 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

222 #ifdeà
__USE_MISC


223 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

224 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

229 cÚ¡ 
š6_addr
 
š6addr_ªy
;

230 cÚ¡ 
š6_addr
 
š6addr_loİback
;

231 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

232 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

234 
	#INET_ADDRSTRLEN
 16

	)

235 
	#INET6_ADDRSTRLEN
 46

	)

239 
	ssockaddr_š


241 
__SOCKADDR_COMMON
 (
sš_
);

242 
š_pÜt_t
 
	msš_pÜt
;

243 
š_addr
 
	msš_addr
;

246 
	msš_z”o
[ (
sockaddr
) -

247 
__SOCKADDR_COMMON_SIZE
 -

248  (
š_pÜt_t
) -

249  (
š_addr
)];

252 #iâdeà
__USE_KERNEL_IPV6_DEFS


254 
	ssockaddr_š6


256 
__SOCKADDR_COMMON
 (
sš6_
);

257 
š_pÜt_t
 
	msš6_pÜt
;

258 
ušt32_t
 
	msš6_æowšfo
;

259 
š6_addr
 
	msš6_addr
;

260 
ušt32_t
 
	msš6_scİe_id
;

264 #ifdeà
__USE_MISC


266 
	s_m»q


269 
š_addr
 
	mimr_muÉŸddr
;

272 
š_addr
 
	mimr_š‹rçû
;

275 
	s_m»q_sourû


278 
š_addr
 
	mimr_muÉŸddr
;

281 
š_addr
 
	mimr_š‹rçû
;

284 
š_addr
 
	mimr_sourûaddr
;

288 #iâdeà
__USE_KERNEL_IPV6_DEFS


290 
	sv6_m»q


293 
š6_addr
 
	mv6mr_muÉŸddr
;

296 
	mv6mr_š‹rçû
;

300 #ifdeà
__USE_MISC


302 
	sgroup_»q


305 
ušt32_t
 
	mgr_š‹rçû
;

308 
sockaddr_¡Üage
 
	mgr_group
;

311 
	sgroup_sourû_»q


314 
ušt32_t
 
	mg¤_š‹rçû
;

317 
sockaddr_¡Üage
 
	mg¤_group
;

320 
sockaddr_¡Üage
 
	mg¤_sourû
;

325 
	s_msf‹r


328 
š_addr
 
	mimsf_muÉŸddr
;

331 
š_addr
 
	mimsf_š‹rçû
;

334 
ušt32_t
 
	mimsf_fmode
;

337 
ušt32_t
 
	mimsf_num¤c
;

339 
š_addr
 
	mimsf_¦i¡
[1];

342 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

343 -  (
š_addr
) \

344 + (
num¤c
è*  (
š_addr
))

	)

346 
	sgroup_f‹r


349 
ušt32_t
 
	mgf_š‹rçû
;

352 
sockaddr_¡Üage
 
	mgf_group
;

355 
ušt32_t
 
	mgf_fmode
;

358 
ušt32_t
 
	mgf_num¤c
;

360 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

363 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

364 -  (
sockaddr_¡Üage
) \

365 + ((
num¤c
) \

366 *  (
sockaddr_¡Üage
)))

	)

376 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

381 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

382 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

384 
	~<’dŸn.h
>

387 
	~<b™s/by‹sw­.h
>

389 #ifdeà
__OPTIMIZE__


393 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


396 
	#Áohl
(
x
è(x)

	)

397 
	#Áohs
(
x
è(x)

	)

398 
	#htÚl
(
x
è(x)

	)

399 
	#htÚs
(
x
è(x)

	)

401 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


402 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

404 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

405 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

410 #ifdeà
__GNUC__


411 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

412 (
__ex‹nsiÚ__
 \

413 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

414 
__a
->
s6_addr32
[0] == 0 \

415 && 
__a
->
s6_addr32
[1] == 0 \

416 && 
__a
->
s6_addr32
[2] == 0 \

417 && 
__a
->
s6_addr32
[3] =ğ0; 
	}
}))

	)

419 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

420 (
__ex‹nsiÚ__
 \

421 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

422 
__a
->
s6_addr32
[0] == 0 \

423 && 
__a
->
s6_addr32
[1] == 0 \

424 && 
__a
->
s6_addr32
[2] == 0 \

425 && 
__a
->
s6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

427 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

428 (
__ex‹nsiÚ__
 \

429 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

430 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

432 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

433 (
__ex‹nsiÚ__
 \

434 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

435 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

437 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

438 (
__ex‹nsiÚ__
 \

439 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

440 
__a
->
s6_addr32
[0] == 0 \

441 && 
__a
->
s6_addr32
[1] == 0 \

442 && 
__a
->
s6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

444 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

445 (
__ex‹nsiÚ__
 \

446 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

447 
__a
->
s6_addr32
[0] == 0 \

448 && 
__a
->
s6_addr32
[1] == 0 \

449 && 
__a
->
s6_addr32
[2] == 0 \

450 && 
	`Áohl
 (
__a
->
s6_addr32
[3]è> 1; }))

	)

452 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

453 (
__ex‹nsiÚ__
 \

454 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

455 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

456 
__a
->
s6_addr32
[0] =ğ
__b
->s6_addr32[0] \

457 && 
__a
->
s6_addr32
[1] =ğ
__b
->s6_addr32[1] \

458 && 
__a
->
s6_addr32
[2] =ğ
__b
->s6_addr32[2] \

459 && 
__a
->
s6_addr32
[3] =ğ
__b
->s6_addr32[3]; }))

	)

461 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

462 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

464 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

465 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

467 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

468 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

470 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

471 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

473 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

474 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

475 =ğ
	`htÚl
 (0xã800000))

	)

477 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

478 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

479 =ğ
	`htÚl
 (0xãc00000))

	)

481 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

482 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

483 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

484 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

486 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

487 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

488 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

489 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

490 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

492 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

493 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

495 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

496 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

499 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

501 #ifdeà
__USE_MISC


503 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

506 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

507 
__THROW
;

511 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

512 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

513 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

515 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

516 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

517 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

519 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

520 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

521 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

523 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

524 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

525 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

527 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

528 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

529 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

532 #ifdeà
__USE_GNU


533 
cmsghdr
;

535 #iâdeà
__USE_KERNEL_IPV6_DEFS


537 
	sš6_pktšfo


539 
š6_addr
 
i6_addr
;

540 
i6_ifšdex
;

544 
	s6_mtušfo


546 
sockaddr_š6
 
6m_addr
;

547 
ušt32_t
 
6m_mtu
;

552 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

553 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

554 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

555 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

557 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

558 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

560 
__muÉx
, 
__¶usy
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

565 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

566 
ušt8_t
 **
__Œp
, 
__ty³
)

567 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

571 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

572 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

573 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

574 **
__d©abuå
è
__THROW
;

575 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

576 
__THROW
;

577 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

578 
sockËn_t
 
__v®Ën
è
__THROW
;

579 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

583 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

584 **
__d©abuå
è
__THROW
;

585 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

586 
sockËn_t
 
__v®Ën
è
__THROW
;

590 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

591 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

592 
__£gm’ts
è
__THROW
;

593 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

594 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

595 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

596 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

597 
__THROW
;

603 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

604 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

605 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

606 
__THROW
;

609 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

610 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

611 
ušt32_t
 
__num¤c
,

612 cÚ¡ 
š_addr
 *
__¦i¡
)

613 
__THROW
;

617 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

618 cÚ¡ 
sockaddr
 *
__group
,

619 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

620 
ušt32_t
 *
__num¤c
,

621 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

624 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

625 cÚ¡ 
sockaddr
 *
__group
,

626 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

627 
ušt32_t
 
__num¤c
,

628 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

631 
__END_DECLS


	@/usr/include/netinet/tcp.h

32 #iâdeà
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<ã©u»s.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

64 
	#TCP_NOTSENT_LOWAT
 25

	)

66 
	#TCP_CC_INFO
 26

	)

68 
	#TCP_SAVE_SYN
 27

	)

70 
	#TCP_SAVED_SYN
 28

	)

73 #ifdeà
__USE_MISC


74 
	~<sys/ty³s.h
>

75 
	~<sys/sock‘.h
>

77 
u_št32_t
 
	ttı_£q
;

82 
	stıhdr


84 
__ex‹nsiÚ__
 union

88 
u_št16_t
 
	mth_¥Üt
;

89 
u_št16_t
 
	mth_dpÜt
;

90 
tı_£q
 
	mth_£q
;

91 
tı_£q
 
	mth_ack
;

92 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


93 
u_št8_t
 
	mth_x2
:4;

94 
u_št8_t
 
	mth_off
:4;

96 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


97 
u_št8_t
 
	mth_off
:4;

98 
u_št8_t
 
	mth_x2
:4;

100 
u_št8_t
 
	mth_æags
;

101 
	#TH_FIN
 0x01

	)

102 
	#TH_SYN
 0x02

	)

103 
	#TH_RST
 0x04

	)

104 
	#TH_PUSH
 0x08

	)

105 
	#TH_ACK
 0x10

	)

106 
	#TH_URG
 0x20

	)

107 
u_št16_t
 
	mth_wš
;

108 
u_št16_t
 
	mth_sum
;

109 
u_št16_t
 
	mth_u½
;

113 
u_št16_t
 
	msourû
;

114 
u_št16_t
 
	mde¡
;

115 
u_št32_t
 
	m£q
;

116 
u_št32_t
 
	mack_£q
;

117 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


118 
u_št16_t
 
	m»s1
:4;

119 
u_št16_t
 
	mdoff
:4;

120 
u_št16_t
 
	mfš
:1;

121 
u_št16_t
 
	msyn
:1;

122 
u_št16_t
 
	mr¡
:1;

123 
u_št16_t
 
	mpsh
:1;

124 
u_št16_t
 
	mack
:1;

125 
u_št16_t
 
	murg
:1;

126 
u_št16_t
 
	m»s2
:2;

127 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


128 
u_št16_t
 
	mdoff
:4;

129 
u_št16_t
 
	m»s1
:4;

130 
u_št16_t
 
	m»s2
:2;

131 
u_št16_t
 
	murg
:1;

132 
u_št16_t
 
	mack
:1;

133 
u_št16_t
 
	mpsh
:1;

134 
u_št16_t
 
	mr¡
:1;

135 
u_št16_t
 
	msyn
:1;

136 
u_št16_t
 
	mfš
:1;

140 
u_št16_t
 
	mwšdow
;

141 
u_št16_t
 
	mcheck
;

142 
u_št16_t
 
	murg_±r
;

149 
	mTCP_ESTABLISHED
 = 1,

150 
	mTCP_SYN_SENT
,

151 
	mTCP_SYN_RECV
,

152 
	mTCP_FIN_WAIT1
,

153 
	mTCP_FIN_WAIT2
,

154 
	mTCP_TIME_WAIT
,

155 
	mTCP_CLOSE
,

156 
	mTCP_CLOSE_WAIT
,

157 
	mTCP_LAST_ACK
,

158 
	mTCP_LISTEN
,

159 
	mTCP_CLOSING


162 
	#TCPOPT_EOL
 0

	)

163 
	#TCPOPT_NOP
 1

	)

164 
	#TCPOPT_MAXSEG
 2

	)

165 
	#TCPOLEN_MAXSEG
 4

	)

166 
	#TCPOPT_WINDOW
 3

	)

167 
	#TCPOLEN_WINDOW
 3

	)

168 
	#TCPOPT_SACK_PERMITTED
 4

	)

169 
	#TCPOLEN_SACK_PERMITTED
 2

	)

170 
	#TCPOPT_SACK
 5

	)

171 
	#TCPOPT_TIMESTAMP
 8

	)

172 
	#TCPOLEN_TIMESTAMP
 10

	)

173 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2è

	)

175 
	#TCPOPT_TSTAMP_HDR
 \

176 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

184 
	#TCP_MSS
 512

	)

186 
	#TCP_MAXWIN
 65535

	)

188 
	#TCP_MAX_WINSHIFT
 14

	)

190 
	#SOL_TCP
 6

	)

193 
	#TCPI_OPT_TIMESTAMPS
 1

	)

194 
	#TCPI_OPT_SACK
 2

	)

195 
	#TCPI_OPT_WSCALE
 4

	)

196 
	#TCPI_OPT_ECN
 8

	)

197 
	#TCPI_OPT_ECN_SEEN
 16

	)

198 
	#TCPI_OPT_SYN_DATA
 32

	)

201 
	etı_ÿ_¡©e


203 
	mTCP_CA_O³n
 = 0,

204 
	mTCP_CA_DisÜd”
 = 1,

205 
	mTCP_CA_CWR
 = 2,

206 
	mTCP_CA_Recov”y
 = 3,

207 
	mTCP_CA_Loss
 = 4

210 
	stı_šfo


212 
u_št8_t
 
	mtıi_¡©e
;

213 
u_št8_t
 
	mtıi_ÿ_¡©e
;

214 
u_št8_t
 
	mtıi_»Œªsm™s
;

215 
u_št8_t
 
	mtıi_´obes
;

216 
u_št8_t
 
	mtıi_backoff
;

217 
u_št8_t
 
	mtıi_İtiÚs
;

218 
u_št8_t
 
	mtıi_¢d_wsÿË
 : 4, 
	mtıi_rcv_wsÿË
 : 4;

220 
u_št32_t
 
	mtıi_¹o
;

221 
u_št32_t
 
	mtıi_©o
;

222 
u_št32_t
 
	mtıi_¢d_mss
;

223 
u_št32_t
 
	mtıi_rcv_mss
;

225 
u_št32_t
 
	mtıi_uÇcked
;

226 
u_št32_t
 
	mtıi_§cked
;

227 
u_št32_t
 
	mtıi_lo¡
;

228 
u_št32_t
 
	mtıi_»Œªs
;

229 
u_št32_t
 
	mtıi_çck‘s
;

232 
u_št32_t
 
	mtıi_Ï¡_d©a_£Á
;

233 
u_št32_t
 
	mtıi_Ï¡_ack_£Á
;

234 
u_št32_t
 
	mtıi_Ï¡_d©a_»cv
;

235 
u_št32_t
 
	mtıi_Ï¡_ack_»cv
;

238 
u_št32_t
 
	mtıi_pmtu
;

239 
u_št32_t
 
	mtıi_rcv_s¡h»sh
;

240 
u_št32_t
 
	mtıi_¹t
;

241 
u_št32_t
 
	mtıi_¹tv¬
;

242 
u_št32_t
 
	mtıi_¢d_s¡h»sh
;

243 
u_št32_t
 
	mtıi_¢d_cwnd
;

244 
u_št32_t
 
	mtıi_advmss
;

245 
u_št32_t
 
	mtıi_»Üd”šg
;

247 
u_št32_t
 
	mtıi_rcv_¹t
;

248 
u_št32_t
 
	mtıi_rcv_¥aû
;

250 
u_št32_t
 
	mtıi_tÙ®_»Œªs
;

255 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

257 
	stı_md5sig


259 
sockaddr_¡Üage
 
	mtım_addr
;

260 
u_št16_t
 
	m__tım_·d1
;

261 
u_št16_t
 
	mtım_keyËn
;

262 
u_št32_t
 
	m__tım_·d2
;

263 
u_št8_t
 
	mtım_key
[
TCP_MD5SIG_MAXKEYLEN
];

267 
	stı_»·œ_İt


269 
u_št32_t
 
	mİt_code
;

270 
u_št32_t
 
	mİt_v®
;

276 
	mTCP_NO_QUEUE
,

277 
	mTCP_RECV_QUEUE
,

278 
	mTCP_SEND_QUEUE
,

279 
	mTCP_QUEUES_NR
,

283 
	#TCP_COOKIE_MIN
 8

	)

284 
	#TCP_COOKIE_MAX
 16

	)

285 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

288 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0è

	)

289 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1è

	)

293 
	#TCP_S_DATA_IN
 (1 << 2è

	)

294 
	#TCP_S_DATA_OUT
 (1 << 3è

	)

296 
	#TCP_MSS_DEFAULT
 536U

	)

297 
	#TCP_MSS_DESIRED
 1220U

	)

299 
	stı_cook›_Œª§ùiÚs


301 
u_št16_t
 
	mtıù_æags
;

302 
u_št8_t
 
	m__tıù_·d1
;

303 
u_št8_t
 
	mtıù_cook›_desœed
;

304 
u_št16_t
 
	mtıù_s_d©a_desœed
;

305 
u_št16_t
 
	mtıù_u£d
;

306 
u_št8_t
 
	mtıù_v®ue
[
TCP_MSS_DEFAULT
];

	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


85 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


86 
	#PTHREAD_MUTEX_INITIALIZER
 \

87 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

88 #ifdeà
__USE_GNU


89 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

90 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

91 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

92 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

93 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

94 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

98 
	#PTHREAD_MUTEX_INITIALIZER
 \

99 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

100 #ifdeà
__USE_GNU


101 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

102 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

103 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

105 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

113 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


116 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

117 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

119 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


125 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


126 #ià
__WORDSIZE
 == 64

127 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

132 
	#PTHREAD_RWLOCK_INITIALIZER
 \

133 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

134 #ifdeà
__USE_GNU


135 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


136 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

137 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

138 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

140 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


141 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

142 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

143 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

145 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

146 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

147 0 } }

	)

157 
	mPTHREAD_INHERIT_SCHED
,

158 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

159 
	mPTHREAD_EXPLICIT_SCHED


160 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

167 
	mPTHREAD_SCOPE_SYSTEM
,

168 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

169 
	mPTHREAD_SCOPE_PROCESS


170 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

177 
	mPTHREAD_PROCESS_PRIVATE
,

178 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

179 
	mPTHREAD_PROCESS_SHARED


180 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

186 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

190 
	s_±h»ad_ş—nup_bufãr


192 (*
	m__routše
) (*);

193 *
	m__¬g
;

194 
	m__ÿnûÉy³
;

195 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

201 
	mPTHREAD_CANCEL_ENABLE
,

202 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

203 
	mPTHREAD_CANCEL_DISABLE


204 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

208 
	mPTHREAD_CANCEL_DEFERRED
,

209 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

210 
	mPTHREAD_CANCEL_ASYNCHRONOUS


211 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

213 
	#PTHREAD_CANCELED
 ((*è-1)

	)

217 
	#PTHREAD_ONCE_INIT
 0

	)

220 #ifdeà
__USE_XOPEN2K


224 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

228 
__BEGIN_DECLS


233 
	$±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

234 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

235 *(*
__¡¬t_routše
) (*),

236 *
__»¡riù
 
__¬g
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 3));

242 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

250 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

252 #ifdeà
__USE_GNU


255 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

263 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

264 cÚ¡ 
time¥ec
 *
__ab¡ime
);

271 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

275 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

278 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

279 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

287 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

290 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

291 
__THROW
 
	`__nÚnuÎ
 ((1));

294 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

295 *
__d‘ach¡©e
)

296 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

299 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

300 
__d‘ach¡©e
)

301 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 
size_t
 *
__gu¬dsize
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
size_t
 
__gu¬dsize
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

317 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

322 cÚ¡ 
sched_·¿m
 *
__»¡riù


323 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

326 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


327 
__©Œ
, *
__»¡riù
 
__pŞicy
)

328 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

331 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

332 
__THROW
 
	`__nÚnuÎ
 ((1));

335 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


336 
__©Œ
, *
__»¡riù
 
__šh”™
)

337 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

340 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

341 
__šh”™
)

342 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

347 *
__»¡riù
 
__scİe
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

352 
__THROW
 
	`__nÚnuÎ
 ((1));

355 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


356 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

357 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

363 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

364 *
__¡ackaddr
)

365 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

368 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


369 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

370 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

375 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

376 
size_t
 
__¡acksize
)

377 
__THROW
 
	`__nÚnuÎ
 ((1));

379 #ifdeà
__USE_XOPEN2K


381 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

382 **
__»¡riù
 
__¡ackaddr
,

383 
size_t
 *
__»¡riù
 
__¡acksize
)

384 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

389 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

390 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

393 #ifdeà
__USE_GNU


396 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

397 
size_t
 
__ıu£tsize
,

398 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

399 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

403 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

404 
size_t
 
__ıu£tsize
,

405 
ıu_£t_t
 *
__ıu£t
)

406 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

409 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

410 
__THROW
 
	`__nÚnuÎ
 ((1));

414 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

415 
__THROW
 
	`__nÚnuÎ
 ((1));

420 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((2));

429 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

430 cÚ¡ 
sched_·¿m
 *
__·¿m
)

431 
__THROW
 
	`__nÚnuÎ
 ((3));

434 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

435 *
__»¡riù
 
__pŞicy
,

436 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

437 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

440 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

441 
__THROW
;

444 #ifdeà
__USE_GNU


446 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

447 
size_t
 
__buæ’
)

448 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

452 
__THROW
 
	`__nÚnuÎ
 ((2));

456 #ifdeà
__USE_UNIX98


458 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

461 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

464 #ifdeà
__USE_GNU


469 
	$±h»ad_y›ld
 (è
__THROW
;

474 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

475 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

476 
__THROW
 
	`__nÚnuÎ
 ((3));

479 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

480 
ıu_£t_t
 *
__ıu£t
)

481 
__THROW
 
	`__nÚnuÎ
 ((3));

494 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

495 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

506 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

510 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

513 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

518 
	`±h»ad_‹¡ÿnûl
 ();

527 
__jmp_buf
 
__ÿnûl_jmp_buf
;

528 
__mask_was_§ved
;

529 } 
__ÿnûl_jmp_buf
[1];

530 *
__·d
[4];

531 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

534 #iâdeà
__ş—nup_fù_©Œibu‹


535 
	#__ş—nup_fù_©Œibu‹


	)

540 
	s__±h»ad_ş—nup_äame


542 (*
__ÿnûl_routše
) (*);

543 *
__ÿnûl_¬g
;

544 
__do_™
;

545 
__ÿnûl_ty³
;

548 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


549 #ifdeà
__ılu¥lus


551 şas 
	c__±h»ad_ş—nup_şass


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

558 
public
:

559 
	$__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

560 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

561 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

562 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

563 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

564 &
__ÿnûl_ty³
); 
	}
}

565 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

575 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

577 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

581 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

582 
__şäame
.
	`__£tdo™
 (
execu‹
); \

583 } 0)

	)

585 #ifdeà
__USE_GNU


589 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

591 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

592 
__şäame
.
	`__deãr
 ()

	)

597 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

598 
__şäame
.
	`__»¡Üe
 (); \

599 
__şäame
.
	`__£tdo™
 (
execu‹
); \

600 } 0)

	)

607 
__ex‹º_šlše
 

608 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

610 ià(
__äame
->
__do_™
)

611 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

612 
	}
}

621 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

623 
__±h»ad_ş—nup_äame
 
__şäame
 \

624 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

625 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

626 .
__do_™
 = 1 };

	)

630 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

631 
__şäame
.
__do_™
 = (
execu‹
); \

632 } 0)

	)

634 #ifdeà
__USE_GNU


638 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

640 
__±h»ad_ş—nup_äame
 
__şäame
 \

641 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

642 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

643 .
__do_™
 = 1 }; \

644 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

645 &
__şäame
.
__ÿnûl_ty³
)

	)

650 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

651 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

652 
__şäame
.
__do_™
 = (
execu‹
); \

653 } 0)

	)

664 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

666 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

667 (*
__ÿnûl_routše
è(*èğ(
routše
); \

668 *
__ÿnûl_¬g
 = (
¬g
); \

669 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

670 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

671 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

673 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

674 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

678 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

679 dØ{

	)

680 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

681 
__ş—nup_fù_©Œibu‹
;

685 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

688 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

689 ià(
execu‹
) \

690 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

691 } 0)

	)

692 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

693 
__ş—nup_fù_©Œibu‹
;

695 #ifdeà
__USE_GNU


699 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

701 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

702 (*
__ÿnûl_routše
è(*èğ(
routše
); \

703 *
__ÿnûl_¬g
 = (
¬g
); \

704 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

705 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

706 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

708 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

709 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

713 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

714 dØ{

	)

715 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

716 
__ş—nup_fù_©Œibu‹
;

721 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

724 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

725 ià(
execu‹
) \

726 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

727 
	}
} 0)

	)

728 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

729 
__ş—nup_fù_©Œibu‹
;

733 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

734 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

735 #iâdeà
SHARED


736 
	`__©Œibu‹__
 ((
__w—k__
))

742 
__jmp_buf_g
;

743 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

749 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

750 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

751 
__THROW
 
	`__nÚnuÎ
 ((1));

754 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

755 
__THROW
 
	`__nÚnuÎ
 ((1));

758 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

759 
__THROWNL
 
	`__nÚnuÎ
 ((1));

762 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

763 
__THROWNL
 
	`__nÚnuÎ
 ((1));

765 #ifdeà
__USE_XOPEN2K


767 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

768 cÚ¡ 
time¥ec
 *
__»¡riù


769 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

773 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

778 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

779 
__»¡riù
 
__mu‹x
,

780 *
__»¡riù
 
__´ioûšg
)

781 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

785 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

786 
__´ioûšg
,

787 *
__»¡riù
 
__Şd_ûšg
)

788 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

791 #ifdeà
__USE_XOPEN2K8


793 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

794 
__THROW
 
	`__nÚnuÎ
 ((1));

795 #ifdeà
__USE_GNU


796 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

797 
__THROW
 
	`__nÚnuÎ
 ((1));

806 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

807 
__THROW
 
	`__nÚnuÎ
 ((1));

810 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

811 
__THROW
 
	`__nÚnuÎ
 ((1));

814 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

815 
__»¡riù
 
__©Œ
,

816 *
__»¡riù
 
__psh¬ed
)

817 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

820 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

821 
__psh¬ed
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

824 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


826 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


827 
__©Œ
, *
__»¡riù
 
__kšd
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

833 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

834 
__THROW
 
	`__nÚnuÎ
 ((1));

838 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

839 
__»¡riù
 
__©Œ
,

840 *
__»¡riù
 
__´ÙocŞ
)

841 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

845 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

846 
__´ÙocŞ
)

847 
__THROW
 
	`__nÚnuÎ
 ((1));

850 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

851 
__»¡riù
 
__©Œ
,

852 *
__»¡riù
 
__´ioûšg
)

853 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ioûšg
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

860 #ifdeà
__USE_XOPEN2K


862 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

863 *
__robu¡Ãss
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

865 #ifdeà
__USE_GNU


866 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

867 *
__robu¡Ãss
)

868 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

872 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

873 
__robu¡Ãss
)

874 
__THROW
 
	`__nÚnuÎ
 ((1));

875 #ifdeà
__USE_GNU


876 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

877 
__robu¡Ãss
)

878 
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


888 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

889 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


890 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

893 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

894 
__THROW
 
	`__nÚnuÎ
 ((1));

897 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

898 
__THROWNL
 
	`__nÚnuÎ
 ((1));

901 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

902 
__THROWNL
 
	`__nÚnuÎ
 ((1));

904 #ifdeà
__USE_XOPEN2K


906 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

907 cÚ¡ 
time¥ec
 *
__»¡riù


908 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

912 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

916 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

917 
__THROWNL
 
	`__nÚnuÎ
 ((1));

919 #ifdeà
__USE_XOPEN2K


921 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

922 cÚ¡ 
time¥ec
 *
__»¡riù


923 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

927 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

934 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

935 
__THROW
 
	`__nÚnuÎ
 ((1));

938 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

939 
__THROW
 
	`__nÚnuÎ
 ((1));

942 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

943 
__»¡riù
 
__©Œ
,

944 *
__»¡riù
 
__psh¬ed
)

945 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

948 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

949 
__psh¬ed
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__´ef
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

968 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

969 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

970 
__THROW
 
	`__nÚnuÎ
 ((1));

973 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

974 
__THROW
 
	`__nÚnuÎ
 ((1));

977 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

978 
__THROWNL
 
	`__nÚnuÎ
 ((1));

981 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

982 
__THROWNL
 
	`__nÚnuÎ
 ((1));

989 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

990 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

991 
	`__nÚnuÎ
 ((1, 2));

1000 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1002 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1003 
	`__nÚnuÎ
 ((1, 2, 3));

1008 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1009 
__THROW
 
	`__nÚnuÎ
 ((1));

1012 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1013 
__THROW
 
	`__nÚnuÎ
 ((1));

1016 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1017 
__»¡riù
 
__©Œ
,

1018 *
__»¡riù
 
__psh¬ed
)

1019 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1022 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1023 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1025 #ifdeà
__USE_XOPEN2K


1027 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__şockid_t
 
__şock_id
)

1035 
__THROW
 
	`__nÚnuÎ
 ((1));

1039 #ifdeà
__USE_XOPEN2K


1044 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1045 
__THROW
 
	`__nÚnuÎ
 ((1));

1048 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1049 
__THROW
 
	`__nÚnuÎ
 ((1));

1052 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1053 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1056 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1057 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1060 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1061 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1068 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1069 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1070 
__©Œ
, 
__couÁ
)

1071 
__THROW
 
	`__nÚnuÎ
 ((1));

1074 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1075 
__THROW
 
	`__nÚnuÎ
 ((1));

1078 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1079 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1083 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1084 
__THROW
 
	`__nÚnuÎ
 ((1));

1087 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1088 
__THROW
 
	`__nÚnuÎ
 ((1));

1091 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1092 
__»¡riù
 
__©Œ
,

1093 *
__»¡riù
 
__psh¬ed
)

1094 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1097 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1098 
__psh¬ed
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1111 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1112 (*
__de¡r_funùiÚ
) (*))

1113 
__THROW
 
	`__nÚnuÎ
 ((1));

1116 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1119 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1122 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1123 cÚ¡ *
__poš‹r
è
__THROW
 ;

1126 #ifdeà
__USE_XOPEN2K


1128 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1129 
__şockid_t
 *
__şock_id
)

1130 
__THROW
 
	`__nÚnuÎ
 ((2));

1145 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1146 (*
__·»Á
) (),

1147 (*
__chd
è()è
__THROW
;

1150 #ifdeà
__USE_EXTERN_INLINES


1152 
__ex‹º_šlše
 

1153 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1155  
__th»ad1
 =ğ
__th»ad2
;

1156 
	}
}

1159 
	g__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 #ifdeà
__USE_XOPEN2K


31 
	#__Ãed_time_t


	)

32 
	#__Ãed_time¥ec


	)

34 
	~<time.h
>

36 #iâdeà
__pid_t_defšed


37 
__pid_t
 
	tpid_t
;

38 
	#__pid_t_defšed


	)

43 
	~<b™s/sched.h
>

45 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

48 
__BEGIN_DECLS


51 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

52 
__THROW
;

55 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

58 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

59 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

62 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

65 
	$sched_y›ld
 (è
__THROW
;

68 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

71 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

74 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

77 #ifdeà
__USE_GNU


79 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

80 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

81 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

82 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

83 
ıu£
)

	)

84 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

87 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

88 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

89 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

90 
ıu£
)

	)

91 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

92 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

94 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

96 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

97 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

99 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

101 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

103 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

105 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

107 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

109 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

110 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

112 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

113 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

114 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

118 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

119 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

122 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

123 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

126 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_MISC


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_MISC


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ifdeà
__USE_XOPEN2K8


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

166 #ifdeà
__USE_XOPEN


167 #ifdeà
__GNUC__


168 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

170 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

172 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

177 #ifdeà
__USE_MISC


184 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

187 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

190 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

193 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

197 #ifdeà
__USE_MISC


198 
	#NSIG
 
_NSIG


	)

201 #ifdeà
__USE_GNU


202 
__sighªdËr_t
 
	tsighªdËr_t
;

206 #ifdeà
__USE_MISC


207 
__sighªdËr_t
 
	tsig_t
;

210 #ifdeà
__USE_POSIX


213 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

216 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

219 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

222 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

226 
__THROW
 
	`__nÚnuÎ
 ((1));

228 #ifdeà
__USE_GNU


230 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

233 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

234 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

237 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

238 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

243 
	~<b™s/sigaùiÚ.h
>

246 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

247 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

254 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

257 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

258 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

261 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

268 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

269 
	`__nÚnuÎ
 ((1, 2));

271 #ifdeà
__USE_POSIX199309


276 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

277 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

284 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

285 
sigšfo_t
 *
__»¡riù
 
__šfo
,

286 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

287 
	`__nÚnuÎ
 ((1));

291 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

292 
__THROW
;

297 #ifdeà
__USE_MISC


301 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

302 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

306 
	~<b™s/sigcÚ‹xt.h
>

309 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

314 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


315 
	#__Ãed_size_t


	)

316 
	~<¡ddef.h
>

321 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

323 
	~<b™s/sig¡ack.h
>

324 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


326 
	~<sys/ucÚ‹xt.h
>

332 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

333 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

337 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

338 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

342 #ifdeà
__USE_XOPEN_EXTENDED


346 
	$sighŞd
 (
__sig
è
__THROW
;

349 
	$sig»l£
 (
__sig
è
__THROW
;

352 
	$sigignÜe
 (
__sig
è
__THROW
;

355 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

358 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


361 
	~<b™s/±h»adty³s.h
>

362 
	~<b™s/sigth»ad.h
>

369 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

371 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

375 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 #ifdeà
__WORDSIZE32_SIZE_ULONG


264 
	#SIZE_MAX
 (4294967295UL)

	)

266 
	#SIZE_MAX
 (4294967295U)

	)

271 #iâdeà
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

282 
	#INT8_C
(
c
è
	)
c

283 
	#INT16_C
(
c
è
	)
c

284 
	#INT32_C
(
c
è
	)
c

285 #ià
__WORDSIZE
 == 64

286 
	#INT64_C
(
c
èø## 
L


	)

288 
	#INT64_C
(
c
èø## 
LL


	)

292 
	#UINT8_C
(
c
è
	)
c

293 
	#UINT16_C
(
c
è
	)
c

294 
	#UINT32_C
(
c
èø## 
U


	)

295 #ià
__WORDSIZE
 == 64

296 
	#UINT64_C
(
c
èø## 
UL


	)

298 
	#UINT64_C
(
c
èø## 
ULL


	)

302 #ià
__WORDSIZE
 == 64

303 
	#INTMAX_C
(
c
èø## 
L


	)

304 
	#UINTMAX_C
(
c
èø## 
UL


	)

306 
	#INTMAX_C
(
c
èø## 
LL


	)

307 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_MISC


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ifdeà
__USE_POSIX


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ifdeà
__USE_POSIX


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ifdeà
__USE_POSIX2


872 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

878 
	`pşo£
 (
FILE
 *
__¡»am
);

882 #ifdef 
__USE_POSIX


884 *
	$ù”mid
 (*
__s
è
__THROW
;

888 #ifdeà
__USE_XOPEN


890 *
	`cu£rid
 (*
__s
);

894 #ifdef 
__USE_GNU


895 
ob¡ack
;

898 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

899 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

900 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

901 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

902 cÚ¡ *
__»¡riù
 
__fÜm©
,

903 
_G_va_li¡
 
__¬gs
)

904 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

908 #ifdeà
__USE_POSIX


912 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

916 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

919 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

922 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


926 
	#__Ãed_g‘İt


	)

927 
	~<g‘İt.h
>

932 #ifdeà
__USE_EXTERN_INLINES


933 
	~<b™s/¡dio.h
>

935 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


936 
	~<b™s/¡dio2.h
>

938 #ifdeà
__LDBL_COMPAT


939 
	~<b™s/¡dio-ldbl.h
>

942 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_MISC


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ifdeà
__USE_ISOC99


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_MISC


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ifdeà
__USE_ISOC99


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ifdeà
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ifdeà
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_MISC


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ifdeà
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


618 #iâdeà
__USE_FILE_OFFSET64


619 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

621 #ifdeà
__REDIRECT


622 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

623 
	`__nÚnuÎ
 ((1)è
__wur
;

625 
	#mk¡emp
 
mk¡emp64


	)

628 #ifdeà
__USE_LARGEFILE64


629 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_MISC


640 #iâdeà
__USE_FILE_OFFSET64


641 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

643 #ifdeà
__REDIRECT


644 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

645 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

647 
	#mk¡emps
 
mk¡emps64


	)

650 #ifdeà
__USE_LARGEFILE64


651 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

652 
	`__nÚnuÎ
 ((1)è
__wur
;

656 #ifdeà
__USE_XOPEN2K8


662 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

665 #ifdeà
__USE_GNU


672 #iâdeà
__USE_FILE_OFFSET64


673 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

675 #ifdeà
__REDIRECT


676 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

677 
	`__nÚnuÎ
 ((1)è
__wur
;

679 
	#mko¡emp
 
mko¡emp64


	)

682 #ifdeà
__USE_LARGEFILE64


683 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

692 #iâdeà
__USE_FILE_OFFSET64


693 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

694 
	`__nÚnuÎ
 ((1)è
__wur
;

696 #ifdeà
__REDIRECT


697 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

698 
__æags
), 
mko¡emps64
)

699 
	`__nÚnuÎ
 ((1)è
__wur
;

701 
	#mko¡emps
 
mko¡emps64


	)

704 #ifdeà
__USE_LARGEFILE64


705 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

706 
	`__nÚnuÎ
 ((1)è
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

724 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

727 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


733 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

734 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

739 #iâdeà
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com·r_â_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com·r_â_t
 
	tcom·risÚ_â_t
;

747 #ifdeà
__USE_GNU


748 (*
	t__com·r_d_â_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

755 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

756 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

758 #ifdeà
__USE_EXTERN_INLINES


759 
	~<b™s/¡dlib-b£¬ch.h
>

764 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

765 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

766 #ifdeà
__USE_GNU


767 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

768 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

769 
	`__nÚnuÎ
 ((1, 4));

774 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

775 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
__END_NAMESPACE_STD


778 #ifdeà
__USE_ISOC99


779 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

780 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

784 
__BEGIN_NAMESPACE_STD


788 
div_t
 
	$div
 (
__num”
, 
__d’om
)

789 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

790 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

791 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

792 
__END_NAMESPACE_STD


794 #ifdeà
__USE_ISOC99


795 
__BEGIN_NAMESPACE_C99


796 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

797 
__d’om
)

798 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

799 
__END_NAMESPACE_C99


803 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

804 || 
defšed
 
__USE_MISC


811 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

812 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

817 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

818 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

823 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

824 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

827 #ifdeà
__USE_MISC


829 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

830 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

831 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

832 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

833 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

834 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

835 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

836 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

841 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

842 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

843 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

844 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

845 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

846 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

848 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

849 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

850 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

851 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

852 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

853 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

854 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

855 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

859 
__BEGIN_NAMESPACE_STD


862 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

865 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

866 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

869 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

873 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

874 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

876 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

877 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

878 
__THROW
;

879 
__END_NAMESPACE_STD


882 #ifdeà
__USE_MISC


887 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


898 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

899 *cÚ¡ *
__»¡riù
 
__tok’s
,

900 **
__»¡riù
 
__v®u•
)

901 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

905 #ifdeà
__USE_XOPEN


907 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

913 #ifdeà
__USE_XOPEN2KXSI


915 
	$posix_İ’±
 (
__oæag
è
__wur
;

918 #ifdeà
__USE_XOPEN


923 
	$g¿Á±
 (
__fd
è
__THROW
;

927 
	$uÆock±
 (
__fd
è
__THROW
;

932 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

935 #ifdeà
__USE_GNU


939 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

940 
__THROW
 
	`__nÚnuÎ
 ((2));

943 
	`g‘±
 ();

946 #ifdeà
__USE_MISC


950 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

951 
__THROW
 
	`__nÚnuÎ
 ((1));

954 
	~<b™s/¡dlib-æßt.h
>

957 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


958 
	~<b™s/¡dlib.h
>

960 #ifdeà
__LDBL_COMPAT


961 
	~<b™s/¡dlib-ldbl.h
>

965 #undeà
__Ãed_m®loc_ªd_ÿÎoc


967 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

35 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


54 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

65 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

69 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

74 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 #ifdeà
__OPTIMIZE__


78 
__ex‹º_®ways_šlše
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


81  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

84 
__ex‹º_®ways_šlše
 const *

85 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


87  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifdeà
__USE_GNU


100 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

106 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

117 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

128 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

129 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

133 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

137 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

141 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

150 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

151 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
 
	`__nÚnuÎ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifdeà
__USE_XOPEN2K8


159 
	~<xloÿË.h
>

162 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

163 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

165 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

166 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

169 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


171 *
	$¡rdup
 (cÚ¡ *
__s
)

172 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_XOPEN2K8


179 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

180 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


185 
	#¡rdu·
(
s
) \

186 (
__ex‹nsiÚ__
 \

188 cÚ¡ *
__Şd
 = (
s
); \

189 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

190 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

191 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

192 
	}
}))

	)

195 
	#¡ºdu·
(
s
, 
n
) \

196 (
__ex‹nsiÚ__
 \

198 cÚ¡ *
__Şd
 = (
s
); \

199 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

200 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

201 
__Ãw
[
__Ën
] = '\0'; \

202 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

203 }))

	)

206 
	g__BEGIN_NAMESPACE_STD


208 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


211 *
¡rchr
 (*
__s
, 
__c
)

212 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

213 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

214 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

216 #ifdeà
__OPTIMIZE__


217 
__ex‹º_®ways_šlše
 *

218 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

223 
__ex‹º_®ways_šlše
 const *

224 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


226  
__butš_¡rchr
 (
__s
, 
__c
);

231 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

232 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

235 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


238 *
	`¡¼chr
 (*
__s
, 
__c
)

239 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

243 #ifdeà
__OPTIMIZE__


244 
__ex‹º_®ways_šlše
 *

245 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
__ex‹º_®ways_šlše
 const *

251 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


253  
	`__butš_¡¼chr
 (
__s
, 
__c
);

256 
	}
}

258 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

259 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

261 
__END_NAMESPACE_STD


263 #ifdeà
__USE_GNU


266 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


267 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

268 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

269 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 
__BEGIN_NAMESPACE_STD


280 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

281 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


290 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

291 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

293 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

295 #ifdeà
__OPTIMIZE__


296 
__ex‹º_®ways_šlše
 *

297 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


299  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

302 
__ex‹º_®ways_šlše
 const *

303 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


305  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

308 
	}
}

310 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

311 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


317 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

318 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

320 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

322 #ifdeà
__OPTIMIZE__


323 
__ex‹º_®ways_šlše
 *

324 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


326  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

329 
__ex‹º_®ways_šlše
 const *

330 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


332  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

335 
	}
}

337 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

338 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

343 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

344 
__THROW
 
	`__nÚnuÎ
 ((2));

345 
__END_NAMESPACE_STD


349 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

350 cÚ¡ *
__»¡riù
 
__d–im
,

351 **
__»¡riù
 
__§ve_±r
)

352 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

353 #ifdeà
__USE_POSIX


354 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

355 **
__»¡riù
 
__§ve_±r
)

356 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

359 #ifdeà
__USE_GNU


361 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


362 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

363 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

365 cÚ¡ *
__ÃedË
)

366 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

368 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

369 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 #ifdeà
__USE_GNU


377 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

378 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

379 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

383 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

384 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

385 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

387 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

388 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

392 
__BEGIN_NAMESPACE_STD


394 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

395 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 
__END_NAMESPACE_STD


398 #ifdef 
__USE_XOPEN2K8


401 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

402 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

406 
__BEGIN_NAMESPACE_STD


408 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

409 
__END_NAMESPACE_STD


410 #ifdeà
__USE_XOPEN2K


418 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


421 #ifdeà
__REDIRECT_NTH


422 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

423 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

424 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

426 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

427 
__THROW
 
	`__nÚnuÎ
 ((2));

428 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

433 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

434 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

438 #ifdeà
__USE_XOPEN2K8


440 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

446 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

448 #ifdeà
__USE_MISC


450 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

451 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

457 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

458 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

461 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


464 *
	`šdex
 (*
__s
, 
__c
)

465 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

466 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

467 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

469 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


470 
__ex‹º_®ways_šlše
 *

471 
	`šdex
 (*
__s
, 
__c
è
__THROW


473  
	`__butš_šdex
 (
__s
, 
__c
);

476 
__ex‹º_®ways_šlše
 const *

477 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


479  
	`__butš_šdex
 (
__s
, 
__c
);

482 
	}
}

484 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

485 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

489 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


492 *
	`ršdex
 (*
__s
, 
__c
)

493 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

495 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

497 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


498 
__ex‹º_®ways_šlše
 *

499 
	`ršdex
 (*
__s
, 
__c
è
__THROW


501  
	`__butš_ršdex
 (
__s
, 
__c
);

504 
__ex‹º_®ways_šlše
 const *

505 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


507  
	`__butš_ršdex
 (
__s
, 
__c
);

510 
	}
}

512 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

513 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

518 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

522 #ifdef 
__USE_GNU


523 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

524 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

525 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

530 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

533 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

534 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

537 #ifdef 
__USE_GNU


540 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

541 
__loÿË_t
 
__loc
)

542 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

544 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

545 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

546 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

549 #ifdef 
__USE_MISC


552 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

553 cÚ¡ *
__»¡riù
 
__d–im
)

554 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdef 
__USE_XOPEN2K8


559 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

562 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

563 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

564 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

565 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

570 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

571 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

572 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

573 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 #ifdef 
__USE_GNU


579 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

580 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

583 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

586 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

588 #iâdeà
ba£Çme


593 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


594 "C++" *
	$ba£Çme
 (*
__f’ame
)

595 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

596 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

597 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

599 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

605 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

606 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

607 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


627 
	~<b™s/¡ršg.h
>

630 
	~<b™s/¡ršg2.h
>

633 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


635 
	~<b™s/¡ršg3.h
>

639 #ià
defšed
 
__USE_GNU
 && defšed 
__OPTIMIZE__
 \

640 && 
defšed
 
__ex‹º_®ways_šlše
 && 
	$__GNUC_PREREQ
 (3,2)

641 #ià!
defšed
 
_FORCE_INLINES
 && !defšed 
_HAVE_STRING_ARCH_mempıy


643 #undeà
mempıy


644 #undeà
__mempıy


645 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy_šlše
 (de¡, src,‚)

	)

646 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy_šlše
 (de¡, src,‚)

	)

648 
__ex‹º_®ways_šlše
 *

649 
	$__mempıy_šlše
 (*
__»¡riù
 
__de¡
,

650 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

652  (*è
	`memıy
 (
__de¡
, 
__¤c
, 
__n
) + __n;

653 
	}
}

658 
	g__END_DECLS


	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

24 #ià!
defšed
 
_STRING_H
 || !defšed 
__USE_MISC


26 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

31 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

32 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

35 
	g__BEGIN_DECLS


37 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


39 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

40 
__THROW
 
__©Œibu‹_pu»__
;

43 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
è
__THROW
;

46 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
;

49 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


52 *
	`šdex
 (*
__s
, 
__c
)

53 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

54 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

55 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

57 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


58 
__ex‹º_®ways_šlše
 *

59 
	`šdex
 (*
__s
, 
__c
è
__THROW


61  
	`__butš_šdex
 (
__s
, 
__c
);

64 
__ex‹º_®ways_šlše
 const *

65 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


67  
	`__butš_šdex
 (
__s
, 
__c
);

70 
	}
}

72 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

73 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


80 *
	`ršdex
 (*
__s
, 
__c
)

81 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

82 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

83 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

85 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


86 
__ex‹º_®ways_šlše
 *

87 
	`ršdex
 (*
__s
, 
__c
è
__THROW


89  
	`__butš_ršdex
 (
__s
, 
__c
);

92 
__ex‹º_®ways_šlše
 const *

93 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


95  
	`__butš_ršdex
 (
__s
, 
__c
);

98 
	}
}

100 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

101 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

105 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


108 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((const));

112 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

113 
__THROW
 
__©Œibu‹_pu»__
;

116 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

117 
__THROW
 
__©Œibu‹_pu»__
;

119 #ifdef 
__USE_XOPEN2K8


123 
	~<xloÿË.h
>

127 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__loc
)

128 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

130 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

131 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

132 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

135 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ifdeà
__USE_POSIX


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_MISC


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ifdeà
__USE_POSIX


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ifdeà
__USE_POSIX


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_MISC


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<b™s/posix_İt.h
>

208 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


209 
	~<b™s/’vœÚm’ts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<b™s/ty³s.h
>

222 #iâdef 
__ssize_t_defšed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defšed


	)

227 
	#__Ãed_size_t


	)

228 
	#__Ãed_NULL


	)

229 
	~<¡ddef.h
>

231 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


234 #iâdeà
__gid_t_defšed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defšed


	)

239 #iâdeà
__uid_t_defšed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defšed


	)

244 #iâdeà
__off_t_defšed


245 #iâdeà
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defšed


	)

252 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defšed


	)

257 #iâdeà
__u£cÚds_t_defšed


258 
__u£cÚds_t
 
	tu£cÚds_t
;

259 
	#__u£cÚds_t_defšed


	)

262 #iâdeà
__pid_t_defšed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defšed


	)

268 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


269 #iâdeà
__šŒ_t_defšed


270 
__šŒ_t
 
	tšŒ_t
;

271 
	#__šŒ_t_defšed


	)

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


276 #iâdeà
__sockËn_t_defšed


277 
__sockËn_t
 
	tsockËn_t
;

278 
	#__sockËn_t_defšed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ifdeà
__USE_GNU


295 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

296 
__THROW
 
	`__nÚnuÎ
 ((1));

299 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

300 
__THROW
 
	`__nÚnuÎ
 ((1));

303 #ifdeà
__USE_ATFILE


307 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

308 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

313 #iâdef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifdeà
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #iâdeà
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

339 #ifdeà
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifdeà
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

349 
__THROW
;

356 
	`şo£
 (
__fd
);

363 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

369 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

371 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


372 #iâdeà
__USE_FILE_OFFSET64


379 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

380 
__off_t
 
__off£t
è
__wur
;

387 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
è
__wur
;

390 #ifdeà
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

392 
__off64_t
 
__off£t
),

393 
´—d64
è
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

395 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

396 
pwr™e64
è
__wur
;

398 
	#´—d
 
´—d64


	)

399 
	#pwr™e
 
pwr™e64


	)

403 #ifdeà
__USE_LARGEFILE64


407 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

408 
__off64_t
 
__off£t
è
__wur
;

411 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
è
__wur
;

420 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

422 #ifdeà
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

435 
	$®¬m
 (
__£cÚds
è
__THROW
;

447 
	`¦“p
 (
__£cÚds
);

449 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

450 || 
defšed
 
__USE_MISC


455 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

456 
__THROW
;

463 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

472 
	`·u£
 ();

476 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

479 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

486 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

491 #ifdeà
__USE_ATFILE


494 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

495 
__gid_t
 
__group
, 
__æag
)

496 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

500 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

502 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


504 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

514 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

523 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

524 || 
defšed
 
__USE_MISC


528 *
	$g‘wd
 (*
__buf
)

529 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

534 
	$dup
 (
__fd
è
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

539 #ifdeà
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

546 **
__’vœÚ
;

547 #ifdeà
__USE_GNU


548 **
’vœÚ
;

554 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

555 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdeà
__USE_XOPEN2K8


560 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

561 
__THROW
 
	`__nÚnuÎ
 ((2));

566 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

567 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

577 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

581 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

582 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

588 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

590 #ifdeà
__USE_GNU


593 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

594 *cÚ¡ 
__’vp
[])

595 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


601 
	$niû
 (
__šc
è
__THROW
 
__wur
;

606 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

612 
	~<b™s/cÚâame.h
>

615 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

616 
__THROW
 
	`__nÚnuÎ
 ((1));

619 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

622 
	$syscÚf
 (
__Çme
è
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

631 
__pid_t
 
	$g‘pid
 (è
__THROW
;

634 
__pid_t
 
	$g‘µid
 (è
__THROW
;

637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

640 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

641 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


642 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

649 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

651 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


663 
	$£g½
 (è
__THROW
;

670 
__pid_t
 
	$£tsid
 (è
__THROW
;

672 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


674 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

678 
__uid_t
 
	$g‘uid
 (è
__THROW
;

681 
__uid_t
 
	$g‘euid
 (è
__THROW
;

684 
__gid_t
 
	$g‘gid
 (è
__THROW
;

687 
__gid_t
 
	$g‘egid
 (è
__THROW
;

692 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

705 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


708 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

711 #ifdeà
__USE_XOPEN2K


713 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

722 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


725 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

728 #ifdeà
__USE_XOPEN2K


730 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

733 #ifdeà
__USE_GNU


736 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

737 
__THROW
;

741 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

742 
__THROW
;

746 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

747 
__THROW
 
__wur
;

751 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

761 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

762 || 
defšed
 
__USE_MISC


767 
__pid_t
 
	$vfÜk
 (è
__THROW
;

773 *
	$‰yÇme
 (
__fd
è
__THROW
;

777 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

778 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

782 
	$i§‰y
 (
__fd
è
__THROW
;

784 #ià
defšed
 
__USE_MISC
 \

785 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

788 
	$‰y¦Ù
 (è
__THROW
;

793 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

794 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

796 #ifdeà
__USE_ATFILE


799 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

800 cÚ¡ *
__to
, 
__æags
)

801 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

804 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


806 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

807 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

812 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

813 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

814 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

817 #ifdeà
__USE_ATFILE


819 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

820 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

823 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

824 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

825 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

829 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

831 #ifdeà
__USE_ATFILE


833 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

834 
__THROW
 
	`__nÚnuÎ
 ((2));

838 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

842 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

845 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

852 *
	`g‘logš
 ();

853 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


860 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

863 #ifdef 
__USE_MISC


865 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

869 #ifdef 
__USE_POSIX2


873 
	#__Ãed_g‘İt


	)

874 
	~<g‘İt.h
>

878 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


882 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ià
defšed
 
__USE_MISC


889 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

890 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

894 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

900 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

901 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

902 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

903 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

909 
	$vhªgup
 (è
__THROW
;

912 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

920 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

921 
size_t
 
__off£t
, 
__sÿË
)

922 
__THROW
 
	`__nÚnuÎ
 ((1));

928 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

932 *
	$g‘u£rsh–l
 (è
__THROW
;

933 
	$’du£rsh–l
 (è
__THROW
;

934 
	$£tu£rsh–l
 (è
__THROW
;

940 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

944 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

947 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

951 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

959 
	`fsync
 (
__fd
);

962 #ifdeà
__USE_GNU


965 
	$syncfs
 (
__fd
è
__THROW
;

969 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


972 
	`g‘ho¡id
 ();

975 
	$sync
 (è
__THROW
;

978 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


981 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

986 
	$g‘dbËsize
 (è
__THROW
;

992 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


995 #iâdeà
__USE_FILE_OFFSET64


996 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

997 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

999 #ifdeà
__REDIRECT_NTH


1000 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

1001 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

1002 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1004 
	#Œunÿ‹
 
Œunÿ‹64


	)

1007 #ifdeà
__USE_LARGEFILE64


1008 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1009 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1014 #ià
defšed
 
__USE_POSIX199309
 \

1015 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1018 #iâdeà
__USE_FILE_OFFSET64


1019 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1021 #ifdeà
__REDIRECT_NTH


1022 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1023 
árunÿ‹64
è
__wur
;

1025 
	#árunÿ‹
 
árunÿ‹64


	)

1028 #ifdeà
__USE_LARGEFILE64


1029 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1035 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1036 || 
defšed
 
__USE_MISC


1040 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1046 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1050 #ifdeà
__USE_MISC


1061 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1066 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1078 
	#F_ULOCK
 0

	)

1079 
	#F_LOCK
 1

	)

1080 
	#F_TLOCK
 2

	)

1081 
	#F_TEST
 3

	)

1083 #iâdeà
__USE_FILE_OFFSET64


1084 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1086 #ifdeà
__REDIRECT


1087 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1088 
lockf64
è
__wur
;

1090 
	#lockf
 
lockf64


	)

1093 #ifdeà
__USE_LARGEFILE64


1094 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1099 #ifdeà
__USE_GNU


1104 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1105 (
__ex‹nsiÚ__
 \

1106 ({ 
__»suÉ
; \

1107 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1108 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1109 
__»suÉ
; 
	}
}))

	)

1112 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1115 
fd©async
 (
__fdes
);

1121 #ifdef 
__USE_XOPEN


1123 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1124 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1128 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1129 
__THROW
 
	`__nÚnuÎ
 ((1));

1136 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1137 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1143 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1145 *
	$ù”mid
 (*
__s
è
__THROW
;

1150 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1151 
	~<b™s/uni¡d.h
>

1154 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ifdeà
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ifdeà
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


152 #undeà
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifdeà
_GNU_SOURCE


158 #undeà
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #undeà
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #undeà
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #undeà
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #undeà
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #undeà
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #undeà
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #undeà
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #undeà
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #undeà
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #ià(
defšed
 
_DEFAULT_SOURCE
 \

183 || (!
defšed
 
	g__STRICT_ANSI__
 \

184 && !
defšed
 
	g_ISOC99_SOURCE
 \

185 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

186 && !
defšed
 
	g_XOPEN_SOURCE
))

187 #undeà
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC11_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

205 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

214 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifdeà
_DEFAULT_SOURCE


222 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #undeà
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #undeà
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #ià((!
defšed
 
__STRICT_ANSI__
 \

231 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #ià(
defšed
 
_POSIX_SOURCE
 \

247 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defšed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #undeà
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #undeà
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #undeà
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #ià(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #undeà
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #ià(
_XOPEN_SOURCE
 - 0) >= 600

286 #ià(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #undeà
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #undeà
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifdeà
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifdeà
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifdeà
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #ià
defšed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<¡dc-´edef.h
>

353 #undeà
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

362 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

365 #iâdeà
__ASSEMBLER__


366 #iâdeà
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

381 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

382 && 
defšed
 
	g__ex‹º_šlše


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/¡ubs.h
>

	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


150 
	t_IO_lock_t
;

156 
	s_IO_m¬k”
 {

157 
_IO_m¬k”
 *
	m_Ãxt
;

158 
_IO_FILE
 *
	m_sbuf
;

162 
	m_pos
;

164 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

165 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

166 
	mpublic
:

167 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

168 ~
¡»amm¬k”
();

169 
§všg
(è{  
	m_¥os
 == -2; }

170 
d–
(
¡»amm¬k”
&);

171 
d–
();

176 
	e__codecvt_»suÉ


178 
	m__codecvt_ok
,

179 
	m__codecvt_·¹Ÿl
,

180 
	m__codecvt_”rÜ
,

181 
	m__codecvt_nocÚv


184 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


187 
	s_IO_codecvt


189 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

190 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

191 
	m__mb¡©e_t
 *,

192 cÚ¡ 
	mwch¬_t
 *,

193 cÚ¡ 
	mwch¬_t
 *,

194 cÚ¡ 
	mwch¬_t
 **, *,

196 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

197 
	m__mb¡©e_t
 *, *,

199 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

200 
	m__mb¡©e_t
 *,

202 cÚ¡ **, 
	mwch¬_t
 *,

203 
	mwch¬_t
 *, wchar_t **);

204 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

205 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

206 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

207 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

208 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

210 
_IO_icÚv_t
 
	m__cd_š
;

211 
_IO_icÚv_t
 
	m__cd_out
;

215 
	s_IO_wide_d©a


217 
wch¬_t
 *
	m_IO_»ad_±r
;

218 
wch¬_t
 *
	m_IO_»ad_’d
;

219 
wch¬_t
 *
	m_IO_»ad_ba£
;

220 
wch¬_t
 *
	m_IO_wr™e_ba£
;

221 
wch¬_t
 *
	m_IO_wr™e_±r
;

222 
wch¬_t
 *
	m_IO_wr™e_’d
;

223 
wch¬_t
 *
	m_IO_buf_ba£
;

224 
wch¬_t
 *
	m_IO_buf_’d
;

226 
wch¬_t
 *
	m_IO_§ve_ba£
;

227 
wch¬_t
 *
	m_IO_backup_ba£
;

229 
wch¬_t
 *
	m_IO_§ve_’d
;

231 
__mb¡©e_t
 
	m_IO_¡©e
;

232 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

233 
_IO_codecvt
 
	m_codecvt
;

235 
wch¬_t
 
	m_shÜtbuf
[1];

237 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

241 
	s_IO_FILE
 {

242 
	m_æags
;

243 
	#_IO_fe_æags
 
_æags


	)

247 * 
	m_IO_»ad_±r
;

248 * 
	m_IO_»ad_’d
;

249 * 
	m_IO_»ad_ba£
;

250 * 
	m_IO_wr™e_ba£
;

251 * 
	m_IO_wr™e_±r
;

252 * 
	m_IO_wr™e_’d
;

253 * 
	m_IO_buf_ba£
;

254 * 
	m_IO_buf_’d
;

256 *
	m_IO_§ve_ba£
;

257 *
	m_IO_backup_ba£
;

258 *
	m_IO_§ve_’d
;

260 
_IO_m¬k”
 *
	m_m¬k”s
;

262 
_IO_FILE
 *
	m_chaš
;

264 
	m_f’o
;

266 
	m_blksize
;

268 
	m_æags2
;

270 
_IO_off_t
 
	m_Şd_off£t
;

272 
	#__HAVE_COLUMN


	)

274 
	m_cur_cŞumn
;

275 sigÃd 
	m_vbË_off£t
;

276 
	m_shÜtbuf
[1];

280 
_IO_lock_t
 *
	m_lock
;

281 #ifdeà
_IO_USE_OLD_IO_FILE


284 
	s_IO_FILE_com¶‘e


286 
_IO_FILE
 
	m_fe
;

288 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

289 
_IO_off64_t
 
	m_off£t
;

290 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


292 
_IO_codecvt
 *
	m_codecvt
;

293 
_IO_wide_d©a
 *
	m_wide_d©a
;

294 
_IO_FILE
 *
	m_ä“»s_li¡
;

295 *
	m_ä“»s_buf
;

297 *
	m__·d1
;

298 *
	m__·d2
;

299 *
	m__·d3
;

300 *
	m__·d4
;

302 
size_t
 
	m__·d5
;

303 
	m_mode
;

305 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

309 #iâdeà
__ılu¥lus


310 
_IO_FILE
 
	t_IO_FILE
;

313 
	g_IO_FILE_¶us
;

315 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

316 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

317 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

318 #iâdeà
_LIBC


319 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

320 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

321 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

323 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

324 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

325 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

333 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

341 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

342 
	tsize_t
 
	t__n
);

350 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

353 
	t__io_şo£_â
 (*
	t__cook›
);

356 #ifdeà
_GNU_SOURCE


358 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

359 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

360 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

361 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

366 
__io_»ad_â
 *
	m»ad
;

367 
__io_wr™e_â
 *
	mwr™e
;

368 
__io_£ek_â
 *
	m£ek
;

369 
__io_şo£_â
 *
	mşo£
;

370 } 
	t_IO_cook›_io_funùiÚs_t
;

371 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

373 
	g_IO_cook›_fe
;

376 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

377 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

381 #ifdeà
__ılu¥lus


385 
__und”æow
 (
_IO_FILE
 *);

386 
__uæow
 (
_IO_FILE
 *);

387 
__ov”æow
 (
_IO_FILE
 *, );

388 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


389 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

390 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

391 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

394 #ià 
__GNUC__
 >= 3

395 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

397 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

400 
	#_IO_g‘c_uÆocked
(
_å
) \

401 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

402 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

403 
	#_IO_³ekc_uÆocked
(
_å
) \

404 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

405 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

406 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

407 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

408 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

409 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

410 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

412 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


413 
	#_IO_g‘wc_uÆocked
(
_å
) \

414 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

415 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

416 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

417 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

418 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

422 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

423 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

426 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

427 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

429 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

430 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

431 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

432 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

434 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

437 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

438 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

440 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

441 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

442 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

444 #ifdeà
_IO_MTSAFE_IO


445 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

446 
	#_IO_æockfe
(
_å
) \

447 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

448 
	#_IO_fuÆockfe
(
_å
) \

449 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

451 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

452 
	#_IO_æockfe
(
_å
è

	)

453 
	#_IO_fuÆockfe
(
_å
è

	)

454 
	#_IO_árylockfe
(
_å
è

	)

455 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

456 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

459 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

460 
_IO_va_li¡
, *
__»¡riù
);

461 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

462 
_IO_va_li¡
);

463 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

464 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

466 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

467 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

469 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

471 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


472 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

473 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

474 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

475 #ià
__GNUC__
 >= 2

478 #ià
defšed
 
_LIBC
 && defšed 
SHARED


479 
	~<shlib-com·t.h
>

480 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

481 
	#_IO_fwide_maybe_šcom·tibË
 \

482 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

483 cÚ¡ 
_IO_¡dš_u£d
;

484 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

487 #iâdeà
_IO_fwide_maybe_šcom·tibË


488 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

492 
	#_IO_fwide
(
__å
, 
__mode
) \

493 ({ 
__»suÉ
 = (
__mode
); \

494 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

496 ià((
__å
)->
_mode
 == 0) \

498 (
__å
)->
_mode
 = -1; \

499 
__»suÉ
 = (
__å
)->
_mode
; \

501 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

502 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

504 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

505 
__»suÉ
; })

	)

508 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

509 
_IO_va_li¡
, *
__»¡riù
);

510 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

511 
_IO_va_li¡
);

512 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

513 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

516 #ifdeà
__LDBL_COMPAT


517 
	~<b™s/libio-ldbl.h
>

520 #ifdeà
__ılu¥lus


	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004,

60 
	m__GCONV_TRANSLIT
 = 0x0008

65 
	g__gcÚv_¡•
;

66 
	g__gcÚv_¡•_d©a
;

67 
	g__gcÚv_lßded_objeù
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 
	s__gcÚv_¡•


86 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

87 cÚ¡ *
__modÇme
;

89 
__couÁ”
;

91 *
__äom_Çme
;

92 *
__to_Çme
;

94 
__gcÚv_fù
 
__fù
;

95 
__gcÚv_btowc_fù
 
__btowc_fù
;

96 
__gcÚv_š™_fù
 
__š™_fù
;

97 
__gcÚv_’d_fù
 
__’d_fù
;

101 
__mš_Ãeded_äom
;

102 
__max_Ãeded_äom
;

103 
__mš_Ãeded_to
;

104 
__max_Ãeded_to
;

107 
__¡©eful
;

109 *
__d©a
;

114 
	s__gcÚv_¡•_d©a


116 *
__outbuf
;

117 *
__outbuãnd
;

121 
__æags
;

125 
__švoÿtiÚ_couÁ”
;

129 
__š‹º®_u£
;

131 
__mb¡©e_t
 *
__¡©•
;

132 
__mb¡©e_t
 
__¡©e
;

138 
	s__gcÚv_šfo


140 
size_t
 
__n¡•s
;

141 
__gcÚv_¡•
 *
__¡•s
;

142 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

143 } *
	t__gcÚv_t
;

146 
	`__gcÚv_Œª¦™”©e
 (
__gcÚv_¡•
 *
¡•
,

147 
__gcÚv_¡•_d©a
 *
¡•_d©a
,

148 cÚ¡ *
šbuf¡¬t
,

149 cÚ¡ **
šbuå
,

150 cÚ¡ *
šbuãnd
,

151 **
outbuf¡¬t
,

152 
size_t
 *
œ»v”sibË
);

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

149 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

152 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

153 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

154 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

157 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

158 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

159 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

161 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

162 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

163 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

166 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

169 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

170 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

171 
__END_NAMESPACE_STD


173 #ifdeà
__USE_XOPEN2K8


175 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

178 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

179 
size_t
 
__n
è
__THROW
;

183 
	~<xloÿË.h
>

185 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
__loÿË_t
 
__loc
è
__THROW
;

188 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

189 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

192 
__BEGIN_NAMESPACE_STD


195 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

199 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

200 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

201 
__END_NAMESPACE_STD


203 #ifdeà
__USE_XOPEN2K8


209 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

210 
__loÿË_t
 
__loc
è
__THROW
;

215 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

216 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

219 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

222 
__BEGIN_NAMESPACE_STD


224 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


225 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

226 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

230 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

231 
__THROW
 
__©Œibu‹_pu»__
;

234 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


235 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

236 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

240 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

241 
__THROW
 
__©Œibu‹_pu»__
;

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_GNU


248 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

249 
__THROW
 
__©Œibu‹_pu»__
;

252 
__BEGIN_NAMESPACE_STD


255 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

256 
__THROW
 
__©Œibu‹_pu»__
;

259 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

260 
__THROW
 
__©Œibu‹_pu»__
;

262 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


263 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

265 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

266 cÚ¡ 
wch¬_t
 *
__acû±
)

267 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

269 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

270 
__THROW
 
__©Œibu‹_pu»__
;

273 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


274 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

276 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

277 cÚ¡ 
wch¬_t
 *
__ÃedË
)

278 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

280 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

281 
__THROW
 
__©Œibu‹_pu»__
;

285 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

286 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

287 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

290 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

291 
__END_NAMESPACE_STD


293 #ifdeà
__USE_XOPEN


295 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


296 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

298 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

299 cÚ¡ 
wch¬_t
 *
__ÃedË
)

300 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

302 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

303 
__THROW
 
__©Œibu‹_pu»__
;

307 #ifdeà
__USE_XOPEN2K8


309 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

310 
__THROW
 
__©Œibu‹_pu»__
;

314 
__BEGIN_NAMESPACE_STD


316 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


317 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

319 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

320 
size_t
 
__n
)

321 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

323 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

324 
__THROW
 
__©Œibu‹_pu»__
;

328 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

329 
__THROW
 
__©Œibu‹_pu»__
;

332 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

333 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

337 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

338 
__THROW
;

341 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

342 
__END_NAMESPACE_STD


344 #ifdeà
__USE_GNU


347 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

348 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

349 
__THROW
;

353 
__BEGIN_NAMESPACE_STD


356 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

360 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

364 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

368 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

369 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

370 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

373 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

374 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

377 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

378 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

379 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

380 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

381 
__END_NAMESPACE_STD


383 #ifdeà
__USE_EXTERN_INLINES


389 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

390 
__ex‹º_šlše
 
wšt_t


391 
	`__NTH
 (
	$btowc
 (
__c
))

392 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

393 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

395 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

396 
__ex‹º_šlše
 

397 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

398 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

399 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

401 
__ex‹º_šlše
 
size_t


402 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

403 
mb¡©e_t
 *
__»¡riù
 
__ps
))

404 {  (
__ps
 !ğ
NULL


405 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

408 
__BEGIN_NAMESPACE_STD


411 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

412 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

413 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

418 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

419 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

420 
__END_NAMESPACE_STD


423 #ifdef 
__USE_XOPEN2K8


426 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

427 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

428 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

432 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

433 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

434 
size_t
 
__nwc
, size_ˆ
__Ën
,

435 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

440 #ifdeà
__USE_XOPEN


442 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

446 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

450 
__BEGIN_NAMESPACE_STD


453 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

454 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

455 
__END_NAMESPACE_STD


457 #ifdeà
__USE_ISOC99


458 
__BEGIN_NAMESPACE_C99


460 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

461 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

462 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

463 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

464 
__END_NAMESPACE_C99


468 
__BEGIN_NAMESPACE_STD


471 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

472 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

476 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

477 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

478 
__THROW
;

479 
__END_NAMESPACE_STD


481 #ifdeà
__USE_ISOC99


482 
__BEGIN_NAMESPACE_C99


485 
__ex‹nsiÚ__


486 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

487 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

488 
__THROW
;

492 
__ex‹nsiÚ__


493 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

494 
wch¬_t
 **
__»¡riù
 
__’d±r
,

495 
__ba£
è
__THROW
;

496 
__END_NAMESPACE_C99


499 #ifdeà
__USE_GNU


502 
__ex‹nsiÚ__


503 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

504 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

505 
__THROW
;

509 
__ex‹nsiÚ__


510 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

511 
wch¬_t
 **
__»¡riù
 
__’d±r
,

512 
__ba£
è
__THROW
;

515 #ifdeà
__USE_GNU


529 
	~<xloÿË.h
>

533 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

534 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

535 
__loÿË_t
 
__loc
è
__THROW
;

537 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

538 
wch¬_t
 **
__»¡riù
 
__’d±r
,

539 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

541 
__ex‹nsiÚ__


542 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

543 
wch¬_t
 **
__»¡riù
 
__’d±r
,

544 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

546 
__ex‹nsiÚ__


547 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

548 
wch¬_t
 **
__»¡riù
 
__’d±r
,

549 
__ba£
, 
__loÿË_t
 
__loc
)

550 
__THROW
;

552 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

553 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

554 
__THROW
;

556 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

557 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

558 
__THROW
;

560 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

561 
wch¬_t
 **
__»¡riù
 
__’d±r
,

562 
__loÿË_t
 
__loc
è
__THROW
;

566 #ifdeà
__USE_XOPEN2K8


569 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

570 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

574 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

575 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
;

583 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

586 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


587 
__BEGIN_NAMESPACE_STD


590 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

597 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

598 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

607 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

608 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

609 
__THROW
 ;

615 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

616 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

617 
__gnuc_va_li¡
 
__¬g
)

623 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

624 
__gnuc_va_li¡
 
__¬g
)

628 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

629 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

630 
__gnuc_va_li¡
 
__¬g
)

631 
__THROW
 ;

638 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

639 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

648 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

649 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

650 
__THROW
 ;

652 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

653 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

654 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

655 #ifdeà
__REDIRECT


659 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

660 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_fwsÿnf
)

663 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

664 
__isoc99_wsÿnf
)

666 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

667 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

668 ...), 
__isoc99_swsÿnf
)

671 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

673 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

674 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

675 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

676 
__THROW
;

677 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

678 
	#wsÿnf
 
__isoc99_wsÿnf


	)

679 
	#swsÿnf
 
__isoc99_swsÿnf


	)

683 
__END_NAMESPACE_STD


686 #ifdeà
__USE_ISOC99


687 
__BEGIN_NAMESPACE_C99


692 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

693 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

694 
__gnuc_va_li¡
 
__¬g
)

700 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

701 
__gnuc_va_li¡
 
__¬g
)

704 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

705 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

706 
__gnuc_va_li¡
 
__¬g
)

707 
__THROW
 ;

709 #ià!
defšed
 
__USE_GNU
 \

710 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

711 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

712 #ifdeà
__REDIRECT


713 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

714 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

717 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

718 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

720 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

721 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

722 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

725 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

726 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

727 
__gnuc_va_li¡
 
__¬g
);

728 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
);

730 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

731 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

732 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

733 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

734 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

735 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

739 
__END_NAMESPACE_C99


743 
__BEGIN_NAMESPACE_STD


748 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

749 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

755 
wšt_t
 
	`g‘wch¬
 ();

762 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

763 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

769 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

777 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

778 
__FILE
 *
__»¡riù
 
__¡»am
);

784 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

785 
__FILE
 *
__»¡riù
 
__¡»am
);

792 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

793 
__END_NAMESPACE_STD


796 #ifdeà
__USE_GNU


804 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

805 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

813 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

821 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

830 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

831 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

840 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

841 
__FILE
 *
__»¡riù
 
__¡»am
);

849 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

850 
__FILE
 *
__»¡riù
 
__¡»am
);

854 
__BEGIN_NAMESPACE_C99


858 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

859 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

860 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

861 
__END_NAMESPACE_C99


863 #ifdeà
__USE_GNU


864 
	~<xloÿË.h
>

868 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

869 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

870 cÚ¡ 
tm
 *
__»¡riù
 
__
,

871 
__loÿË_t
 
__loc
è
__THROW
;

880 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


881 
	#__Ãed_iswxxx


	)

882 
	~<wùy³.h
>

886 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


887 
	~<b™s/wch¬2.h
>

890 #ifdeà
__LDBL_COMPAT


891 
	~<b™s/wch¬-ldbl.h
>

894 
__END_DECLS


902 #undeà
__Ãed_mb¡©e_t


903 #undeà
__Ãed_wšt_t


	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
97
1615
config.cc
config.h
demo_client.cc
demo_protocol.h
demo_server.cc
extent_client.cc
extent_client.h
extent_protocol.h
extent_server.cc
extent_server.h
extent_smain.cc
fuse.cc
gettime.cc
gettime.h
handle.cc
handle.h
inode_manager.cc
inode_manager.h
lab1_tester.cc
lang/algorithm.h
lang/verify.h
lock_client.cc
lock_client.h
lock_demo.cc
lock_protocol.h
lock_server.cc
lock_server.h
lock_smain.cc
lock_tester.cc
log.cc
log.h
paxos.cc
paxos.h
paxos_protocol.h
rpc/connection.h
rpc/fifo.h
rpc/jsl_log.cc
rpc/jsl_log.h
rpc/marshall.h
rpc/method_thread.h
rpc/pollmgr.cc
rpc/pollmgr.h
rpc/rpc.cc
rpc/rpc.h
rpc/rpctest.cc
rpc/slock.h
rpc/thr_pool.cc
rpc/thr_pool.h
rsm.cc
rsm.h
rsm_protocol.h
rsm_state_transfer.h
rsm_tester.cc
rsmtest_client.cc
rsmtest_client.h
test-lab-3-b.c
test-lab-3-c.c
test-lab-3-g.c
test-lab-4-a.c
test-lab-4-b.c
test-lab-5.c
test_lab_7.cc
tprintf.h
yfs_client.cc
yfs_client.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/dirent.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/getopt.h
/usr/include/inttypes.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/tcp.h
/usr/include/pthread.h
/usr/include/sched.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/ctype.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/rpc/netdb.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
